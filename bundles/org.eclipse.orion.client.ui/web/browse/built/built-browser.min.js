/*

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2009, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2009, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation
 RequireJS text 2.0.5 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/text for details

 Copyright (c) 2012, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010,2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2009, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2009, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2009, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation
  Mihai Sucan (Mozilla Foundation) - fix for Bug#334583 Bug#348471 Bug#349485 Bug#350595 Bug#360726 Bug#361180 Bug#362835 Bug#362428 Bug#362286 Bug#354270 Bug#361474 Bug#363945 Bug#366312 Bug#370584

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2009, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010,2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:  IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:  IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: Anton McConville - IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others. 
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation
               Alex Lakatos - fix for bug#369781

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010-2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others. All rights reserved. This
 program and the accompanying materials are made available under the terms of
 the Eclipse Public License v1.0 (http://www.eclipse.org/legal/epl-v10.html),
 and the Eclipse Distribution License v1.0
 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation
 RequireJS i18n 2.0.2 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/i18n for details

 Copyright (c) 2011, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation
*/
var requirejs,require,define;
(function(f){function m(a,c){var k,d,r,t,A,n,C,h,b,e=c&&c.split("/"),l=p.map,s=l&&l["*"]||{};if(a&&"."===a.charAt(0))if(c){e=e.slice(0,e.length-1);a=e.concat(a.split("/"));for(h=0;h<a.length;h+=1)if(k=a[h],"."===k)a.splice(h,1),h-=1;else if(".."===k)if(1===h&&(".."===a[2]||".."===a[0]))break;else 0<h&&(a.splice(h-1,2),h-=2);a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((e||s)&&l){k=a.split("/");for(h=k.length;0<h;h-=1){d=k.slice(0,h).join("/");if(e)for(b=e.length;0<b;b-=1)if(r=l[e.slice(0,
b).join("/")])if(r=r[d]){t=r;A=h;break}if(t)break;!n&&(s&&s[d])&&(n=s[d],C=h)}!t&&n&&(t=n,A=C);t&&(k.splice(0,A,t),a=k.join("/"))}return a}function q(a,c){return function(){return h.apply(f,w.call(arguments,0).concat([a,c]))}}function b(a){return function(c){return m(c,a)}}function l(a){return function(c){k[a]=c}}function g(a){if(s.call(n,a)){var c=n[a];delete n[a];u[a]=!0;d.apply(f,c)}if(!s.call(k,a)&&!s.call(u,a))throw Error("No "+a);return k[a]}function e(a){var c,k=a?a.indexOf("!"):-1;-1<k&&(c=
a.substring(0,k),a=a.substring(k+1,a.length));return[c,a]}var d,h,c,a,k={},n={},p={},u={},s=Object.prototype.hasOwnProperty,w=[].slice;c=function(a,c){var k,d=e(a),r=d[0],a=d[1];r&&(r=m(r,c),k=g(r));r?a=k&&k.normalize?k.normalize(a,b(c)):m(a,c):(a=m(a,c),d=e(a),r=d[0],a=d[1],r&&(k=g(r)));return{f:r?r+"!"+a:a,n:a,pr:r,p:k}};a={require:function(a){return q(a)},exports:function(a){var c=k[a];return"undefined"!==typeof c?c:k[a]={}},module:function(a){return{id:a,uri:"",exports:k[a],config:function(){return p&&
p.config&&p.config[a]||{}}}}};d=function(d,p,h,b){var r,t,A,e,C=[],w,b=b||d;if("function"===typeof h){p=!p.length&&h.length?["require","exports","module"]:p;for(e=0;e<p.length;e+=1)if(A=c(p[e],b),t=A.f,"require"===t)C[e]=a.require(d);else if("exports"===t)C[e]=a.exports(d),w=!0;else if("module"===t)r=C[e]=a.module(d);else if(s.call(k,t)||s.call(n,t)||s.call(u,t))C[e]=g(t);else if(A.p)A.p.load(A.n,q(b,!0),l(t),{}),C[e]=k[t];else throw Error(d+" missing "+t);p=h.apply(k[d],C);if(d)if(r&&r.exports!==
f&&r.exports!==k[d])k[d]=r.exports;else if(p!==f||!w)k[d]=p}else d&&(k[d]=h)};requirejs=require=h=function(k,n,b,e,r){if("string"===typeof k)return a[k]?a[k](n):g(c(k,n).f);k.splice||(p=k,n.splice?(k=n,n=b,b=null):k=f);n=n||function(){};"function"===typeof b&&(b=e,e=r);e?d(f,k,n,b):setTimeout(function(){d(f,k,n,b)},4);return h};h.config=function(a){p=a;return h};define=function(a,c,d){c.splice||(d=c,c=[]);!s.call(k,a)&&!s.call(n,a)&&(n[a]=[a,c,d])};define.amd={jQuery:!0}})();define("almond",function(){});
define("orion/PageUtil",[],function(){var f=/^http[s]?/i;return{hash:function(){var f=window.location.href.split("#")[1];return f?"#"+f:""},matchResourceParameters:function(f){var f=f||window.location.toString(),q={resource:""},b=f.indexOf("#");if(-1!==b&&(f=f.substring(b+1),0!==f.length)){f=f.split(",");q.resource=decodeURIComponent(f[0]);for(b=1;b<f.length;b++){var l=/([^=]*)(=?)(.*)/.exec(f[b]),g=decodeURIComponent(l[1]||""),l=decodeURIComponent(l[3]||"");""!==g&&"resource"!==g&&(q[g]=l)}}return q},
validateURLScheme:function(m,q){var b=m;if(-1===m.indexOf("://")){var l=document.createElement("a");l.href=m;b=l.href}l=!1;if(l=q?q.some(function(l){return RegExp("^"+l+":","i").test(b)}):f.test(b))return m;console.log("Illegal URL Scheme: '"+m+"'");return""}}});
(function(){function f(q,b,l){for(var g in b)b.hasOwnProperty(g)&&(!q.hasOwnProperty(g)||l)?q[g]=b[g]:"object"===typeof b[g]&&f(q[g],b[g],l)}var m=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(q){var b=q.config?q.config():{};return{version:"2.0.1+",load:function(l,g,e,d){d=d||{};d.locale&&(b.locale=d.locale);var h=m.exec(l),c=h[1],a=h[4],k=h[5],n=a.split("-"),p=[],u={},s,w="";h[5]?(c=h[1],l=c+k):(k=h[4],a=b.locale,a||(a=b.locale="undefined"===typeof navigator?"root":
(navigator.language||navigator.userLanguage||"root").toLowerCase()),n=a.split("-"));if(d.isBuild){p.push(l);d=c+"root/"+k;require._fileExists(g.toUrl(d+".js"))&&p.push(d);for(s=0;s<n.length;s++)d=n[s],w+=(w?"-":"")+d,d=p,h=c+w+"/"+k,require._fileExists(g.toUrl(h+".js"))&&d.push(h);g(p,function(){e()})}else g([l],function(a){var d=[],h;h=c;var b=k;a.root&&(d.push("root"),(!0===a.root||1===a.root)&&p.push(h+"root/"+b));for(s=0;s<n.length;s++){h=n[s];h=w+=(w?"-":"")+h;var b=a,r=p,t=c,A=k;b[h]&&(d.push(h),
(!0===b[h]||1===b[h])&&r.push(t+h+"/"+A))}g(p,function(){var r,t,A;for(r=d.length-1;-1<r&&d[r];r--){A=d[r];t=a[A];if(!0===t||1===t)t=g(c+A+"/"+k);f(u,t)}e(u)})})}}})})();define("orion/i18n",{load:function(f,m,q){m.specified&&m.specified("orion/bootstrap")?m(["orion/i18n!"+f],function(b){q(b)}):q({})}});
define("orion/edit/nls/root/messages",{Editor:"Editor",switchEditor:"Switch Editor",Fetching:"Fetching: ${0}",confirmUnsavedChanges:"There are unsaved changes.  Do you still want to navigate away?",searchFiles:"Search Files...",searchTerm:"Enter search term:",unsavedChanges:"There are unsaved changes.",Save:"Save",Saved:"Saved",Blame:"Blame",BlameTooltip:"Show blame annotations",saveOutOfSync:"Resource is out of sync with the server. Do you want to save it anyway?",loadOutOfSync:"Resource is out of sync with the server. Do you want to load it anyway? This will overwrite your local changes.",
ReadingMetadata:"Reading metadata of ${0}",ReadingMetadataError:"Can not get metadata of ${0}",Reading:"Reading ${0}",readonly:"Read Only.",saveFile:"Save this file",gotoLine:"Go to Line...",gotoLineTooltip:"Go to specified line number",gotoLinePrompt:"Go to line:",Undo:"Undo",Redo:"Redo",Find:"Find...",noResponse:"No response from server.  Check your internet connection and try again.",savingFile:"Saving file ${0}",running:"Running ${0}","Saving...":"Saving...",View:"View",SidePanel:"Side Panel",
SidePanelTooltip:"Choose what to show in the side panel.",Actions:"Actions",Navigator:"Navigator",FolderNavigator:"Folder Navigator",Project:"Project",New:"New",File:"File",Edit:"Edit",Tools:"Tools",Add:"Add",noActions:"There are no actions for the current selection.",NoFile:"Use the ${0} to create new files and folders. Click a file to start coding.",LocalEditorSettings:"Local Editor Settings",NoProject:"${0} is not a project. To convert it to a project use ${1}.",NoProjects:"There are no projects in your workspace. Use the ${0} menu to create projects.",
disconnected:"(disconnected)",ChooseFS:"Choose Filesystem",ChooseFSTooltip:"Choose the filesystem you want to view.",FSTitle:"${0} (${1})",Deploy:"Deploy","Deploy As":"Deploy As",Import:"Import",Export:"Export",OpenWith:"Open With",OpenRelated:"Open Related",Dependency:"Dependency",UnnamedCommand:"Unnamed"});
define("orion/edit/nls/messages",["orion/i18n!orion/edit/nls/messages","orion/edit/nls/root/messages"],function(f,m){var q={root:m};Object.keys(f).forEach(function(b){"undefined"===typeof q[b]&&(q[b]=f[b])});return q});
(function(f,m){"function"===typeof define&&define.amd?define("orion/Deferred",m):"object"===typeof exports?module.exports=m():(f.orion=f.orion||{},f.orion.Deferred=m())})(this,function(){function f(){for(var b;b=l.shift();)b();g=!1}function m(b){l.push(b);g||(g=!0,setTimeout(f,0))}function q(b){return function(){b.apply(void 0,arguments)}}function b(){function e(){for(var c;c=n.shift();){var d=c.deferred,p="fulfilled"===k?"resolve":"reject";if("function"===typeof c[p])try{var h=(0,c[p])(a),b=h&&("object"===
typeof h||"function"===typeof h)&&h.then;if("function"===typeof b)if(h===d.promise)d.reject(new TypeError);else{var e=h.cancel;"function"===typeof e?d._protected(l).parentCancel=e.bind(h):delete d._protected(l).parentCancel;b.call(h,q(d.resolve),q(d.reject),q(d.progress))}else d.resolve(h)}catch(r){d.reject(r)}else d[p](a)}}function d(c){delete u.parentCancel;k="rejected";a=c;n.length&&m(e)}function h(c){function l(r){return function(a){g||(g=!0,r(a))}}var g=!1;delete u.parentCancel;try{var f=c&&
("object"===typeof c||"function"===typeof c)&&c.then;if("function"===typeof f)if(c===p)d(new TypeError);else{k="assumed";var v=c&&c.cancel;if("function"!==typeof v){var q=new b,c=q.promise;try{f(q.resolve,q.reject,q.progress)}catch(r){q.reject(r)}v=c.cancel;f=c.then}a=c;f.call(c,l(h),l(d));u.parentCancel=v.bind(c)}else k="fulfilled",a=c,n.length&&m(e)}catch(t){l(d)(t)}}function c(){var a=u.parentCancel;a?(delete u.parentCancel,a()):k||(a=Error("Cancel"),a.name="Cancel",d(a))}var a,k,n=[],p=this,u=
{};Object.defineProperty(this,"_protected",{value:function(a){if(a!==l)throw Error("protected");return u}});this.resolve=function(a){k||h(a);return p};this.reject=function(a){k||d(a);return p};this.progress=function(a){k||n.forEach(function(c){if(c.progress)try{c.progress(a)}catch(k){}});return p.promise};this.cancel=function(){u.parentCancel?setTimeout(c,0):c();return p};this.then=function(a,c,d){a={resolve:a,reject:c,progress:d,deferred:new b};n.push(a);a.deferred._protected(l).parentCancel=p.promise.cancel.bind(p);
("fulfilled"===k||"rejected"===k)&&m(e);return a.deferred.promise};this.promise={then:p.then,cancel:p.cancel}}var l=[],g=!1;b.all=function(e,d){function h(c,d){n||(k[c]=d,0===--a&&p.resolve(k))}function c(a,c){if(!n){if(d)try{h(a,d(c));return}catch(k){c=k}p.reject(c)}}var a=e.length,k=[],n=!1,p=new b;p.then(void 0,function(){n=!0;e.forEach(function(a){a.cancel&&a.cancel()})});0===a?p.resolve(k):e.forEach(function(a,k){a.then(h.bind(void 0,k),c.bind(void 0,k))});return p.promise};b.when=function(e,
d,h,c){var a;e&&"function"===typeof e.then||(a=new b,a.resolve(e),e=a.promise);return e.then(d,h,c)};return b});
define("orion/i18nUtil",["require","orion/Deferred"],function(f,m){var q={};return{getMessageBundle:function(b){function l(){f(["i18n!"+b],function(c){if(c){var a=b;c._expires=(new Date).getTime()+9E5;localStorage.setItem("orion/messageBundle/"+a,JSON.stringify(c));delete c._expires}e.resolve(c)})}function g(c){e.reject(c)}if(q[b])return q[b];var e=new m;q[b]=e;var d;a:{if(d=localStorage.getItem("orion/messageBundle/"+b))if(d=JSON.parse(d),d._expires&&d._expires>(new Date).getTime()){delete d._expires;
break a}d=null}if(d)return e.resolve(d),e;try{f([b],l,g)}catch(h){f(["orion/i18n!"+b],l,g)}return e},formatMessage:function(b){var l=arguments;return b.replace(/\$\{([^\}]+)\}/g,function(b,e){return l[(e<<0)+1]})}}});
define("orion/EventTarget",[],function(){function f(){this._namedListeners={}}f.prototype={dispatchEvent:function(f){if(!f.type)throw Error("unspecified type");var q=this._namedListeners[f.type];q&&q.forEach(function(b){try{"function"===typeof b?b(f):b.handleEvent(f)}catch(l){"undefined"!==typeof console&&console.log(l)}});return!f.defaultPrevented},addEventListener:function(f,q){if("function"===typeof q||q.handleEvent)this._namedListeners[f]=this._namedListeners[f]||[],this._namedListeners[f].push(q)},
removeEventListener:function(f,q){var b=this._namedListeners[f];if(b)for(var l=0;l<b.length;l++)if(b[l]===q){1===b.length?delete this._namedListeners[f]:b.splice(l,1);break}}};f.prototype.constructor=f;f.attach=function(m){var q=new f;m.dispatchEvent=q.dispatchEvent.bind(q);m.addEventListener=q.addEventListener.bind(q);m.removeEventListener=q.removeEventListener.bind(q)};return f});
define("orion/objects",[],function(){function f(f){for(var q=1;q<arguments.length;q++){var b=arguments[q],l;for(l in b)Object.prototype.hasOwnProperty.call(b,l)&&(f[l]=b[l])}return f}return{clone:function(m){if(Array.isArray(m))return Array.prototype.slice.call(m);var q=Object.create(Object.getPrototypeOf(m));f(q,m);return q},mixin:f,toArray:function(f){return Array.isArray(f)?f:[f]}}});
define("orion/inputManager","i18n!orion/edit/nls/messages orion/i18nUtil orion/Deferred orion/EventTarget orion/objects orion/PageUtil".split(" "),function(f,m,q,b,l,g){function e(c){this._document=c.document||document;this._timeout=c.timeout;for(var c="keypress keydown keyup mousemove mousedown mousemove".split(" "),a=function(){this._resetTimer()}.bind(this),k=0;k<c.length;k++)this._document.addEventListener(c[k],a,!0);b.attach(this)}function d(c,a){if(c){if(0===a.status)a={Severity:"Error",Message:f.noResponse};
else{var k=a.responseText;if(k)try{a=JSON.parse(k)}catch(d){a={Severity:"Error",Message:k}}}c.setProgressResult(a)}else window.console.log(a)}function h(c){b.attach(this);this.serviceRegistry=c.serviceRegistry;this.statusService=c.statusService;this.fileClient=c.fileClient;this.progressService=c.progressService;this.contentTypeRegistry=c.contentTypeRegistry;this.selection=c.selection;this._input=this._title="";this.dispatcher=null;this._unsavedChanges=[]}e.prototype={_resetTimer:function(){var c=
this._document.defaultView||this._document.parentWindow;this._timer&&(c.clearTimeout(this._timer),this._timer=null);-1!==this._timeout&&(this._timer=c.setTimeout(function(){this.onIdle({type:"Idle"});this._timer=null;this._resetTimer()}.bind(this),this._timeout))},onIdle:function(c){return this.dispatchEvent(c)},setTimeout:function(c){this._timeout=c;this._resetTimer()}};l.mixin(h.prototype,{_maybeLoadWorkspace:function(c){var a=this.fileClient;return c===a.fileServiceRootURL(c)?a.loadWorkspace(c).then(function(a){return a.Location}):
(new q).resolve(c)},_read:function(c){var a=this.fileClient,k=Array.prototype.slice.call(arguments,1);return this._maybeLoadWorkspace(c).then(function(c){return a.read.apply(a,[c].concat(k))})},load:function(){var c=this.getInput();if(c){var a=this.fileClient,k=this._parsedLocation.resource,h=this.progressService,p=function(r,a,c){return!h?r:h.progress(r,m.formatMessage(a,c))},b=this.getEditor();if(this._fileMetadata)!this._saving&&(!this._fileMetadata.Directory&&!this._readonly)&&p(a.read(k,!0),
f.ReadingMetadata,c).then(function(r){this._fileMetadata&&(this._fileMetadata.Location===r.Location&&this._fileMetadata.ETag!==r.ETag)&&(this._fileMetadata=r,(!b.isDirty()||window.confirm(f.loadOutOfSync))&&p(a.read(k),f.Reading,c).then(function(r){b.setInput(c,null,r);this._unsavedChanges=[]}.bind(this)))}.bind(this));else{var e=k;if(0===e.indexOf("/gitapi/commit/")){var l=e.indexOf("/file"),g=e.indexOf("?",l);-1===g&&(g=e.length);e=e.substring(l,g);this._readonly=!0}var q=window.setTimeout(function(){q=
null;this.reportStatus(m.formatMessage(f.Fetching,c))}.bind(this),800),v=function(){this.reportStatus("");q&&window.clearTimeout(q)}.bind(this),z=function(r){v();var a=null;this.serviceRegistry?a=this.serviceRegistry.getService("orion.page.message"):this.statusService&&(a=this.statusService);d(a,r);this._setNoInput()}.bind(this);this._acceptPatch=null;p(this._read(e,!0),f.ReadingMetadata,e).then(function(r){r?r.Directory?p(a.fetchChildren(r.ChildrenLocation),f.Reading,c).then(function(a){v();r.Children=
a;this._setInputContents(this._parsedLocation,c,a,r)}.bind(this),z):this._isText(r)?p(a.read(k,!1,!0),f.Reading,c).then(function(a){v();"string"!==typeof a&&(this._acceptPatch=a.acceptPatch,a=a.result);this._setInputContents(this._parsedLocation,c,a,r)}.bind(this),z):p(a._getService(k).readBlob(k),f.Reading,c).then(function(a){v();this._setInputContents(this._parsedLocation,c,a,r)}.bind(this),z):z({responseText:m.formatMessage(f.ReadingMetadataError,e)})}.bind(this),z)}}},processParameters:function(c){var a=
this.getEditor();a&&a.processParameters&&a.processParameters(c)},getAutoLoadEnabled:function(){return this._autoLoadEnabled},getAutoSaveEnabled:function(){return this._autoSaveEnabled},getEditor:function(){return this.editor},getInput:function(){return this._input},getTitle:function(){return this._title},getFileMetadata:function(){return this._fileMetadata},getReadOnly:function(){var c=this._fileMetadata;return this._readonly||!c||c.Attributes&&c.Attributes.ReadOnly},getContentType:function(){return this._contentType},
onFocus:function(){this._autoSaveEnabled&&this._errorSaving?this.save():this._autoLoadEnabled&&this.load()},onChanging:function(c){if(this._getSaveDiffsEnabled()){var a=this._unsavedChanges.length,k=c.removedCharCount,d=c.start,p=c.start+k,h=0;0===c.addedCharCount?h=-1:0===k&&(h=1);if(0<a&&h===this.previousChangeType){a=this._unsavedChanges[a-1];if(0===k&&d===a.end+a.text.length){a.text+=c.text;return}if(0===c.addedCharCount&&p===a.start){a.start=d;return}}this.previousChangeType=h;this._unsavedChanges.push({start:d,
end:p,text:c.text})}},reportStatus:function(c){this.statusReporter?this.statusReporter(c):this.editor&&this.editor.reportStatus(c)},save:function(){function c(a){p===t.getInput()&&(t.getFileMetadata().ETag=a.ETag,k.setInput(p,null,b,!0));t.reportStatus("");h&&r&&r.setProgressResult({Message:f.Saved,Severity:"Normal"});t.afterSave&&t.afterSave();t._saving=!1}function a(a){t.reportStatus("");d(r,a);t._saving=!1;t._errorSaving=!0}if(!this._saving){var k=this.getEditor();if(k&&k.isDirty()&&!this.getReadOnly()){var h=
this._errorSaving;this._saving=!0;var p=this.getInput();this.reportStatus(f["Saving..."]);this.dispatchEvent({type:"Saving",inputManager:this});k.markClean();var b=k.getText(),e=b;if(this._getSaveDiffsEnabled()&&!this._errorSaving){for(var l=this._unsavedChanges,g=0,q=0;q<l.length;q++)g+=l[q].text.length;b.length>g&&(e={diff:l})}this._unsavedChanges=[];this._errorSaving=!1;var l={ETag:this.getFileMetadata().ETag},v=this._parsedLocation.resource,e=this.fileClient.write(v,e,l),z=this.progressService,
r=null;this.serviceRegistry&&(r=this.serviceRegistry.getService("orion.page.message"));z&&(e=z.progress(e,m.formatMessage(f.savingFile,p)));var t=this;e.then(c,function(r){412===r.status?window.confirm(f.saveOutOfSync)?(r=t.fileClient.write(v,b),z&&(r=z.progress(r,m.formatMessage(f.savingFile,p))),r.then(c,a)):t._saving=!1:a(r)})}}},setAutoLoadEnabled:function(c){this._autoLoadEnabled=c},setAutoSaveTimeout:function(c){this._autoSaveEnabled=-1!==c;this._idle?this._idle.setTimeout(c):(this._idle=new e({document:document,
timeout:c}),this._idle.addEventListener("Idle",function(){this._errorSaving||this.save()}.bind(this)))},setContentType:function(c){this._contentType=c},setInput:function(c){if(!this._ignoreInput&&(c||(c=g.hash()),"string"===typeof c)){var a=this.getEditor();c&&"#"!==c[0]&&(c="#"+c);var k=g.matchResourceParameters(c),d=this._parsedLocation||{};if(a&&a.isDirty()){var p=this._location;if(d.resource!==k.resource)if(this._autoSaveEnabled)this.save();else if(!window.confirm(f.confirmUnsavedChanges)){window.location.hash=
p;return}}a=a&&d.editor!==k.editor;this._location=c;this._parsedLocation=k;this._ignoreInput=!0;this.selection&&this.selection.setSelections(c);this._ignoreInput=!1;(c=k.resource)?c===this._input?a?(this.reportStatus(""),this._setInputContents(k,c,null,this._fileMetadata,this._isText(this._fileMetadata))):this.processParameters(k):(this._input=c,this._readonly=!1,this._fileMetadata=null,this.load()):this._setNoInput(!0)}},setTitle:function(c){var a=c.lastIndexOf("/");-1!==a&&(c=c.substring(a+1));
this._title=c},setSaveDiffsEnabled:function(c){this._saveDiffsEnabled=c},_getSaveDiffsEnabled:function(){return this._saveDiffsEnabled&&null!==this._acceptPatch&&-1!==this._acceptPatch.indexOf("application/json-patch")},_isText:function(c){c=this.contentTypeRegistry.getFileContentType(c);if(!c)return!0;var a=this.contentTypeRegistry.getContentType("text/plain");return this.contentTypeRegistry.isExtensionOf(c,a)},_setNoInput:function(c){c?this.fileClient.loadWorkspace("").then(function(a){this._input=
a.ChildrenLocation;this._setInputContents(a.ChildrenLocation,null,a,a)}.bind(this)):(this._input=this._title=this._fileMetadata=null,this.setContentType(null),this.dispatchEvent({type:"InputChanged",input:null}))},_setInputContents:function(c,a,d,h,p){var b,e=!1;h?(this._fileMetadata=h,this.setTitle(h.Location||String(h)),this.setContentType(this.contentTypeRegistry.getFileContentType(h)),b=h.Name,e=h.Directory):(this._fileMetadata=null,this.setTitle(a),this.setContentType(this.contentTypeRegistry.getFilenameContentType(this.getTitle())),
b=this.getTitle());var l=this.getEditor();this._focusListener&&(l&&(l.getTextView&&l.getTextView())&&l.getTextView().removeEventListener("Focus",this._focusListener),this._focusListener=null);this._changingListener&&(l&&(l.getModel&&l.getModel())&&l.getModel().removeEventListener("Changing",this._changingListener),this._changingListener=null);h={type:"InputChanged",input:c,name:b,title:a,contentType:this.getContentType(),metadata:h,location:window.location,contents:d};this.dispatchEvent(h);this.editor=
l=h.editor;e||(l&&(l.getTextView&&l.getTextView())&&l.getTextView().addEventListener("Focus",this._focusListener=this.onFocus.bind(this)),l&&(l.getModel&&l.getModel())&&l.getModel().addEventListener("Changing",this._changingListener=this.onChanging.bind(this)),p||l.setInput(a,null,d),this._unsavedChanges=[],this.processParameters(c))}});return{InputManager:h}});
define("orion/util",[],function(){var f=navigator.userAgent,m=-1!==f.indexOf("MSIE")||-1!==f.indexOf("Trident")?document.documentMode:void 0,q=parseFloat(f.split("Firefox/")[1]||f.split("Minefield/")[1])||void 0,b=-1!==f.indexOf("Opera")?parseFloat(f.split("Version/")[1]):void 0,l=parseFloat(f.split("Chrome/")[1])||void 0,g=-1!==f.indexOf("Safari")&&!l,e=parseFloat(f.split("WebKit/")[1])||void 0,d=-1!==f.indexOf("Android"),h=-1!==f.indexOf("iPad"),f=-1!==f.indexOf("iPhone"),c=h||f,a=-1!==navigator.platform.indexOf("Mac"),
k=-1!==navigator.platform.indexOf("Win"),n=-1!==navigator.platform.indexOf("Linux");return{formatMessage:function(a){var c=arguments;return a.replace(/\$\{([^\}]+)\}/g,function(a,d){return c[(d<<0)+1]})},createElement:function(a,c){return a.createElementNS?a.createElementNS("http://www.w3.org/1999/xhtml",c):a.createElement(c)},isIE:m,isFirefox:q,isOpera:b,isChrome:l,isSafari:g,isWebkit:e,isAndroid:d,isIPad:h,isIPhone:f,isIOS:c,isMac:a,isWindows:k,isLinux:n,platformDelimiter:k?"\r\n":"\n"}});
define("orion/webui/littlelib",["orion/util"],function(f){function m(d,c){c||(c=document);return c.querySelectorAll(d)}function q(d){var c=d.tabIndex;0===c&&f.isIE&&!{a:!0,body:!0,button:!0,frame:!0,iframe:!0,img:!0,input:!0,isindex:!0,object:!0,select:!0,textarea:!0}[d.nodeName.toLowerCase()]&&!d.attributes.tabIndex&&(c=-1);return c}function b(d){if(0<=q(d))return d;if(d.hasChildNodes())for(var c=0;c<d.childNodes.length;c++){var a=b(d.childNodes[c]);if(a)return a}return null}function l(d){if(0<=
q(d))return d;if(d.hasChildNodes())for(var c=d.childNodes.length-1;0<=c;c--){var a=l(d.childNodes[c]);if(a)return a}return null}function g(d,c){if(3===d.nodeType){var a=e.exec(d.nodeValue);a&&1<a.length&&c(d,a)}if(d.hasChildNodes())for(a=0;a<d.childNodes.length;a++)g(d.childNodes[a],c)}var e=/\$\{([^\}]+)\}/,d=null;return{$:function(d,c){c||(c=document);return c.querySelector(d)},$$:m,$$array:function(d,c){return Array.prototype.slice.call(m(d,c))},node:function(d){var c=d;"string"===typeof d&&(c=
document.getElementById(d));return c},contains:function(d,c){if(!d||!c)return!1;if(d===c)return!0;var a=d.compareDocumentPosition(c);return Boolean(a&16)},bounds:function(d){d=d.getBoundingClientRect();return{left:d.left+document.documentElement.scrollLeft,top:d.top+document.documentElement.scrollTop,width:d.width,height:d.height}},empty:function(d){for(;d.hasChildNodes();)d.removeChild(d.firstChild)},firstTabbable:b,lastTabbable:l,stop:function(d){window.document.all&&(d.keyCode=0);d.preventDefault&&
(d.preventDefault(),d.stopPropagation())},processTextNodes:function(d,c){g(d,function(a,d){a.parentNode.replaceChild(document.createTextNode(c[d[1]]||d[1]),a)})},processDOMNodes:function(d,c){g(d,function(a,d){var h=c[d[1]];if(h){var p=document.createRange(),b=d.index;p.setStart(a,b);p.setEnd(a,b+d[0].length);p.deleteContents();p.insertNode(h)}})},addAutoDismiss:function(h,c){function a(a){d.forEach(function(c){var d=!1,h=c.excludeNodes.some(function(c){return document.body.contains(c)?(d=!0,c.contains(a.target)):
!1});if(d&&!h)try{c.dismiss(a)}catch(b){"undefined"!==typeof console&&console&&console.error(b&&b.message)}});d=d.filter(function(a){return a.excludeNodes.some(function(a){return document.body.contains(a)})})}null===d&&(d=[],document.addEventListener("click",a,!0),f.isIOS&&document.addEventListener("touchend",function(a){function c(){a.target.removeEventListener("click",c)}0===a.touches.length&&a.target.addEventListener("click",c)},!1));d.push({excludeNodes:h,dismiss:c})},setFramesEnabled:function(d){for(var c=
document.getElementsByTagName("iframe"),a=0;a<c.length;a++)c[a].parentNode.style.pointerEvents=d?"":"none"},removeAutoDismiss:function(h){d=d.filter(function(c){return h!==c.dismiss})},KEY:{BKSPC:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DEL:46}}});
define("orion/breadcrumbs",["require","orion/webui/littlelib"],function(f,m){function q(b){this._init(b)}q.prototype={_init:function(b){var l=m.node(b.container);if(!l)throw"no parent container";this._container=l;l.classList.remove("currentLocation");this._id=b.id||"eclipse.breadcrumbs";this._resource=b.resource||null;this._rootSegmentName=b.rootSegmentName;this._workspaceRootSegmentName=b.workspaceRootSegmentName;this._workspaceRootURL=b.workspaceRootURL;this._makeHref=b.makeHref;this._makeFinalHref=
b.makeFinalHref;this._maxLength=b.maxLength;this.path="";this.measure();this.render()},getNavigatorWorkspaceRootSegment:function(){if(this._workspaceRootSegmentName){var b;if(this._resource&&this._resource.Parents&&!this._resource.skip){b=document.createElement("a");var l=this._workspaceRootURL?this._workspaceRootURL:"";this._makeHref?this._makeHref(b,l):b.href=f.toUrl("edit/edit.html")+"#"+l}else b=document.createElement("span");m.empty(b);b.appendChild(document.createTextNode(this._workspaceRootSegmentName));
return b}return null},MAX_LENGTH:500,INCLUDE_FIRST_SECTION:!0,segments:[],buildSegment:function(b){var l=document.createElement("a");l.classList.add("breadcrumb");l.appendChild(document.createTextNode(b));return l},addSegmentHref:function(b,l){this._makeHref?this._makeHref(b,l.Location,l):b.href=f.toUrl("edit/edit.html")+"#"+l.ChildrenLocation},buildSegments:function(b,l){if(this._resource.Parents){var g=this._resource.Parents.slice(0),e,d;g&&(g=g.slice(0),"reverse"===l&&(g=g.reverse().slice(0)),
g.forEach(function(h){h.skip||(b?(d=b,b=null):d=h.Name,e=this.buildSegment(d),this.path+=h.Name,this.addSegmentHref(e,h),e.include=!1,this.segments.push(e))}.bind(this)))}},addDivider:function(){var b=document.createElement("span");b.appendChild(document.createTextNode(" / "));this.path+="/";b.classList.add("breadcrumbSeparator");this.append(b)},refresh:function(){(this.crumbs=m.node(this._id))?m.empty(this.crumbs):(this.crumbs=document.createElement("span"),this.crumbs.id=this._id,this._container.appendChild(this.crumbs),
this.dirty=document.createElement("span"),this.dirty.id="dirty",this.dirty.className="modifiedFileMarker",this._container.appendChild(this.dirty));this.crumbs.style.width="auto";this.crumbs.style.visibility="visible";this.crumbs.parentNode.className="currentLocation";this.crumbs.parentNode.style.width="auto"},append:function(b){this.crumbs.appendChild(b)},addTitle:function(b,l){var g=l||document.title;0===this.crumbs.childNodes.length&&(b=document.createElement("span"),b.appendChild(document.createTextNode(g)),
b.classList.add("breadcrumb"),b.classList.add("currentLocation"),this.append(b))},finalSegment:function(b,l){if(!this._resource.skip){var g;g=l?l:this._resource.Name;this._makeFinalHref?(b=this.buildSegment(g),this.addSegmentHref(b,this._resource)):(b=document.createElement("span"),b.appendChild(document.createTextNode(g)));b.classList.add("currentLocation");this.path+=this._resource.Name;this.append(b)}},firstSegment:function(b){b&&(this.append(b),this._resource&&this._resource.Parents&&!this._resource.skip?
(b.classList.add("breadcrumb"),this.addDivider()):(this._resource.skip||(b.href=""),b.classList.add("currentLocation")))},drawSegments:function(){this._resource.Parents&&this.segments.slice(0).forEach(function(b){!0===b.include&&(this.append(b),this.addDivider())}.bind(this))},measureSegments:function(){this.INCLUDE_FIRST_SECTION=!0;if(this._resource.Parents){var b=this.segments.slice(0).reverse();b.forEach(function(b){this.append(b);this.addDivider();this.crumbs.offsetWidth<this.MAX_LENGTH?b.include=
!0:this.INCLUDE_FIRST_SECTION=!1}.bind(this));this.segments=b.reverse()}},measure:function(){var b=this._container;b.style.width="auto";this.MAX_LENGTH=this._maxLength?this._maxLength:b.offsetWidth;this.refresh();this.segments=[];this.crumbs.style.visibility="hidden";var b=this.getNavigatorWorkspaceRootSegment(),l=this._rootSegmentName;l?this.addTitle(b,l):(this.finalSegment(b,l),this._resource&&this._resource.Parents&&(this.buildSegments(l,"reverse"),this.measureSegments(),this.firstSegment(b)),
this.crumbs.offsetWidth>=this.MAX_LENGTH&&(this.INCLUDE_FIRST_SECTION=!1))},render:function(){this.refresh();var b=this.getNavigatorWorkspaceRootSegment(),l=this._rootSegmentName;l?this.addTitle(b,l):(!0===this.INCLUDE_FIRST_SECTION&&this.firstSegment(b),this._resource&&this._resource.Parents&&(this.drawSegments(),this.finalSegment(b,l)));this.crumbs.parentNode.style.width=this.crumbs.offsetWidth+20+"px"}};q.prototype.constructor=q;return{BreadCrumbs:q}});
define("orion/navigate/nls/root/messages",{"Click one of the tasks below to create an Orion folder.  You can upload, import, or generate files.":"Click one of the tasks below to create an Orion folder.  You can upload, import, or generate files.","Toggle Left Pane":"Toggle Left Pane","Open or close the left pane":"Open or close the left pane",Navigator:"Navigator","Strings Xtrnalizr":"Strings Xtrnalizr","Externalize Strings from JavaScript files in this folder":"Externalize strings from JavaScript files in this folder.",
"Choose a Folder":"Choose a Folder","Copy of ${0}":"Copy of ${0}","Enter a new name for '${0}'":"Enter a new name for '${0}'","Choose folder...":"Choose folder...",Rename:"Rename","Rename the selected files or folders":"Rename the selected files or folders","Compare with each other":"Compare with each other","Compare the selected 2 files with each other":"Compare the selected 2 files with each other","Compare with...":"Compare with...","Compare the selected folder with a specified folder":"Compare the selected folder with a specified folder",
Delete:"Delete","Unknown item":"Unknown item","Are you sure you want to delete these ${0} items?":"Are you sure you want to delete these ${0} items?","Are you sure you want to delete '${0}'?":"Are you sure you want to delete '${0}'?","Export as zip":"Zip","Create a zip file of the folder contents and download it":"Create a zip file of the folder contents and download it","New File":"File","Create a new file":"Create a new file","Name:":"Name:","New Folder":"Folder","Folder name:":"Folder name:","Create a new folder":"Create a new folder",
"Creating folder":"Creating folder",Folder:"Folder","Create an empty folder":"Create an empty folder","Create an empty folder on the Orion server.  You can import, upload, or create content in the editor.":"Create an empty folder on the Orion server.  You can import, upload, or create content in the editor.","Sample HTML5 Site":"Sample HTML5 Site","Generate a sample":"Generate a sample",'Generate an HTML5 "Hello World" website, including JavaScript, HTML, and CSS files.':'Generate an HTML5 "Hello World" website, including JavaScript, HTML, and CSS files.',
"Creating a folder for ${0}":"Creating a folder for ${0}","SFTP Import":"SFTP Import","Import content from SFTP":"Import content from SFTP","Import content from an SFTP location into an Orion folder.  You will be prompted for the SFTP location and credentials.":"Import content from an SFTP location into an Orion folder.  You will be prompted for the SFTP location and credentials.","Imported Content":"Imported Content","Upload a Zip":"Upload a Zip","Upload content from a local zip file":"Upload content from a local zip file",
"Upload content from a local zip file into an Orion folder.  You will be prompted for the local zip file.":"Upload content from a local zip file into an Orion folder.  You will be prompted for the local zip file.","Uploaded Content":"Uploaded Content","Creating an upload folder for ":"Creating an upload folder for ","Clone Git Repository":"Clone Git Repository","Clone a git repository":"Clone a git repository","Go to the Orion repositories page to provide a git repository URL.  Once the repository is created, it will appear in the Navigator.":"Go to the Orion repositories page to provide a git repository URL.  Once the repository is created, it will appear in the Navigator.",
"Link to Server":"Link to Server","Link to existing content on the server":"Link to existing content on the server","Create a folder that links to an existing folder on the server.":"Create a folder that links to an existing folder on the server.","Server path:":"Server path:","The name and server location were not specified.":"The name and server location were not specified.","Go Up":"Go Up","Move up to the parent folder":"Move up to the parent folder","Go Into":"Go Into","Move into the selected folder":"Move into the selected folder",
"Import local file...":"File System","Copy files and folders from your local file system":"Copy files and folders from your local file system","SFTP from...":"SFTP","Copy files and folders from a specified SFTP connection":"Copy files and folders from a specified SFTP connection","Importing from ${0}":"Importing from ${0}","SFTP to...":"SFTP","Copy files and folders to a specified SFTP location":"Copy files and folders to a specified SFTP location",Exporting:"Exporting to ${0}","Pasting ${0}":"Pasting ${0}",
"Copy to":"Copy to","Move to":"Move to","Copying ${0}":"Copying ${0}","Moving ${0}":"Moving ${0}","Renaming ${0}":"Renaming ${0}","Deleting ${0}":"Deleting ${0}","Creating ${0}":"Creating ${0}","Linking to ${0}":"Linking to ${0}","Move files and folders to a new location":"Move files and folders to a new location",Cut:"Cut",Copy:"Copy","Fetching children of ":"Fetching children of ",Paste:"Paste","Cannot paste into the Workspace root":"Cannot paste into the Workspace root","Open With":"Open With",
"Loading ":"Loading ",New:"New",File:"File",Actions:"Actions","Orion Content":"Orion Content"," is not supported in this file system":" is not supported in this file system","Create new content":"Create new content","Import from HTTP...":"HTTP","File URL:":"File URL:","Copy a file from a URL and optionally unzip it":"Copy a file from a URL and optionally unzip it","Unzip *.zip files:":"Unzip *.zip files:","Extracted from:":"Extracted from:","Did not drop ${0}.  Folder drop is not supported in this browser.":"Did not drop ${0}.  Folder drop is not supported in this browser.",
"You cannot copy files directly into the workspace.  Create a folder first.":"You cannot copy files directly into the workspace.  Create a folder first.","Unzip ${0}?":"Unzip ${0}?",NoFile:"Use the ${0} menu to create new files and folders. Click a file to start coding."});define("orion/navigate/nls/messages",["orion/i18n!orion/navigate/nls/messages","orion/navigate/nls/root/messages"],function(f,m){var q={root:m};Object.keys(f).forEach(function(b){"undefined"===typeof q[b]&&(q[b]=f[b])});return q});
define("orion/nls/root/messages",{Navigator:"Navigator",Sites:"Sites",Shell:"Shell",ShellLinkWorkspace:"Workspace Shell","Get Plugins":"Get Plugins",Global:"Global",Editor:"Editor",EditorRelatedLink:"Show Current Folder",EditorRelatedLinkParent:"Show Enclosing Folder",EditorLinkWorkspace:"Show Workspace",EditorRelatedLinkProj:"Show Project","Filter bindings":"Filter bindings","Orion Editor":"Orion Editor","Orion Image Viewer":"Orion Image Viewer","Orion Markdown Viewer":"Orion Markdown Viewer","Orion JSON Editor":"Orion JSON Editor",
"View on Site":"View on Site","View this file or folder on a web site hosted by Orion":"View this file or folder on a web site hosted by Orion.","Show a list of all the keybindings on this page":"Show a list of all the keybindings on this page","Show Keys":"Show Keys","Hide or show the page banner and footer":"Hide or show the page banner and footer","Toggle banner and footer":"Toggle banner and footer","Choose a file by name and open an editor on it":"Choose a file by name and open an editor on it",
"Find File Named...":"Find File Named...","System Configuration Details":"System Configuration Details","System Config Tooltip":"Go to the System Configuration Details page","Background Operations":"Background Operations","Background Operations Tooltip":"Go to the Background Operations page","Operation status is unknown":"Operation status is unknown","Unknown item":"Unknown item","Can't search: no search service is available":"Can't search: no search service is available","could not find banner parent, id was ":"could not find banner parent, id was ",
Related:"Related",Options:"Options",FAQ:"FAQ","Report a Bug":"Bugs","Privacy Policy":"Privacy","Terms of Use":"Terms","Copyright Agent":"Copyright","Orion Logo":"Orion Logo","Orion is in Beta. Please try it out but BEWARE your data may be lost.":"@buildLabel@","LOG: ":"LOG: ",View:"View","no parent":"no parent","no tree model":"no tree model","no renderer":"no renderer","could not find table row ":"could not find table row ","Resource is out of sync with the server. Do you want to save it anyway?":"Resource is out of sync with the server. Do you want to save it anyway?",
Operations:"Operations","Operations running":"Operations running","Some operations finished with warning":"Some operations finished with warning","Some operations finished with error":"Some operations finished with error","no service registry":"no service registry",Tasks:"Tasks",Close:"Close","Expand all":"Expand all","Collapse all":"Collapse all",Search:"Search","Advanced search":"Advanced search",Submit:"Submit",More:"More","Saved searches":"Saved searches","Recent searches":"Recent searches","Regular expression":"Regular expression",
"Search options":"Search options","Global search":"Global search","Orion Home":"Orion Home","Close notification":"Close notification","Operations - Press spacebar to show current operations":"Operations - Press spacebar to show current operations","Type a keyword or wild card to search in root":"Type a keyword or wild card to search in root","Toggle side panel":"Toggle side panel","Open or close the side panel":"Open or close the side panel",Projects:"Projects","Toggle Sidebar":"Toggle Sidebar","Sample HTML5 Site":"Sample HTML5 Site",
"Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.":"Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.","Sample Orion Plugin":"Sample Orion Plugin","Generate a sample plugin for integrating with Orion.":"Generate a sample plugin for integrating with Orion.",Browser:"Web Browser",OutlineProgress:"Getting outline for ${0} from ${1}",UnknownError:"An unknown error occurred.",UnknownWarning:"An unknown warning occurred.",Filter:"Filter (* = any string, ? = any character)",
"To view the browser's context menu, trigger the context menu again.":"To view the browser's context menu, trigger the context menu again.",Edit:"Edit",CentralNavTooltip:"Toggle Navigation Menu"});define("orion/nls/messages",["orion/i18n!orion/nls/messages","orion/nls/root/messages"],function(f,m){var q={root:m};Object.keys(f).forEach(function(b){"undefined"===typeof q[b]&&(q[b]=f[b])});return q});
(function(){function f(r){if("string"!==typeof r)throw new TypeError;}function m(r){return r?r.split("&"):[]}function q(r){return 0===r.length?"":r.join("&")}function b(r){var a=/([^=]*)(?:=?)(.*)/.exec(r),r=a[1]?decodeURIComponent(a[1]):"",a=a[2]?decodeURIComponent(a[2]):"";return[r,a]}function l(r){var a=encodeURIComponent(r[0]);r[1]&&(a+="="+encodeURIComponent(r[1]));return a}function g(r,a){var c="",t=[],d=0;return{next:function(){c!==r.query&&(c=r.query,t=m(c));if(d<t.length){var k=b(t[d++]);
switch(a){case "keys":return k[0];case "values":return k[1];case "keys+values":return[k[0],k[1]];default:throw new TypeError;}}throw A;}}}function e(r){Object.defineProperty(this,"_url",{get:function(){return r._url}})}function d(r){return r?/[1-9]\d*$/.exec(r)[0]:""}function h(r){var a=[];r.split("/").forEach(function(r){".."===r?a.pop():"."!==r&&a.push(r)});return a.join("/")}function c(r,a){if("string"!==typeof r)throw new TypeError;var r=r.replace(/\s/g,function(r){return"%"+r.charCodeAt(0).toString(16)}),
c=p.exec(r);if(!c)return null;var t={};t.scheme=c[1]||"";if(t.scheme&&!s.test(t.scheme))return null;var k=c[2];if(k&&(k=u.exec(k),t.userinfo=k[1],t.host=k[2],t.port=k[3],t.port&&!w.test(t.port)))return null;t.path=c[3];t.query=c[4];t.fragment=c[5];!t.scheme&&a&&(t.scheme=a.scheme,!t.host&&a.host&&(t.userinfo=a.userinfo,t.host=a.host,t.port=a.port,t.pathRelative=!0));t.pathRelative&&(t.path?"/"!==t.path[0]&&(c=/^(.*\/)[^\/]*$/.exec(a.path)[1]||"/",t.path=c+t.path):t.path=a.path);t.scheme&&(t.scheme=
t.scheme.toLowerCase());t.port&&(t.port=d(t.port));t.host&&t.path&&(t.path=h(t.path));return t}function a(r,a){var t;if(a){a=a.href||a;t=c(a);if(!t||!t.scheme)throw new SyntaxError;Object.defineProperty(this,"_baseURL",{value:t})}t=c(r,t);if(!t)throw new SyntaxError;Object.defineProperty(this,"_input",{value:r,writable:!0});Object.defineProperty(this,"_url",{value:t,writable:!0});var d=new e(this);Object.defineProperty(this,"query",{get:function(){return this._url?d:null},enumerable:!0})}try{var k;
if("function"===typeof window.URL&&0!==window.URL.length&&"http:"===(k=new window.URL("http://www.w3.org?q")).protocol&&k.query)return}catch(n){}var p=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,u=/^(?:(.*)@)?(\[[^\]]*\]|[^:]*)(?::(.*))?$/,s=/^([a-zA-Z](?:[a-zA-Z0-9+-.])*)$/,w=/^\d*$/,y=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)$/,x=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)(?::(\d*))?$/,v=/^([^?#\s]*)$/,z=/^([^\s]*)$/,r=/^\S*$/,t=/([^:]*):?(.*)/,A="undefined"!==typeof StopIteration?StopIteration:
Error("Stop Iteration"),D={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"};Object.defineProperties(e.prototype,{get:{value:function(r){f(r);var a;m(this._url.query).some(function(t){t=b(t);if(t[0]===r)return a=t[1],!0});return a},enumerable:!0},set:{value:function(r,a){f(r);f(a);var t=m(this._url.query);t.some(function(c,d){var k=b(c);if(k[0]===r)return k[1]=a,t[d]=l(k),!0})||t.push(l([r,a]));this._url.query=q(t)},enumerable:!0},has:{value:function(r){f(r);return m(this._url.query).some(function(a){if(b(a)[0]===
r)return!0})},enumerable:!0},"delete":{value:function(r){f(r);var a=m(this._url.query),t=a.filter(function(a){return b(a)[0]!==r});return t.length!==a.length?(this._url.query=q(t),!0):!1},enumerable:!0},clear:{value:function(){this._url.query=""},enumerable:!0},forEach:{value:function(r,a){if("function"!==typeof r)throw new TypeError;var t=g(this._url,"keys+values");try{for(;;){var c=t.next();r.call(a,c[1],c[0],this)}}catch(d){if(d!==A)throw d;}},enumerable:!0},keys:{value:function(){return g(this._url,
"keys")},enumerable:!0},values:{value:function(){return g(this._url,"values")},enumerable:!0},items:{value:function(){return g(this._url,"keys+values")}},size:{get:function(){return m(this._url.query).length},enumerable:!0},getAll:{value:function(r){f(r);var a=[];m(this._url.query).forEach(function(t){t=b(t);t[0]===r&&a.push(t[1])});return a},enumerable:!0},append:{value:function(r,a){f(r);f(a);var t=m(this._url.query);t.push(l([r,a]));this._url.query=q(t)},enumerable:!0}});Object.defineProperties(a.prototype,
{href:{get:function(){var r;if(this._url){r=this._url;var a=r.scheme?r.scheme+":":"";r.host&&(a+="//",r.userinfo&&(a+=r.userinfo+"@"),a+=r.host,r.port&&(a+=":"+r.port));a+=r.path;r.query&&(a+="?"+r.query);r.fragment&&(a+="#"+r.fragment);r=a}else r=this._input;return r},set:function(r){f(r);this._input=r;this._url=c(this._input,this._baseURL)},enumerable:!0},origin:{get:function(){return this._url&&this._url.host?this.protocol+"//"+this.host:""},enumerable:!0},protocol:{get:function(){return this._url?
this._url.scheme+":":":"},set:function(r){f(r);if(this._url&&(r=":"===r.slice(-1)?r.substring(0,r.length-1):r,""===r||s.test(r)))this._url.scheme=r.toLowerCase()},enumerable:!0},_userinfo:{get:function(){return this._url?this._url.userinfo:""},set:function(r){f(r);this._url&&(this._url.userinfo=r)}},username:{get:function(){if(!this._url)return"";var r=t.exec(this._userinfo);return decodeURIComponent(r[1]||"")},set:function(r){f(r);if(this._url){var a=t.exec(this._userinfo),r=[encodeURIComponent(r||
"")];a[2]&&r.push(a[2]);this._userinfo=r.join(":")}},enumerable:!0},password:{get:function(){if(!this._url)return"";var r=t.exec(this._userinfo);return decodeURIComponent(r[2]||"")},set:function(r){f(r);if(this._url){var a=[t.exec(this._userinfo)[1]||""];r&&a.push(encodeURIComponent(r));this._userinfo=a.join(":")}},enumerable:!0},host:{get:function(){var r="";this._url&&this._url.host&&(r+=this._url.host,this._url.port&&(r+=":"+this._url.port));return r},set:function(r){f(r);if(this._url&&(r=x.exec(r)))this._url.host=
r[1],this._url.port=d(r[2])},enumerable:!0},hostname:{get:function(){return this._url?this._url.host:""},set:function(r){f(r);this._url&&y.exec(r)&&(this._url.host=r)},enumerable:!0},port:{get:function(){var r=this._url?this._url.port||"":"";r&&r===D[this.protocol]&&(r="");return r},set:function(r){f(r);this._url&&w.exec(r)&&(this._url.port=d(r))},enumerable:!0},pathname:{get:function(){return this._url?this._url.path:""},set:function(r){f(r);this._url&&v.exec(r)&&(this._url.host&&(r&&"/"!==r[0])&&
(r="/"+r),this._url.path=r?h(r):"")},enumerable:!0},search:{get:function(){return this._url&&this._url.query?"?"+this._url.query:""},set:function(r){f(r);this._url&&(r&&"?"===r[0]&&(r=r.substring(1)),z.exec(r)&&(this._url.query=r))},enumerable:!0},hash:{get:function(){return this._url&&this._url.fragment?"#"+this._url.fragment:""},set:function(a){f(a);this._url&&(a&&"#"===a[0]&&(a=a.substring(1)),r.exec(a)&&(this._url.fragment=a))},enumerable:!0}});if((k=window.URL||window.webkitURL)&&k.createObjectURL)Object.defineProperty(a,
"createObjectURL",{value:k.createObjectURL.bind(k),enumerable:!1}),Object.defineProperty(a,"revokeObjectURL",{value:k.revokeObjectURL.bind(k),enumerable:!1});window.URL=a})();define("orion/URL-shim",function(){});
define("orion/fileUtils",["require","i18n!orion/nls/messages","orion/URL-shim"],function(f){return{makeRelative:function(f){if(!f)return f;var q=window.location.protocol+"//"+window.location.host;return 0===f.indexOf(q)?f.substring(q.length):f},isAtRoot:function(m){if(!m)return!1;if("/workspace"===m)return!0;var q=new URL(f.toUrl("workspace"),window.location.href);return 0===(new URL(m,window.location.href)).href.indexOf(q.href)}}});
define("orion/webui/treetable",["i18n!orion/nls/messages","orion/webui/littlelib"],function(f,m){function q(b){this._init(b)}q.prototype={_init:function(b){var l=b.parent,g=this,l=m.node(l);if(!l)throw f["no parent"];if(!b.model)throw f["no tree model"];if(!b.renderer)throw f["no renderer"];this._parent=l;this._treeModel=b.model;this._onComplete=b.onComplete;this._renderer=b.renderer;this._showRoot=void 0===b.showRoot?!1:b.showRoot;this._indent=void 0===b.indent?16:b.indent;this._onCollapse=b.onCollapse;
this._labelColumnIndex=void 0===b.labelColumnIndex?0:b.labelColumnIndex;this._id=void 0===b.id?"treetable":b.id;this._tableStyle=b.tableStyle;this._tableElement=b.tableElement||"table";this._tableBodyElement=b.tableBodyElement||"tbody";this._tableRowElement=b.tableRowElement||"tr";this._root=this._treeModel.getRoot(function(b){g._showRoot?(b._depth=0,g._generate([b],0)):g._treeModel.getChildren(b,function(d){g.destroyed||g._generate(d,0)})})},destroy:function(){this.destroyed=!0},_generate:function(b,
l){m.empty(this._parent);var g=document.createElement("div");this._renderer.wrapperCallback&&this._renderer.wrapperCallback(g);var e=document.createElement(this._tableElement);this._renderer.tableCallback&&this._renderer.tableCallback(e);e.id=this._id;this._tableStyle&&e.classList.add(this._tableStyle);this._renderer.initTable(e,this);this._bodyElement=document.createElement(this._tableBodyElement);this._renderer.bodyCallback&&this._renderer.bodyCallback(this._bodyElement);this._bodyElement.id=this._id+
"tbody";0===b.length?this._renderer.emptyCallback&&this._renderer.emptyCallback(this._bodyElement):this._generateChildren(b,l);e.appendChild(this._bodyElement);g.appendChild(e);this._parent.appendChild(g);this._rowsChanged();this._onComplete&&this._onComplete(this)},_generateChildren:function(b,l,g){for(var e=0;e<b.length;e++){var d=document.createElement(this._tableRowElement);d.id=this._treeModel.getId(b[e]);d._depth=l;d._item=b[e];this._renderer.render(b[e],d);d.childNodes[this._labelColumnIndex].style.paddingLeft=
this._indent*l+"px";this._renderer.rowCallback&&this._renderer.rowCallback(d,b[e]);g?(this._bodyElement.insertBefore(d,g.nextSibling),g&&(g=d)):this._bodyElement.appendChild(d)}},_rowsChanged:function(){this._renderer.rowsChanged&&this._renderer.rowsChanged()},getSelected:function(){return this._renderer.getSelected()},refresh:function(b,l,g){var e=this._treeModel.getId(b),d;if(e===this._id)this._removeChildRows(e),this._generateChildren(l,0),this._rowsChanged();else{var h=m.node(e);h?(h._item=b,
h&&(g||h._expanded)?(this._removeChildRows(e),l?(h._expanded=!0,this._renderer.updateExpandVisuals(h,!0),this._generateChildren(l,h._depth+1,h),this._rowsChanged()):(d=this,this._renderer.updateExpandVisuals(h,"progress"),l=this._treeModel.getChildren(h._item,function(c){d.destroyed||(d._renderer.updateExpandVisuals(h,!0),h._expanded||(h._expanded=!0,d._generateChildren(c,h._depth+1,h),d._rowsChanged()))}))):this._renderer.updateExpandVisuals(h,!1)):console.log(f["could not find table row "]+e)}},
getItem:function(b){var l=m.node(b);return l&&l._item?l._item:b},toggle:function(b){var l=m.node(b);l&&(l._expanded?this.collapse(b):this.expand(b))},isExpanded:function(b){b="string"===typeof b?b:this._treeModel.getId(b);return(b=m.node(b))?b._expanded:!1},expand:function(b,l,g){var b="string"===typeof b?b:this._treeModel.getId(b),e=m.node(b);if(e)if(e._expanded)l&&l.apply(d,g);else{var d=this;this._renderer.updateExpandVisuals(e,"progress");this._treeModel.getChildren(e._item,function(b){d.destroyed||
(d._renderer.updateExpandVisuals(e,!0),e._expanded||(e._expanded=!0,d._generateChildren(b,e._depth+1,e),d._rowsChanged()),l&&l.apply(d,g))})}},_removeChildRows:function(b){for(var l=b===this._id,g=!1,e=-1,d=[],h=m.$$array(".treeTableRow",this._parent),c=0;c<h.length;c++){var a=h[c];if(g)break;l?a._depth>e?d.push(a):g=!0:a.id===b&&(l=!0,e=a._depth)}for(b=0;b<d.length;b++)l=d[b],l.parentNode.removeChild(l)},collapse:function(b){var b="string"===typeof b?b:this._treeModel.getId(b),l=m.node(b);if(l){if(!l._expanded)return;
l._expanded=!1;this._renderer.updateExpandVisuals(l,!1);this._removeChildRows(b);this._rowsChanged()}this._onCollapse&&this._onCollapse(l._item)},getIndent:function(){return this._indent}};q.prototype.constructor=q;return{TableTree:q}});
define("orion/treeModelIterator",[],function(){var f={},m=function(f,b){this.firstLevelChildren=f;this.reset();this._init(b)};m.prototype={_init:function(f){f&&(this.isExpanded=f.isExpanded,this.isExpandable=f.isExpandable,this.forceExpandFunc=f.forceExpandFunc,this.getChildrenFunc=f.getChildrenFunc)},topLevel:function(f){return f.parent?f.parent===this.root:!0},_getChildren:function(f){return"function"===typeof this.getChildrenFunc?this.getChildrenFunc(f):f?f.children:null},_expanded:function(f){if(!f)return!0;
var b=this._getChildren(f),b=b&&0<b.length;this.isExpanded&&b&&(b=this.isExpanded(f));return b},_expandable:function(f){return!f?!0:this.isExpandable?this.isExpandable(f):!1},_diveIn:function(f){return this._expanded(f)?(f=this._getChildren(f),this.setCursor(f[0]),this.cursor()):null},_drillToLast:function(f){return this._expanded(f)?(f=this._getChildren(f),this._drillToLast(f[f.length-1])):f},_forward:function(f){if(!this._cursor)return null;var b=this._diveIn(this._cursor);if(!b){if(f&&this._expandable(this._cursor)&&
this.forceExpandFunc){var l=this;return this.forceExpandFunc(this._cursor,"first",function(b){b&&l.setCursor(b)})}(b=this._findSibling(this._cursor,!0))&&this.setCursor(b)}return b},_backward:function(f){if(!this._cursor)return null;var b=this._findSibling(this._cursor,!1);b&&b!==this._cursor.parent&&(b=this._drillToLast(b));if(f&&b&&this._expandable(b)&&this.forceExpandFunc&&b!==this._cursor.parent){var l=this;return this.forceExpandFunc(b,"last",function(b){b&&l.setCursor(b)})}b&&this.setCursor(b);
return b},_findSibling:function(f,b){for(var l=this.topLevel(f),g=this._getChildren(f.parent),g=l?this.firstLevelChildren:g,e=0;e<g.length;e++)if(g[e]===f)return 0===e&&!b?l?null:f.parent:e===g.length-1&&b?l?null:this._findSibling(f.parent,b):b?g[e+1]:g[e-1];return null},_inParentChain:function(f,b){for(var l=f.parent;l;){if(l===b)return!0;l=l.parent}return!1},_getTopLevelParent:function(f){if(this.topLevel(f))return f;for(f=f.parent;f;){if(this.topLevel(f))return f;f=f.parent}return null},_onCollapse:function(f){return this._expanded(f.parent)?
f:this._onCollapse(f.parent)},_scan:function(f,b,l){this.setCursor(b);var g=[];for(g.push(b);;){if(this.iterate(f))g.push(this.cursor());else break;if(l===this.cursor())return g}return null},setCursor:function(f){this._prevCursor=this._cursor;this._cursor=f},setTree:function(f){this.firstLevelChildren=f;0<this.firstLevelChildren.length&&(this.root=this.firstLevelChildren[0].parent)},scan:function(f,b){var l=this.cursor(),g=this._scan(!0,f,b);g||(g=this._scan(!1,f,b));this.setCursor(l);return g},iterate:function(f,
b){return f?this._forward(b):this._backward(b)},iterateOnTop:function(f,b){var l=this._findSibling(this._getTopLevelParent(this.cursor()),f);l?this.setCursor(l):b&&0<this.firstLevelChildren.length&&this.setCursor(f?this.firstLevelChildren[0]:this.firstLevelChildren[this.firstLevelChildren.length-1])},collapse:function(f){return!this._cursor?null:this._inParentChain(this._cursor,f)?(this.setCursor(f),this._cursor):null},reset:function(){this.root=this._prevCursor=this._cursor=null;0<this.firstLevelChildren.length&&
(this._cursor=this.firstLevelChildren[0],this.root=this.firstLevelChildren[0].parent)},cursorMoved:function(){return this._cursor!==this._prevCursor},cursor:function(){return this._cursor},prevCursor:function(){return this._prevCursor}};f.TreeModelIterator=m;return f});
define("orion/uiUtils",["orion/webui/littlelib"],function(f){function m(b){var l="",g=-1!==navigator.platform.indexOf("Mac");g?(b.mod4&&(l+="\u2303"),b.mod3&&(l+="\u2325"),b.mod2&&(l+="\u21e7"),b.mod1&&(l+="\u2318")):(b.mod1&&(l+="Ctrl+"),b.mod2&&(l+="Shift+"),b.mod3&&(l+="Alt+"));if(b.alphaKey)return l+b.alphaKey;if("keypress"===b.type)return l+b.keyCode;for(var e in f.KEY)if(typeof("number"===f.KEY[e])&&f.KEY[e]===b.keyCode){if(g)switch(f.KEY[e]){case f.KEY.BKSPC:e="\u232b";break;case f.KEY.TAB:e=
"\u21e5";break;case f.KEY.ENTER:e="\u23ce";break;case f.KEY.ESCAPE:e="\u238b";break;case f.KEY.SPACE:e="\u2423";break;case f.KEY.PAGEUP:e="\u21de";break;case f.KEY.PAGEDOWN:e="\u21df";break;case f.KEY.END:e="\u21f2";break;case f.KEY.HOME:e="\u21f1";break;case f.KEY.DEL:e="\u2326"}switch(f.KEY[e]){case f.KEY.DOWN:e="\u2193";break;case f.KEY.UP:e="\u2191";break;case f.KEY.RIGHT:e="\u2192";break;case f.KEY.LEFT:e="\u2190"}return l+e}var d;switch(b.keyCode){case 59:d=b.mod2?":":";";break;case 61:d=b.mod2?
"+":"=";break;case 188:d=b.mod2?"<":",";break;case 190:d=b.mod2?">":".";break;case 191:d=b.mod2?"?":"/";break;case 192:d=b.mod2?"~":"`";break;case 219:d=b.mod2?"{":"[";break;case 220:d=b.mod2?"|":"\\";break;case 221:d=b.mod2?"}":"]";break;case 222:d=b.mod2?'"':"'"}return d?l+d:112<=b.keyCode&&123>=b.keyCode?l+"F"+(b.keyCode-111):l+String.fromCharCode(b.keyCode)}function q(b){var l=-1!==window.navigator.platform.indexOf("Mac");return l&&b.metaKey||!l&&b.ctrlKey}return{getUserKeyString:function(b){for(var l=
"",b=b.getKeys(),g=0;g<b.length;g++)0!==g&&(l+=" "),l+=m(b[g]);return l},getUserText:function(b){var l=b.id,g=b.refNode,e=b.hideRefNode,d=b.initialText,h=b.onComplete,c=b.onEditDestroy,a=b.selectTo,k=b.isInitialValid,b=b.insertAsChild,n=!1,p=function(a){return function(p){if(!n){var b=f.node(l),u=b.value;b&&(a&&p.keyCode===f.KEY.ESCAPE?(e&&(g.style.display="inline"),n=!0,b.parentNode.removeChild(b),c&&c()):a&&p.keyCode!==f.KEY.ENTER||(0===u.length||!k&&u===d?e&&(g.style.display="inline"):(h(u),e&&
g.parentNode&&(g.style.display="inline")),n=!0,b.parentNode&&b.parentNode.removeChild(b),c&&c()))}}},u=document.createElement("input");u.id=l;u.value=d||"";b?g.appendChild(u):g.parentNode.insertBefore(u,g.nextSibling);u.classList.add("userEditBoxPrompt");e&&(g.style.display="none");u.addEventListener("keydown",p(!0),!1);u.addEventListener("blur",p(!1),!1);window.setTimeout(function(){u.focus();if(d){var c=f.node(l),k=a?d.indexOf(a):-1;0<k?c.createTextRange?(c=c.createTextRange(),c.collapse(!0),c.moveStart("character",
0),c.moveEnd("character",k),c.select()):c.setSelectionRange?c.setSelectionRange(0,k):void 0!==c.selectionStart&&(c.selectionStart=0,c.selectionEnd=k):c.select()}},0)},openInNewWindow:q,followLink:function(b,l){l&&q(l)?window.open(b):window.location=b},createButton:function(b,l){var g=document.createElement("button");g.className="orionButton commandButton commandMargins";g.addEventListener("click",function(b){l();f.stop(b)},!1);b&&g.appendChild(document.createTextNode(b));return g},createDropdownButton:function(){},
isFormElement:function(b){switch(b.tagName.toLowerCase()){case "button":case "fieldset":case "form":case "input":case "keygen":case "label":case "legend":case "meter":case "optgroup":case "output":case "progress":case "select":case "textarea":return!0}return!1}}});
define("orion/explorers/explorerNavHandler",["orion/webui/littlelib","orion/treeModelIterator","orion/uiUtils"],function(f,m,q){var b={},l=-1!==navigator.userAgent.indexOf("iPad"),g=-1!==window.navigator.platform.indexOf("Mac"),e=function(d,b,c){this.explorer=d;this.model=this.explorer.model;this._navDict=b;this._listeners=[];this._selections=[];this._currentColumn=0;d=this._getEventListeningDiv();d.tabIndex=0;d.classList.add("selectionModelContainer");var a=this;this._modelIterator=new m.TreeModelIterator([],
{isExpanded:this.isExpanded.bind(this),getChildrenFunc:c.getChildrenFunc,isExpandable:this.explorer.renderer.isExpandable?function(c){return a.explorer.renderer.isExpandable(c)}:function(c){return a.isExpandable(c)},forceExpandFunc:this.explorer.forceExpandFunc?function(c,d,p){return a.explorer.forceExpandFunc(c,d,p)}:void 0});this._init(c);(!c||!1!==c.setFocus)&&d.focus();c=function(c){if(q.isFormElement(c.target)||a.explorer.preventDefaultFunc&&a.explorer.preventDefaultFunc(c,a._modelIterator.cursor()))return!0;
if(c.keyCode===f.KEY.DOWN)return a.onDownArrow(c);if(c.keyCode===f.KEY.UP)return a.onUpArrow(c);if(c.keyCode===f.KEY.RIGHT)return a.onRightArrow(c);if(c.keyCode===f.KEY.LEFT)return a.onLeftArrow(c);if(c.keyCode===f.KEY.SPACE)return a.onSpace(c);if(c.keyCode===f.KEY.ENTER)return a.onEnter(c)};d.addEventListener("keydown",c,!1);this._listeners.push({type:"keydown",listener:c});c=function(){if(a.explorer.onFocus)a.explorer.onFocus(!1);else a.toggleCursor(null,!1)};d.addEventListener("blur",c,!1);this._listeners.push({type:"blur",
listener:c});c=function(){if(a.explorer.onFocus)a.explorer.onFocus(!0);else a.toggleCursor(null,!0)};d.addEventListener("focus",c,!1);this._listeners.push({type:"focus",listener:c});this._parentDiv=d};e.prototype={destroy:function(){this._parentDiv.classList.remove("selectionModelContainer");this.removeListeners()},_init:function(d){this._linearGridMove=!1;d&&(this._selectionPolicy=d.selectionPolicy,this.gridClickSelectionPolicy=d.gridClickSelectionPolicy||"none",this.preventDefaultFunc=d.preventDefaultFunc,
this.postDefaultFunc=d.postDefaultFunc)},_ctrlKeyOn:function(d){return g?d.metaKey:d.ctrlKey},removeListeners:function(){if(this._listeners)for(var d=0;d<this._listeners.length;d++)this._parentDiv.removeEventListener(this._listeners[d].type,this._listeners[d].listener,!1)},focus:function(){var d=this._getEventListeningDiv();d&&d.focus()},_getEventListeningDiv:function(d){return this.explorer.keyEventListeningDiv&&"function"===typeof this.explorer.keyEventListeningDiv?this.explorer.keyEventListeningDiv(d):
f.node(this.explorer._parentId)},isExpandable:function(d){return!d?!1:f.node(this.explorer.renderer.expandCollapseImageId(this.model.getId(d)))?!0:!1},isExpanded:function(d){return!d?!1:this.explorer.myTree.isExpanded(this.model.getId(d))},refreshSelection:function(d,b){var c=this;this.explorer.selection&&this.explorer.selection.getSelections(function(a){c._clearSelection(b);for(var k=0;k<a.length;k++)c._selections.push(a[k]);0<c._selections.length?c.cursorOn(c._selections[0],!0,!1,d):c.cursorOn(null,
!1,!1,d);c._shiftSelectionAnchor&&0<=c._inSelection(c._shiftSelectionAnchor)||(c._shiftSelectionAnchor=null)})},refreshModel:function(d,b,c,a){this._currentColumn=0;this.topIterationNodes=[];this.model=b;this._navDict=d;this.model.getTopIterationNodes?this.topIterationNodes=this.model.getTopIterationNodes():c&&(this.topIterationNodes=c);this._modelIterator.setTree(this.topIterationNodes);!a&&this.explorer.selection&&(this.toggleCursor(this._modelIterator.cursor(),!1),this._modelIterator.reset());
this.refreshSelection(!0)},getTopLevelNodes:function(){return this._modelIterator.firstLevelChildren},_inSelection:function(d){for(var d=this.model.getId(d),b=0;b<this._selections.length;b++)if(d===this.model.getId(this._selections[b]))return b;return-1},_clearSelection:function(d){if(d)for(d=0;d<this._selections.length;d++)this._checkRow(this._selections[d],!0);this._selections=[]},getSelectionPolicy:function(){return this._selectionPolicy},setSelectionPolicy:function(d){this._selectionPolicy!==
d&&(this._selectionPolicy=d,"cursorOnly"===this._selectionPolicy&&this._clearSelection(!0))},setSelection:function(d,b,c){"cursorOnly"===this._selectionPolicy?b&&this.explorer.renderer._useCheckboxSelection&&this._checkRow(d,!0):this._isRowSelectable(d)&&(!b||"singleSelection"===this._selectionPolicy?(this._clearSelection(!0),this._checkRow(d,!1),this._selections.push(d),this._lastSelection=d):(b=this._inSelection(d),0<=b?(this._checkRow(d,!0),this._selections.splice(b,1)):(this._checkRow(d,!1),this._selections.push(d),
this._lastSelection=d)),c&&(this._shiftSelectionAnchor=this._lastSelection),this.explorer.selection&&(this.explorer.renderer.storeSelections(),this.explorer.selection.setSelections(this._selections)))},moveColumn:function(d,b){d||(d=this.currentModel());var c=this._getGridChildren(d);if(c&&1<c.length||0===b&&c){0!==b&&this.toggleCursor(d,!1);var a=this._currentColumn,k=!0,a=a+b;0>a?(this._linearGridMove&&0!==b&&(this._modelIterator.iterate(!1)?d=this.currentModel():k=!1),a=k?c.length-1:this._currentColumn):
a>=c.length&&(this._linearGridMove&&0!==b&&(this._modelIterator.iterate(!0)?d=this.currentModel():k=!1),a=k?0:this._currentColumn);this._currentColumn=a;0!==b&&this.toggleCursor(d,!0);return!0}return!1},_getGridChildren:function(d){return this._navDict?this._navDict.getGridNavHolder(d):null},getCurrentGrid:function(d){d||(d=this.currentModel());return(d=this._getGridChildren(d))&&0<d.length?d[this._currentColumn]:null},getAriaContainerElement:function(d){for(var b=this._parentDiv,c;d&&d!==b&&"grid"!==
(c=d.getAttribute("role"))&&"tree"!==c&&"treegrid"!==c;)d=d.parentNode;return d===b?null:d},toggleCursor:function(d,b){var c=this.getRowDiv(d),a=this.getCurrentGrid(d);a?(c&&(b?c.classList.add("treeIterationCursorRow"):c.classList.remove("treeIterationCursorRow")),a.domNode&&(c=this.getAriaContainerElement(a.domNode),b?(a.domNode.classList.add("treeIterationCursor"),c&&c.setAttribute("aria-activedescendant",a.domNode.id)):a.domNode.classList.remove("treeIterationCursor"))):c&&(b?c.classList.add("treeIterationCursorRow_Dotted"):
c.classList.remove("treeIterationCursorRow_Dotted"))},currentModel:function(){return this._modelIterator.cursor()},cursorOn:function(d,b,c,a){var k,n;if(d||b){if(n===this._modelIterator.cursor())return;k=this._modelIterator.cursor();n=d;this._modelIterator.setCursor(n)}else k=this._modelIterator.prevCursor(),n=this._modelIterator.cursor();if(k!==n||b)if(this.toggleCursor(k,!1),!b||n){this.moveColumn(null,0);this.toggleCursor(n,!0);if((d=this.getRowDiv())&&!a){a=d.parentNode;for(b=document.documentElement;a&&
a!==b;){var p=window.getComputedStyle(a,null);if(!p)break;p=p.getPropertyValue("overflow-y");if("auto"===p||"scroll"===p)break;a=a.parentNode}a&&(b=!0,d.offsetTop<=a.scrollTop?(b=!1,void 0===c&&(c=!1)):d.offsetTop+d.offsetHeight>=a.scrollTop+a.clientHeight&&(b=!1,void 0===c&&(c=!0)),b||d.scrollIntoView(!c))}if(this.explorer.onCursorChanged)this.explorer.onCursorChanged(k,n)}},getSelection:function(){return this._selections},getSelectionIds:function(){for(var d=[],b=0;b<this._selections.length;b++)d.push(this.model.getId(this._selections[b]));
return d},getRowDiv:function(d){d=d?d:this._modelIterator.cursor();if(!d)return null;var d=this.model.getId(d),b=this._navDict.getValue(d);return b&&b.rowDomNode?b.rowDomNode:f.node(d)},iterate:function(d,b,c,a){var k=null;if(this.topIterationNodes&&0!==this.topIterationNodes.length)if(a){a=this.currentModel();for((k=this._modelIterator.iterate(d,b))&&this._setCursorOnItem(d,c);k&&k.isNotSelectable;)(k=this._modelIterator.iterate(d,b))&&this._setCursorOnItem(d,c);k||(this.cursorOn(a,!0,!1,!0),this._setCursorOnItem(d,
c))}else(k=this._modelIterator.iterate(d,b))&&this._setCursorOnItem(d,c)},_setCursorOnItem:function(d,b){this.cursorOn(null,!1,d);if(b){var c=this._inSelection(this._modelIterator.prevCursor()),a=this._inSelection(this._modelIterator.cursor());0<=c&&0<=a?this.setSelection(this._modelIterator.prevCursor(),!0):this.setSelection(this.currentModel(),!0)}},_checkRow:function(d,b){if(this.explorer.renderer._useCheckboxSelection){var c=this.getRowDiv(d);if(c){var a=f.node(this.explorer.renderer.getCheckBoxId(c.id)),
k=b?!a.checked:!0;if(k!==a.checked)this.explorer.renderer.onCheck(c,a,k,!0)}}else this._select(d,b)},_select:function(d){d||(d=this._modelIterator.cursor());var b=this.getRowDiv(d);b&&(0>this._inSelection(d)?b.classList.add("checkedRow"):b.classList.remove("checkedRow"))},_onModelGrid:function(d,b){var c=this._getGridChildren(d);if(c)for(var a=0;a<c.length;a++)if(b.target===c[a].domNode)return!0;return!1},onClick:function(d,b){if(this.isDisabled(this.getRowDiv(d)))f.stop(b);else{var c=f.node(this.explorer.renderer.expandCollapseImageId(this.model.getId(d)));
if(b.target!==c&&!("none"===this.gridClickSelectionPolicy&&this._onModelGrid(d,b)))if(this.cursorOn(d,!0,!1,!0),l)this.setSelection(d,!0);else if(this._ctrlKeyOn(b))this.setSelection(d,!0,!0);else if(b.shiftKey&&this._shiftSelectionAnchor){if(c=this._modelIterator.scan(this._shiftSelectionAnchor,d)){this._clearSelection(!0);for(var a=0;a<c.length;a++)this.setSelection(c[a],!0)}}else this.setSelection(d,!1,!0)}},onCollapse:function(d){this._modelIterator.collapse(d)&&this.cursorOn()},onUpArrow:function(d){this.iterate(!1,
!1,d.shiftKey,!0);!this._ctrlKeyOn(d)&&!d.shiftKey&&this.setSelection(this.currentModel(),!1,!0);d.preventDefault();return!1},onDownArrow:function(d){this.iterate(!0,!1,d.shiftKey,!0);!this._ctrlKeyOn(d)&&!d.shiftKey&&this.setSelection(this.currentModel(),!1,!0);d.preventDefault();return!1},_shouldMoveColumn:function(d){var b=this.currentModel(),c=this._getGridChildren(b);return c&&1<c.length?this.isExpandable(b)?this._ctrlKeyOn(d):!0:!1},onLeftArrow:function(d){if(this._shouldMoveColumn(d))return this.moveColumn(null,
-1),d.preventDefault(),!0;var b=this._modelIterator.cursor();if(!b)return!1;if(this.isExpandable(b)&&this.isExpanded(b))return this.explorer.myTree.collapse(b),d.preventDefault(),!0;this._modelIterator.topLevel(b)?this.explorer.scopeUp&&"function"===typeof this.explorer.scopeUp&&this.explorer.scopeUp():(this.cursorOn(b.parent),this.setSelection(b.parent,!1,!0))},onRightArrow:function(d){if(this._shouldMoveColumn(d))return this.moveColumn(null,1),d.preventDefault(),!0;var b=this._modelIterator.cursor();
if(!b)return!1;if(this.isExpandable(b)&&!this.isExpanded(b))return this.explorer.myTree.expand(b),this.explorer.postUserExpand&&this.explorer.postUserExpand(this.model.getId(b)),d.preventDefault(),!1},_isRowSelectable:function(d){return this.explorer.isRowSelectable?this.explorer.isRowSelectable(d):!0},onSpace:function(d){this.setSelection(this.currentModel(),!0,!0);d.preventDefault()},onEnter:function(d){var b=this.getCurrentGrid(this._modelIterator.cursor());if(b)if(b.widget)if("function"===typeof b.onClick)b.onClick();
else"function"===typeof b.widget.focus&&b.widget.focus();else{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,0,0,this._ctrlKeyOn(d),!1,!1,!1,0,null);b.domNode.dispatchEvent(c)}else if(b=this._modelIterator.cursor())if(this.explorer.renderer.getRowActionElement&&(c=this.explorer.renderer.getRowActionElement(this.model.getId(b)),c.href&&(this._ctrlKeyOn(d)?window.open(c.href):window.location.href=c.href)),this.explorer.renderer.performRowAction)return this.explorer.renderer.performRowAction(d,
b),d.preventDefault(),!1},setIsNotSelectable:function(d,b){d.isNotSelectable=b},disableItem:function(d){var b=this.getRowDiv(d);this.isExpandable(d)&&this.isExpanded(d)&&(this._modelIterator.collapse(d),this.explorer.myTree.toggle(b.id));b.classList.remove("checkedRow");b.classList.add("disabledNavRow");this.setIsNotSelectable(d,!0)},isDisabled:function(d){return d.classList.contains("disabledNavRow")},enableItem:function(d){var b=this.getRowDiv(d);b&&(b.classList.remove("disabledNavRow"),this.setIsNotSelectable(d,
!1))}};b.ExplorerNavHandler=e;e=function(d){this._dict={};this._model=d};e.prototype={addRow:function(d,b){var c=this._model.getId(d);this._dict[c]={model:d,rowDomNode:b}},getValue:function(d){return this._dict[d]},getGridNavHolder:function(d,b){if(!d)return null;var c=this._model.getId(d);return this._dict[c]?(!this._dict[c].gridChildren&&b&&(this._dict[c].gridChildren=[]),this._dict[c].gridChildren):null},initGridNavHolder:function(d){if(!d)return null;d=this._model.getId(d);this._dict[d]&&(this._dict[d].gridChildren=
null)}};b.ExplorerNavDict=e;return b});
define("orion/webui/dropdown",["require","orion/webui/littlelib","orion/EventTarget"],function(f,m,q){function b(b){q.attach(this);this._init(b)}b.prototype={_init:function(b){this._dropdownNode=m.node(b.dropdown);if(!this._dropdownNode)throw"no dom node for dropdown found";this._populate=b.populate;this._selectionClass=b.selectionClass;this._parentDropdown=b.parentDropdown;this._positioningNode=b.positioningNode;if(!this._parentDropdown)for(var g=this._dropdownNode.parentNode;g&&document!==g;){if(g.classList&&
g.classList.contains("dropdownMenu")){this._parentDropdown=g.dropdown;break}g=g.parentNode}this._triggerNode=b.triggerNode?b.triggerNode:m.$(".dropdownTrigger",this._dropdownNode.parentNode);if(!this._triggerNode)throw"no dom node for dropdown trigger found";if(!b.skipTriggerEventListeners){var e=this;this._triggerNode.addEventListener("click",function(d){e.toggle(d)&&m.stop(d)},!1);"span"===this._triggerNode.tagName.toLowerCase()&&this._triggerNode.addEventListener("keydown",function(d){if(d.keyCode===
m.KEY.ENTER||d.keyCode===m.KEY.SPACE)e.toggle(),m.stop(d)},!1)}this._dropdownNode.addEventListener("keydown",this._dropdownKeyDown.bind(this),!1)},addTriggerNode:function(b){var g=this;b.addEventListener("click",function(b){g.toggle(b)&&m.stop(b)},!1)},toggle:function(b){return this.isVisible()?this.close():this.open(b)},isVisible:function(){return this._isVisible},open:function(b){var g=!1;if(!this.isVisible()){this.dispatchEvent({type:"triggered",dropdown:this,event:b});m.setFramesEnabled(!1);this._populate&&
(this.empty(),this._populate(this._dropdownNode));var e=this.getItems();0<e.length&&(this._hookedAutoDismiss||(this._boundAutoDismiss?m.removeAutoDismiss(this._boundAutoDismiss):this._boundAutoDismiss=this._autoDismiss.bind(this),g=m.$$array(".dropdownSubMenu",this._dropdownNode),m.addAutoDismiss([this._triggerNode].concat(g),this._boundAutoDismiss),this._hookedAutoDismiss=!0),this._triggerNode.classList.add("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.add(this._selectionClass),
this._dropdownNode.classList.add("dropdownMenuOpen"),this._isVisible=!0,this._positionDropdown(b),e[0].focus(),g=!0,this._parentDropdown&&this._parentDropdown.submenuOpen(this))}return g},_autoDismiss:function(b){if(this.close(!1)&&this._dropdownNode.contains(b.target))for(b=this._parentDropdown;b;)b.close(!1),b=b._parentDropdown},_positionDropdown:function(){this._dropdownNode.style.left="";this._dropdownNode.style.top="";if(this._positioningNode)this._dropdownNode.style.left=this._positioningNode.offsetLeft+
"px";else{var b=m.bounds(this._dropdownNode),g=m.bounds(document.body);if(b.left+b.width>g.left+g.width)if(this._triggerNode.classList.contains("dropdownMenuItem"))this._dropdownNode.style.left=-b.width+"px";else{var e=m.bounds(this._boundingNode(this._triggerNode)),d=m.bounds(this._triggerNode);this._dropdownNode.style.left=d.left-e.left-b.width+d.width+"px"}b=b.top+b.height-(g.top+g.height);0<b&&(this._dropdownNode.style.top=Math.floor(this._dropdownNode.style.top-b)+"px")}},_boundingNode:function(b){var g=
window.getComputedStyle(b,null);return null===g||"absolute"===g.getPropertyValue("position")||!b.parentNode||b===document.body?b:this._boundingNode(b.parentNode)},close:function(b){var g=!1;this.isVisible()&&(this._triggerNode.classList.remove("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.remove(this._selectionClass),this._dropdownNode.classList.remove("dropdownMenuOpen"),m.setFramesEnabled(!0),b&&this._triggerNode.focus(),this._isVisible=!1,g=!0);return g},getItems:function(){var b=
[],g=this;m.$$array("li:not(.dropdownSeparator) > .dropdownMenuItem",this._dropdownNode,!0).forEach(function(e){e.parentNode.parentNode===g._dropdownNode&&b.push(e)});b.forEach(function(b){b._hasDropdownMouseover||(b.addEventListener("mouseover",function(d){b.dropdown?b.dropdown.open(d):(g._closeSelectedSubmenu(),m.stop(d))}),b._hasDropdownMouseover=!0)});return b},empty:function(){var b=this;m.$$array("li",this._dropdownNode).forEach(function(g){g.parentNode===b._dropdownNode&&g.parentNode.removeChild(g)});
this._hookedAutoDismiss=!1},_dropdownKeyDown:function(b){if(b.keyCode===m.KEY.UP||b.keyCode===m.KEY.DOWN||b.keyCode===m.KEY.RIGHT||b.keyCode===m.KEY.ENTER||b.keyCode===m.KEY.LEFT){var g=this.getItems(),e=document.activeElement;if(g.length&&0<g.length&&e){var d=g.indexOf(e);0>d&&(d=g.indexOf(e.parentNode));0<=d&&(b.keyCode===m.KEY.UP&&0<d?(d--,g[d].focus()):b.keyCode===m.KEY.DOWN&&d<g.length-1?(d++,g[d].focus()):b.keyCode===m.KEY.ENTER||b.keyCode===m.KEY.RIGHT?e.classList.contains("dropdownTrigger")&&
e.dropdown&&e.dropdown.open():b.keyCode===m.KEY.LEFT&&e.parentNode.parentNode.classList.contains("dropdownMenuOpen")&&this.close(!0),m.stop(b))}}else b.keyCode===m.KEY.ESCAPE&&(this.close(!0),m.stop(b))},submenuOpen:function(b){b!==this._selectedSubmenu&&(this._closeSelectedSubmenu(),this._selectedSubmenu=b)},_closeSelectedSubmenu:function(){for(var b=this._selectedSubmenu;b;)b.close(),b=b._selectedSubmenu},destroy:function(){this.empty();this._boundAutoDismiss&&m.removeAutoDismiss(this._boundAutoDismiss)}};
b.prototype.constructor=b;return{Dropdown:b}});
define("text",["module"],function(f){var m,q,b=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,g=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,e="undefined"!==typeof location&&location.href,d=e&&location.protocol&&location.protocol.replace(/\:/,""),h=e&&location.hostname,c=e&&(location.port||void 0),a=[],k=f.config&&f.config()||{};m={version:"2.0.5",strip:function(a){if(a){var a=a.replace(l,""),c=a.match(g);c&&(a=c[1])}else a="";return a},
jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:k.createXhr||function(){var a,c,d;if("undefined"!==typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!==typeof ActiveXObject)for(c=0;3>c;c+=1){d=b[c];try{a=new ActiveXObject(d)}catch(k){}if(a){b=[d];break}}return a},parseName:function(a){var c,
d,k=!1,b=a.indexOf(".");c=0===a.indexOf("./")||0===a.indexOf("../");-1!==b&&(!c||1<b)?(c=a.substring(0,b),d=a.substring(b+1,a.length)):c=a;a=d||c;b=a.indexOf("!");-1!==b&&(k="strip"===a.substring(b+1),a=a.substring(0,b),d?d=a:c=a);return{moduleName:c,ext:d,strip:k}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,b){var k,e;k=m.xdRegExp.exec(a);if(!k)return!0;a=k[2];k=k[3];k=k.split(":");e=k[1];k=k[0];return(!a||a===c)&&(!k||k.toLowerCase()===d.toLowerCase())&&(!e&&!k||e===b)},finishLoad:function(c,
d,b,e){b=d?m.strip(b):b;k.isBuild&&(a[c]=b);e(b)},load:function(a,b,l,s){if(s.isBuild&&!s.inlineText)l();else{k.isBuild=s.isBuild;var g=m.parseName(a),s=g.moduleName+(g.ext?"."+g.ext:""),f=b.toUrl(s),q=k.useXhr||m.useXhr;!e||q(f,d,h,c)?m.get(f,function(c){m.finishLoad(a,g.strip,c,l)},function(a){l.error&&l.error(a)}):b([s],function(a){m.finishLoad(g.moduleName+"."+g.ext,g.strip,a,l)})}},write:function(c,d,k){if(a.hasOwnProperty(d)){var b=m.jsEscape(a[d]);k.asModule(c+"!"+d,"define(function () { return '"+
b+"';});\n")}},writeFile:function(a,c,d,k,b){var c=m.parseName(c),e=c.ext?"."+c.ext:"",h=c.moduleName+e,l=d.toUrl(c.moduleName+e)+".js";m.load(h,d,function(){var c=function(r){return k(l,r)};c.asModule=function(r,a){return k.asModule(r,l,a)};m.write(a,h,c,b)},b)}};if("node"===k.env||!k.env&&"undefined"!==typeof process&&process.versions&&process.versions.node)q=require.nodeRequire("fs"),m.get=function(a,c){var d=q.readFileSync(a,"utf8");0===d.indexOf("\ufeff")&&(d=d.substring(1));c(d)};else if("xhr"===
k.env||!k.env&&m.createXhr())m.get=function(a,c,d,b){var e=m.createXhr(),h;e.open("GET",a,!0);if(b)for(h in b)b.hasOwnProperty(h)&&e.setRequestHeader(h.toLowerCase(),b[h]);if(k.onXhr)k.onXhr(e,a);e.onreadystatechange=function(){var b;4===e.readyState&&(b=e.status,399<b&&600>b?(b=Error(a+" HTTP status: "+b),b.xhr=e,d(b)):c(e.responseText))};e.send(null)};else if("rhino"===k.env||!k.env&&"undefined"!==typeof Packages&&"undefined"!==typeof java)m.get=function(a,c){var d,b,k=new java.io.File(a),e=java.lang.System.getProperty("line.separator"),
k=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(k),"utf-8")),h="";try{d=new java.lang.StringBuffer;(b=k.readLine())&&(b.length()&&65279===b.charAt(0))&&(b=b.substring(1));for(null!==b&&d.append(b);null!==(b=k.readLine());)d.append(e),d.append(b);h=String(d.toString())}finally{k.close()}c(h)};return m});define("text!orion/webui/dropdowntriggerbutton.html",[],function(){return'<button class="dropdownTrigger">${ButtonText}<\!--span class="dropdownArrowDown core-sprite-openarrow"></span--\></button><ul class="dropdownMenu"></ul>'});
define("text!orion/webui/dropdowntriggerbuttonwitharrow.html",[],function(){return'<button class="dropdownTrigger dropdownDefaultButton">${ButtonText}<span class="dropdownArrowDown core-sprite-openarrow"></span></button><ul class="dropdownMenu"></ul>'});define("text!orion/webui/submenutriggerbutton.html",[],function(){return'<li class="dropdownSubMenu"><span class="dropdownTrigger dropdownMenuItem" role="menuitem" tabindex="0"><span class="dropdownCommandName">${ButtonText}</span><span class="dropdownArrowRight core-sprite-closedarrow"></span></span><ul class="dropdownMenu"></ul></li>'});
define("text!orion/webui/checkedmenuitem.html",[],function(){return'<li><label class="dropdownMenuItem"><input class="checkedMenuItem" role="menuitem" type="checkbox" />${ItemText}</label></li>'});
define("orion/webui/tooltip",["require","orion/webui/littlelib"],function(f,m){function q(b){this._init(b)}q.prototype={_init:function(b){this._node=m.node(b.node);if(!this._node)throw"no dom node for tooltip found";this._position=b.position||["right","above","below","left"];this._text=b.text;this._hideDelay=void 0===b.hideDelay?200:b.hideDelay;this._tailSize=b.tailSize||10;this._trigger=b.trigger||"mouseover";this._afterShowing=b.afterShowing;this._afterHiding=b.afterHiding;var l=this;if("click"===
this._trigger)this._showDelay=0,this._node.addEventListener("click",this._clickHandler=function(b){b.target===l._node&&(l.show(),m.stop(b))},!1);else if("mouseover"===this._trigger){this._showDelay=void 0===b.showDelay?500:b.showDelay;b=["mouseout","click"];this._node.addEventListener("mouseover",this._mouseoverHandler=function(b){m.contains(l._node,b.target)&&(l.show(),m.stop(b))},!1);this._leaveHandler=function(b){m.contains(l._node,b.target)&&l.hide()};for(var g=0;g<b.length;g++)this._node.addEventListener(b[g],
this._leaveHandler,!1)}},_makeTipNode:function(){if(!this._tip){this._tip=document.createElement("span");this._tip.classList.add("tooltipContainer");this._tipInner=document.createElement("div");this._tipInner.classList.add("tooltip");if(this._text){this._tipTextContent=document.createElement("div");this._tipTextContent.classList.add("textContent");this._tipInner.appendChild(this._tipTextContent);var b=document.createTextNode(this._text);this._tipTextContent.appendChild(b)}this._tip.appendChild(this._tipInner);
document.body.appendChild(this._tip);var l=this;m.addAutoDismiss([this._tip,this._node],function(){l.hide()});"mouseover"===this._trigger&&(this._tipInner.role="tooltip",this._tipInner.id="tooltip"+(new Date).getTime().toString(),this._node.setAttribute("aria-describedby",this._tipInner.id),this._tip.addEventListener("mouseover",function(){l._timeout&&(window.clearTimeout(l._timeout),l._timeout=null);l._tip.addEventListener("mouseout",function(b){m.contains(l._tip,b.target)&&(l.hide(),m.stop(b))},
!1)},!1))}return this._tip},_positionTip:function(b,l){this._makeTipNode();"left"===b?this._tipInner.classList.add("left"):this._tipInner.classList.remove("left");var g=this._node,e;for(e=m.bounds(g);g&&!e.width&&!e.height;g=g.parentNode)e=m.bounds(g);var g=m.bounds(this._tipInner),d;switch(b){case "above":d=e.top-g.height-this._tailSize-1;e=e.left-this._tailSize;break;case "below":d=e.top+e.height+this._tailSize+1;e=e.left-this._tailSize;break;case "left":d=e.top-this._tailSize/2;e=e.left-g.width-
this._tailSize-1;break;default:d=e.top-this._tailSize/2,e=e.left+e.width+this._tailSize+1}var h=m.bounds(document.documentElement);if(d+g.height>h.height)if(l)d=h.height-g.height-1;else return!1;if(e+g.width>h.width)if(l)e=h.width-g.width-1;else return!1;if(0>e)if(l)e=4;else return!1;if(0>d)if(l)d=4;else return!1;this._tail&&this._tail.previousPosition!==b&&(this._tip.removeChild(this._tail),this._tail=null);this._tail||(this._tail=document.createElement("span"),this._tail.classList.add("tooltipTailFrom"+
b),"above"===b||"left"===b?this._tip.appendChild(this._tail):this._tip.insertBefore(this._tail,this._tipInner),"left"===b&&(this._tail.style.left=g.width+"px"),this._tail.previousPosition=b);this._tip.style.top=d+"px";this._tip.style.left=e+"px";return!0},contentContainer:function(){this._makeTipNode();return this._tipInner},show:function(){if(!this._tip||!this._tip.classList.contains("tooltipShowing"))this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._showDelay?this._timeout=
window.setTimeout(this._showImmediately.bind(this),this._showDelay):this._showImmediately()},_showImmediately:function(){for(var b=!1,l=0;!b&&l<this._position.length;)b=this._positionTip(this._position[l]),l++;b||this._positionTip(this._position[0],!0);this._tip.classList.add("tooltipShowing");this._afterShowing&&this._afterShowing()},hide:function(b){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null);if(this._tip&&this._tip.classList.contains("tooltipShowing")){void 0===b&&(b=
this._hideDelay);var l=this;this._timeout=window.setTimeout(function(){l._tip.classList.remove("tooltipShowing");l._tip.removeAttribute("style");l._afterHiding&&l._afterHiding()},b)}},destroy:function(){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null);this._tip&&(document.body.removeChild(this._tip),this._tail=this._tipTextContent=this._tipInner=this._tip=null);if(this._node){this._node.removeEventListener("click",this._clickHandler,!1);this._node.removeEventListener("mouseover",
this._mouseoverHandler,!1);for(var b=["mouseout","click"],l=0;l<b.length;l++)this._node.removeEventListener(b[l],this._leaveHandler,!1)}}};q.prototype.constructor=q;return{Tooltip:q}});
define("orion/commands","orion/util orion/webui/littlelib orion/webui/dropdown text!orion/webui/dropdowntriggerbutton.html text!orion/webui/dropdowntriggerbuttonwitharrow.html text!orion/webui/submenutriggerbutton.html text!orion/webui/checkedmenuitem.html orion/webui/tooltip".split(" "),function(f,m,q,b,l,g,e,d){function h(a){var c=a.invocation;if(c){var r=a.command;if(r.hrefCallback)return a=r.hrefCallback.call(c.handler||window,c),a.then?a.then(function(r){window.open(r)}):window.open(a),!0;if(c.commandRegistry)return c.commandRegistry._invoke(c),
!0;if(r.onClick||r.callback)return window.setTimeout(function(){(r.onClick||r.callback).call(c.handler||window,c)},0),!0}return!1}function c(a,c){for(var r in c)if(c[r]&&(c[r].keyBinding&&c[r].command)&&c[r].keyBinding.match(a)){var t=c[r],d=t.keyBinding;if((!d.domScope||m.contains(m.node(d.domScope),a.target))&&h(t)){m.stop(a);break}}}function a(){var a={};if(y){var c,r,t;r=Object.keys(x);for(c=0;c<r.length;c++)t=r[c],a[t]=x[t];var d=y();r=Object.keys(d);for(c=0;c<r.length;c++)t=r[c],a[t]=d[t]}else a=
x;return a}function k(d){c(d,a())}function n(a,c){a=a||window.event;if(function(r){if(f.isMac){if(r.metaKey&&!r.altKey)return!r.shiftKey&&!r.ctrlKey&&(65===r.keyCode||67===r.keyCode||86===r.keyCode||88===r.keyCode||90===r.keyCode)?!0:!1;if(r.ctrlKey)return!1}else{if(r.ctrlKey&&!r.altKey)return!r.shiftKey&&(65===r.keyCode||67===r.keyCode||86===r.keyCode||88===r.keyCode||90===r.keyCode)?!0:!1;if(r.altKey&&!r.ctrlKey)return!1}if(r["char"])return 0<r["char"].length;if(r.charCode||r.keyCode)switch(r=r.charCode||
r.keyCode,r){case 8:case 9:case 13:case 46:return!0;default:return 32<=r&&112>r||123<r}return!1}(a)){if("true"===a.target.contentEditable)return;var r=a.target.nodeName.toLowerCase();if("input"===r)switch(a.target.type.toLowerCase()){case "text":case "password":case "search":case "color":case "date":case "datetime":case "datetime-local":case "email":case "month":case "number":case "range":case "tel":case "time":case "url":case "week":return}else if("textarea"===r)return}c?c(a):k(a)}function p(){this._init()}
function u(a,c,r){c.classList.add("commandImage");var t;a.imageClass?a.addImageClassToElement?c.classList.add(a.imageClass):(t=document.createElement("span"),c.appendChild(t),t.classList.add(a.spriteClass),t.classList.add(a.imageClass)):(t=new Image,t.alt=a.name,t.name=r,t.id=r,t.src=a.image,c.appendChild(t));return t}function s(a,c,r,t,d){this.commandRegistry=d;this.handler=a;this.items=c;this.userData=r;this.command=t;t.parameters&&(this.parameters=t.parameters.makeCopy());this.id=t.id}function w(a){this._init(a)}
var y=null,x={};p.prototype={setProxy:function(a){this.proxy=a},setKeyBindings:function(a){this.bindings=a},_init:function(){var a=this;document.addEventListener("keydown",function(c){return n(c,function(r){var c=a.proxy,d=a.bindings;if(d&&c)for(var b=0;b<d.length;b++)d[b].match(r)&&(c.processKey({type:r.type,keyCode:r.keyCode,altKey:r.altKey,ctrlKey:r.ctrlKey,metaKey:r.metaKey,shiftKey:r.shiftKey}),m.stop(r))})})}};window.document.addEventListener("keydown",n,!1);s.prototype={collectsParameters:function(){return this.commandRegistry&&
this.commandRegistry.collectsParameters()},makeCopy:function(a){var c=new s(this.handler,this.items,this.userData,this.command,this.commandRegistry);c.domNode=this.domNode;c.domParent=this.domParent;a?c.parameters=a.makeCopy():this.parameters&&(c.parameters=this.parameters.makeCopy());return c}};s.prototype.constructor=s;w.prototype={_init:function(a){this.id=a.id;this.name=a.name;this.tooltip=a.tooltip;this.callback=a.callback;this.hrefCallback=a.hrefCallback;this.choiceCallback=a.choiceCallback;
this.positioningNode=a.positioningNode;this.image=a.image||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC";this.imageClass=a.imageClass;this.addImageClassToElement=a.addImageClassToElement;this.selectionClass=a.selectionClass;this.spriteClass=a.spriteClass||"commandSprite";this.visibleWhen=a.visibleWhen;this.parameters=a.parameters;this.isEditor=a.isEditor},populateChoicesMenu:function(a,c,r,t,
d){var r=this.getChoices(c,r,t),b=r.some(function(r){return r.checked});r.forEach(function(r){if(r.name){var t=document.createElement("li");a.appendChild(t);var k=document.createElement("span");k.tabIndex=0;k.role="menuitem";k.classList.add("dropdownMenuItem");if(b){var p=document.createElement("span");p.classList.add("check");p.appendChild(document.createTextNode(r.checked?"\u25cf":""));k.appendChild(p)}p=document.createTextNode(r.name);k.appendChild(p);t.appendChild(k);k.choice=r;k.addEventListener("click",
function(r){r.target.choice&&r.target.choice.callback.call(r.target.choice,c)},!1);k.addEventListener("keydown",function(r){(r.keyCode===m.KEY.ENTER||r.keyCode===m.KEY.SPACE)&&r.target.choice&&r.target.choice.callback.call(r.target.choice,c)},!1)}else d._generateMenuSeparator(a)})},getChoices:function(a,c,r){return this.choiceCallback?this.choiceCallback.call(c,a,r):null},makeChoiceCallback:function(a,c){return function(r){a.callback&&a.callback.call(a,c,r)}},hasImage:function(){return this.imageClass||
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC"!==this.image}};w.prototype.constructor=w;return{Command:w,CommandInvocation:s,createDropdownMenu:function(a,c,r,t,d,k,p,n,e){a=m.node(a);if(!a)throw"no parent node was specified";var h=document.createRange();h.selectNode(a);h=e?h.createContextualFragment(l):h.createContextualFragment(b);m.processTextNodes(h,{ButtonText:c});a.appendChild(h);var a=
a.lastChild,s;e?(e=a.previousSibling,s=e.lastChild):e=a.previousSibling;t?e.classList.add(t):(e.classList.add("orionButton"),e.classList.add("commandButton"));d&&(k||(e.textContent="",e.setAttribute("aria-label",c)),u({spriteClass:"commandSprite",imageClass:d},e,c),e.classList.add("orionButton"));e.dropdown=new q.Dropdown({dropdown:a,populate:r,selectionClass:p,skipTriggerEventListeners:!!s,positioningNode:n});a.dropdown=e.dropdown;return{menuButton:e,menu:a,dropdown:e.dropdown,dropdownArrow:s}},
createCheckedMenuItem:function(a,c,r,t){a=m.node(a);if(!a)throw"no parent node was specified";var d=document.createRange();d.selectNode(a);d=d.createContextualFragment(e);m.processTextNodes(d,{ItemText:c});a.appendChild(d);a=m.$(".checkedMenuItem",a.lastChild);a.checked=r;a.addEventListener("change",t,!1);return a},createCommandItem:function(a,c,r,t,b,k,p){var e,k=k||!c.name&&c.hasImage();if(c.hrefCallback)e=document.createElement("a"),e.id=t,k&&c.hasImage()?u(c,e,t):(e.className="commandLink",e.appendChild(document.createTextNode(c.name))),
p=c.hrefCallback.call(r.handler,r),p.then?p.then(function(r){e.href=r}):e.href=p?p:"#";else{e=document.createElement("button");e.className="orionButton";k?c.hasImage()?(u(c,e,t),c.name&&e.setAttribute("aria-label",c.name)):(e.classList.add("commandButton"),e.classList.add("commandMissingImageButton"),e.appendChild(document.createTextNode(c.name))):(e.classList.add("commandButton"),t=document.createTextNode(c.name),e.appendChild(t));var n=p||c.callback;n&&(c.onClick=n,e.addEventListener("click",function(){n.call(r.handler,
r)},!1))}"ul"===a.nodeName.toLowerCase()?(p=document.createElement("li"),a.appendChild(p),a=p):e.classList.add("commandMargins");a.appendChild(e);c.tooltip&&(e.commandTooltip=new d.Tooltip({node:e,text:c.tooltip,position:["above","below","right","left"]}));b&&(x[c.id]={keyBinding:b,command:c,invocation:r});return e},createCommandMenuItem:function(a,c,r,t,b,k){var p,e=a.dropdown;if(c.hrefCallback){p=document.createElement("a");var n=document.createElement("span");n.appendChild(document.createTextNode(c.name));
n.classList.add("dropdownCommandName");p.appendChild(n);b=c.hrefCallback.call(r.handler,r);b.then?b.then(function(r){p.href=r}):p.href=b?b:"#";p.addEventListener("keydown",function(r){(r.keyCode===m.KEY.ENTER||r.keyCode===m.KEY.SPACE)&&p.click()},!1)}else{p=document.createElement("span");p.tabIndex=0;n=document.createElement("span");n.appendChild(document.createTextNode(c.name));n.classList.add("dropdownCommandName");p.appendChild(n);var h=b||c.callback;h&&(c.onClick=h,p.addEventListener("click",
function(){e.close(!0);h.call(r.handler,r)},!1),p.addEventListener("keydown",function(r){if(r.keyCode===m.KEY.ENTER||r.keyCode===m.KEY.SPACE)r.preventDefault(),p.click()},!1))}p.className="dropdownMenuItem";p.role="menuitem";c.tooltip&&(p.commandTooltip=new d.Tooltip({node:p,text:c.tooltip,position:["above","below","right","left"]}));k&&(b=p,n=document.createElement("span"),n.classList.add("dropdownKeyBinding"),n.appendChild(document.createTextNode(k)),b.appendChild(n));k=document.createElement("li");
a.appendChild(k);k.appendChild(p);t&&(x[c.id]={keyBinding:t,command:c,invocation:r});return p},executeBinding:h,setKeyBindingProvider:function(a){y=a},localKeyBindings:x,CommandsProxy:p,getKeyBindings:a,processKey:k,NO_IMAGE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC",_testMethodProcessKey:c}});
define("orion/explorers/explorer","i18n!orion/nls/messages require orion/webui/littlelib orion/webui/treetable orion/explorers/explorerNavHandler orion/commands".split(" "),function(f,m,q,b,l,g){var m={},e=function(d,b,c,a){this.registry=d;this.renderer=c;this.selection=b;this.commandService=a;this.renderer&&(this.renderer.explorer=this);this.myTree=null};e.prototype={destroy:function(){this._navHandler&&this._navHandler.destroy();this.model&&this.model.destroy();this.myTree&&this.myTree.destroy();
this.destroyed=!0},changedItem:function(d,b){this.myTree&&this.myTree.refresh.bind(this.myTree)(d,b,!0)},updateCommands:function(d){this.myTree&&this.myTree._renderer.updateCommands.bind(this.myTree._renderer)(d)},makeNewItemPlaceHolder:function(d,b,c,a){d=this.getRow(d);if(c)return d=d.childNodes[c],d.appendChild(document.createElement("br")),a=document.createElement("span"),a.id=b+"placeHolderRow",d.appendChild(a),{tempNode:a,refNode:a};if(d){var k=document.createElement("tr");k.id=b+"placeHolderRow";
c=document.createElement("td");c.id=b+"placeHolderCol";k.appendChild(c);a?(d.parentNode.insertBefore(k,d.nextSibling),d=parseInt(d.firstChild.style.paddingLeft),c.style.paddingLeft=this.myTree.getIndent()+d+"px"):d.appendChild(k);a=q.node(b+"placeHolderRow");d=q.node(b+"placeHolderCol");if(a&&d)return{tempNode:a,refNode:d}}return null},getRow:function(d){if(d=this.model.getId(d))return q.node(d)},collapseAll:function(){for(var d=this._navHandler.getTopLevelNodes(),b=0;b<d.length;b++)this.myTree.collapse(d[b])},
expandAll:function(d){if(d)this._expandRecursively(d);else if(this._navHandler)for(var d=this._navHandler.getTopLevelNodes(),b=0;b<d.length;b++)this._expandRecursively(d[b])},_expandRecursively:function(d){if(this._navHandler&&this._navHandler.isExpandable(d)){var b=this;this.myTree.expand(d,function(){b.model.getChildren(d,function(c){if(!(void 0===c||null===c))for(var a=c.length,d=0;d<a;d++)b._expandRecursively(c[d])})})}},createTree:function(d,e,c){d="string"===typeof d?d:d.id||d;this.selection&&
this.selection.setSelections([]);this.getNavHandler()&&this.getNavHandler()._clearSelection();var a=d+"innerTree",k=q.node(a);k&&q.empty(k);e&&(e.rootId=a);this.model=e;this._parentId=d;this._treeOptions=c;if(!c||c&&!c.noSelection)this.selectionPolicy=c?c.selectionPolicy:"",this._navDict=new l.ExplorerNavDict(this.model);this.myTree=new b.TableTree({id:a,model:e,parent:d,onComplete:c?c.onComplete:void 0,labelColumnIndex:this.renderer.getLabelColumnIndex(),renderer:this.renderer,showRoot:c?!!c.showRoot:
!1,indent:c?c.indent:void 0,onCollapse:c?c.onCollapse:void 0,navHandlerFactory:c?c.navHandlerFactory:void 0,tableElement:c?c.tableElement:void 0,tableBodyElement:c?c.tableBodyElement:void 0,tableRowElement:c?c.tableRowElement:void 0});this.renderer._initializeUIState();"cursorOnly"===this.selectionPolicy&&this.initNavHandler()},getNavHandler:function(){return this._navHandler},getNavDict:function(){return this._navDict},refreshSelection:function(){if(this.selection){var d=this.getNavHandler(),b=[];
if(d&&this.getNavDict())for(var c=d.getSelection(),a=0;a<c.length;a++){var k=d.getRowDiv(c[a]);k&&k.parentNode&&(k=this.getNavDict().getValue(this.model.getId(c[a])),k.model&&b.push(k.model))}this.selection.setSelections(b)}},getRootPath:function(){return this.model&&this.model.root?this.model.root.Location:null},initNavHandler:function(){var d=this._treeOptions;if(!d||d&&!d.noSelection){this.getNavHandler()||(this._navHandler=d&&d.navHandlerFactory&&"function"===typeof d.navHandlerFactory.createNavHandler?
d.navHandlerFactory.createNavHandler(this,this._navDict,d):new l.ExplorerNavHandler(this,this._navDict,{getChildrenFunc:d?d.getChildrenFunc:null,setFocus:d&&d.setFocus,selectionPolicy:d?d.selectionPolicy:null}));var b=this;this.model.getRoot(function(c){c instanceof Array?b.getNavHandler().refreshModel(b.getNavDict(),b.model,c):c.children&&c.children instanceof Array&&b.getNavHandler().refreshModel(b.getNavDict(),b.model,c.children);d&&d.setFocus&&b.getNavHandler().cursorOn(null,!1,!1,!0)})}},_lastHash:null,
checkbox:!1};m.Explorer=e;m.createExplorerCommands=function(d,b){function c(a){return"function"===typeof a.getItemCount&&0<a.getItemCount()?b?b(a):!0:!1}var a=new g.Command({tooltip:f["Expand all"],imageClass:"core-sprite-expandAll",id:"orion.explorer.expandAll",groupId:"orion.explorerGroup",visibleWhen:function(a){return c(a)},callback:function(a){a.items.expandAll()}}),k=new g.Command({tooltip:f["Collapse all"],imageClass:"core-sprite-collapseAll",id:"orion.explorer.collapseAll",groupId:"orion.explorerGroup",
visibleWhen:function(a){return c(a)},callback:function(a){a.items.collapseAll()}});d.addCommand(a);d.addCommand(k)};e=function(d,b,c){this.rootPath=d;this.fetchItems=b;this.idPrefix=c||""};e.prototype={destroy:function(){this.destroyed=!0},getRoot:function(d){var b=this;this.fetchItems(this.rootPath).then(function(c){b.root=c;d(c)})},getChildren:function(d,b){d.Children?b(d.Children):d.ChildrenLocation?this.fetchItems(d.ChildrenLocation).then(function(c){d.Children=c;b(c)}):b([])},getId:function(d){if(d.Location===
this.root.Location)return this.rootId;for(var d=d.Location.replace(/[\\\/]/g,""),b=this.idPrefix,c=0;c<d.length;c++)b=d[c].match(/[^\.\:\-\_0-9A-Za-z]/g)?b+d.charCodeAt(c):b+d[c];return b}};m.ExplorerModel=e;e=function(d,b,c){this.rootPath=d;this.fetchItems=b;this.root=c};e.prototype=new m.ExplorerModel;e.prototype.getRoot=function(d){if(this.root)d(this.root);else{var b=this;this.fetchItems(this.rootPath).then(function(c){b.root=c;d(c)})}};e.prototype.getChildren=function(d,b){d===this.root?b(this.root):
b([])};m.ExplorerFlatModel=e;e=function(d,b){this.explorer=b;this._init(d);this._expandImageClass="core-sprite-openarrow";this._collapseImageClass="core-sprite-closedarrow";this._progressImageClass="core-sprite-progress";this._twistieSpriteClass="modelDecorationSprite"};e.prototype={_init:function(d){d&&(this._useCheckboxSelection=void 0===d.checkbox?!1:d.checkbox,this.selectionPolicy=d.singleSelection?"singleSelection":"",this._cachePrefix=d.cachePrefix,this.getCheckedFunc=d.getCheckedFunc,this.onCheckedFunc=
d.onCheckedFunc,this._highlightSelection=!0,this._treeTableClass=d.treeTableClass||"treetable",!1===d.highlightSelection&&(this._highlightSelection=!1),this.actionScopeId||(this.actionScopeId=d.actionScopeId),this.commandService||(this.commandService=d.commandService))},getLabelColumnIndex:function(){return this.explorer.checkbox?1:0},initTable:function(d,b){this.tableTree=b;this.tableNode=d;q.empty(d);this._treeTableClass&&d.classList.add(this._treeTableClass);this.renderTableHeader(d)},getActionsColumn:function(d,
b,c,a,k){var c=c||"tool",e=document.createElement("td");e.id=b.id+"actionswrapper";a&&e.classList.add(a);this.actionScopeId&&this.commandService?this.commandService.renderCommands(this.actionScopeId,e,d,this.explorer,c,null,k&&this.explorer.getNavDict()?this.explorer.getNavDict().getGridNavHolder(d,!0):null):window.console.log("Warning, no command service or action scope was specified.  No commands rendered.");return e},initCheckboxColumn:function(){if(this._useCheckboxSelection)return document.createElement("th")},
getCheckboxColumn:function(d,b){if(this._useCheckboxSelection){var c=document.createElement("td"),a=document.createElement("span");a.id=this.getCheckBoxId(b.id);a.classList.add("core-sprite-check");a.classList.add("selectionCheckmarkSprite");a.rowId=b.id;this.getCheckedFunc&&(a.checked=this.getCheckedFunc(d),a.checked?(this._highlightSelection&&b.classList.add("checkedRow"),a.classList.add("core-sprite-check_on")):(this._highlightSelection&&b.classList.remove("checkedRow"),a.classList.remove("core-sprite-check_on")));
c.appendChild(a);var k=this;a.addEventListener("click",function(a){k.onCheck(b,a.target,a.target.checked?!1:!0,!0)},!1);return c}},getCheckBoxId:function(d){return d+"selectedState"},onCheck:function(d,b,c,a,k){(b.checked=c)?b.classList.add("core-sprite-check_on"):b.classList.remove("core-sprite-check_on");if(this.onCheckedFunc)this.onCheckedFunc(b.rowId,c,a);this.explorer.getNavHandler()&&k&&this.explorer.getNavHandler().setSelection(this.explorer.getNavDict().getValue(d.id).model,!0)},storeSelections:function(){if(this.explorer.getNavHandler()){var d=
this.explorer.getNavHandler().getSelectionIds(),b=this._getUIStatePreferencePath();b&&window.sessionStorage&&(window.sessionStorage[b+"selection"]=JSON.stringify(d))}},_restoreSelections:function(d){var b=this.explorer.getNavDict(),c=this.explorer.getNavHandler();if(c&&(b&&"cursorOnly"!==c.getSelectionPolicy())&&(d=window.sessionStorage[d+"selection"],"string"===typeof d&&(d=0<d.length?JSON.parse(d):null),d)){for(var a=[],c=0;c<d.length;c++){var k=b.getValue(d[c]);if(k&&(k.rowDomNode&&k.model)&&(a.push(k.model),
this._highlightSelection&&k.rowDomNode.classList.add("checkedRow"),k=q.node(this.getCheckBoxId(k.rowDomNode.id))))k.checked=!0,k.classList.add("core-sprite-check_on")}this.explorer.selection&&(this.explorer.selection.setSelections(a),this.explorer.getNavHandler()&&this.explorer.getNavHandler().refreshSelection())}},_storeExpansions:function(d){window.sessionStorage[d+"expanded"]=JSON.stringify(this._expanded)},_restoreExpansions:function(d){var b=!1,c=window.sessionStorage[d+"expanded"];"string"===
typeof c&&(c=0<c.length?JSON.parse(c):null);var a;if(c)for(a=0;a<c.length;a++)if(q.node(c[a])){this._expanded.push(c[a]);var k=this;this.tableTree.expand(c[a],function(){k._restoreSelections(d)});b=!0}return!b},_getUIStatePreferencePath:function(){if(this.explorer){var d=this.explorer.getRootPath();if(this._cachePrefix&&d)return d=d.replace(/[^\.\:\-\_0-9A-Za-z]/g,""),"/"+this._cachePrefix+"/"+d+"/uiState"}return null},expandCollapseImageId:function(d){return d+"__expand"},updateExpandVisuals:function(d,
b){var c=q.node(this.expandCollapseImageId(d.id));c&&(c.classList.remove(this._expandImageClass),c.classList.remove(this._collapseImageClass),c.classList.remove(this._progressImageClass),c.classList.add("progress"===b?this._progressImageClass:b?this._expandImageClass:this._collapseImageClass))},getExpandImage:function(d,b,c,a){var k=document.createElement("span");k.id=this.expandCollapseImageId(d.id);b.appendChild(k);k.classList.add(this._twistieSpriteClass);k.classList.add(this._collapseImageClass);
if(c){var e=document.createElement("span");b.appendChild(e);e.classList.add(a||"imageSprite");e.classList.add(c)}var p=this;k.onclick=function(){if(!p.explorer.getNavHandler().isDisabled(d)){p.tableTree.toggle(d.id);if(p.tableTree.isExpanded(d.id))p._expanded.push(d.id),p.explorer.postUserExpand&&p.explorer.postUserExpand(d.id);else for(var a in p._expanded)if(p._expanded[a]===d.id){p._expanded.splice(a,1);break}(a=p._getUIStatePreferencePath())&&window.sessionStorage&&p._storeExpansions(a)}};return k},
render:function(d,b){b.classList.add("navRow");this.renderRow(d,b)},rowsChanged:function(){"cursorOnly"!==this.explorer.selectionPolicy&&(this.explorer.refreshSelection(),this.explorer.initNavHandler());(q.$(".sectionTreeTable",this.tableNode.parentNode)||q.$(".treetable",this.tableNode.parentNode))&&q.$$array(".treeTableRow",this.tableNode).forEach(function(d,b){var c=!(b%2)?"darkSectionTreeTableRow":"lightSectionTreeTableRow",a="darkSectionTreeTableRow"===c?"lightSectionTreeTableRow":"darkSectionTreeTableRow";
d.classList.add(c);d.classList.remove(a)})},updateCommands:function(){if(this.commandService)for(var d=q.$$array(".treeTableRow"),b=0;b<d.length;b++){var c=d[b],a=q.node(c.id+"actionswrapper");this.commandService.destroy(a);this.actionScopeId&&this.commandService.renderCommands(this.actionScopeId,a,c._item,this.explorer,"tool")}},_initializeUIState:function(){this._expanded=[];var b=this._getUIStatePreferencePath();b&&window.sessionStorage&&this._restoreExpansions(b)&&this._restoreSelections(b)}};
m.ExplorerRenderer=e;e=function(b,e){this._init(b);this.explorer=e};e.prototype=new m.ExplorerRenderer;e.prototype.renderTableHeader=function(b){var e=document.createElement("thead"),c=document.createElement("tr");e.classList.add("navTableHeading");this._useCheckboxSelection&&c.appendChild(this.initCheckboxColumn(b));for(var a=0,k=this.getCellHeaderElement(a);k;)0<k.innerHTML.length&&k.classList.add("navColumn"),c.appendChild(k),k=this.getCellHeaderElement(++a);e.appendChild(c);0<a&&b.appendChild(e)};
e.prototype.renderRow=function(b,e){e.verticalAlign="baseline";e.classList.add("treeTableRow");var c=this.explorer.getNavDict();if(c){c.addRow(b,e);var a=this;e.addEventListener("click",function(c){if(a.explorer.getNavHandler())a.explorer.getNavHandler().onClick(b,c)},!1)}if(c=this.getCheckboxColumn(b,e))c.classList.add("checkColumn"),e.appendChild(c);for(var c=0,k=this.getCellElement(c,b,e);k;)e.appendChild(k),0===c?this.getPrimColumnStyle?k.classList.add(this.getPrimColumnStyle(b)):k.classList.add("navColumn"):
this.getSecondaryColumnStyle?k.classList.add(this.getSecondaryColumnStyle()):k.classList.add("secondaryColumn"),k=this.getCellElement(++c,b,e)};e.prototype.getCellHeaderElement=function(){};e.prototype.getCellElement=function(){};m.SelectionRenderer=e;e=function(b,e,c){this.items=b;this.getKey=c;this.idPrefix=e;this.root={children:b}};e.prototype=new m.ExplorerModel;e.prototype.getRoot=function(b){b(this.root)};e.prototype.getId=function(b){for(var b=this.getKey(b).replace(/[\\\/]/g,""),e="",c=0;c<
b.length;c++)e=b[c].match(/[^\.\:\-\_0-9A-Za-z]/g)?e+b.charCodeAt(c):e+b[c];return this.idPrefix+e};e.prototype.getChildren=function(b,e){b===this.root?e(this.items):e([])};m.SimpleFlatModel=e;return m});
define("orion/explorers/explorer-table","i18n!orion/navigate/nls/messages orion/Deferred orion/webui/littlelib orion/i18nUtil orion/fileUtils orion/explorers/explorer orion/EventTarget orion/objects orion/util".split(" "),function(f,m,q,b,l,g,e,d,h){function c(a,c,b,d,k,e){this.registry=a;this.root=c;this.fileClient=b;this.idPrefix=d||"";this.excludeFiles=!!k;this.excludeFolders=!!e}function a(a){e.attach(this);this.registry=a.serviceRegistry;this.treeRoot=a.treeRoot;this.selection=a.selection;this.fileClient=
a.fileClient;this.excludeFiles=a.excludeFiles;this.excludeFolders=a.excludeFolders;this.navHandlerFactory=a.navHandlerFactory;this.parentId=a.parentId;this.renderer=a.rendererFactory(this);this.dragAndDrop=a.dragAndDrop;this.setFocus=a.setFocus;this.myTree=this.model=null;this._hookedDrag=this.checkbox=!1;var c=a.modelEventDispatcher?a.modelEventDispatcher:new e;this.modelEventDispatcher=c;var b=this;this._modelListeners={};"copy copyMultiple create delete deleteMultiple import move moveMultiple".split(" ").forEach(function(a){c.addEventListener(a,
b._modelListeners[a]=b.modelHandler[a].bind(b))});this._clickListener=function(a){if("A"===a.target.tagName){for(a=a.target;a&&!a._item;)a=a.parentNode;if(a&&a._item)b.onLinkClick({type:"linkClick",item:a._item})}};(a=q.node(this.parentId))&&a.addEventListener("click",this._clickListener);var d=this.renderer;this.registry&&this.registry.registerService("orion.cm.managedservice",{updated:function(a){a=a&&"undefined"!==a["links.newtab"]?a["links.newtab"]?"_blank":"_self":"_self";d.setTarget&&d.setTarget(a)}},
{pid:"nav.config"})}c.prototype=new g.ExplorerModel;d.mixin(c.prototype,{getRoot:function(a){a(this.root)},processParent:function(a,c){if(this.excludeFiles||this.excludeFolders){var b=[],d;for(d in c)if(!(c[d].Directory?this.excludeFolders:this.excludeFiles))b.push(c[d]),c[d].parent=a;c=b}else for(b in c)c[b].parent=a;a.children=c;a.children.sort(function(a,c){var b=a.Directory;if(b!==c.Directory)return b?-1:1;var b=a.Name&&a.Name.toLowerCase(),d=c.Name&&c.Name.toLowerCase();return b<d?-1:b>d?1:0});
return c},getChildren:function(a,c){var b=this;if(a.children)c(a.children);else if(void 0!==a.Directory&&!1===a.Directory)c([]);else if(a.Location){var d=null;this.registry&&(d=this.registry.getService("orion.page.progress"));(d?d.progress(this.fileClient.fetchChildren(a.ChildrenLocation),f["Fetching children of "]+a.Name):this.fileClient.fetchChildren(a.ChildrenLocation)).then(function(d){b.destroyed||c(b.processParent(a,d))},function(){c([])})}else c([])},hasChildren:function(){var a=!1;this.root.Children&&
(a=0<this.root.Children.length);return a}});c.prototype.constructor=c;var k,n;a.prototype=Object.create(g.Explorer.prototype);d.mixin(a.prototype,{destroy:function(){var a=this;Object.keys(this._modelListeners).forEach(function(c){a.modelEventDispatcher.removeEventListener(c,a._modelListeners[c])});var c=q.node(this.parentId);c&&c.removeEventListener("click",this._clickListener);g.Explorer.prototype.destroy.call(this)},onLinkClick:function(a){this.dispatchEvent(a)},onModelCreate:function(a){return this.changedItem(a.parent,
!0)},onModelCopy:function(a){var c=this,b={};(a.items||[a]).forEach(function(a){a=(a=a.parent)||c.treeRoot;b[a.Location]=a});return m.all(Object.keys(b).map(function(a){return c.changedItem(b[a],!0)}))},onModelMove:function(a){var c=this,b={};(a.items||[a]).forEach(function(a){var d=c.treeRoot;if((d.Location||d.ContentLocation)===a.oldValue.Location){var k=c.treeRoot,a=a.newValue,a=a.ChildrenLocation?a:this.fileClient.read(a.ContentLocation,!0);return m.when(a,function(a){c.dispatchEvent({type:"rootMoved",
oldValue:k,newValue:a});c.loadResourceList(a)})}d=(d=a.oldValue.parent)||c.treeRoot;b[d.Location]=d;d=(d=a.parent)||c.treeRoot;b[d.Location]=d;a.oldValue.Directory&&(a.newValue&&c.isExpanded(a.oldValue))&&(b[a.newValue.Location]=a.newValue)});return m.all(Object.keys(b).map(function(a){return c.changedItem(b[a],!0)}))},onModelDelete:function(a){var a=a.items||[a],c=this,b=c.treeRoot,d;if(a.some(function(a){return a.oldValue.Location===(b.Location||b.ContentLocation)?(d=a.parent,!0):!1}))return this.loadResourceList(d);
var k={};a.forEach(function(a){a=a.parent;k[a.Location]=a});return m.all(Object.keys(k).map(function(a){return c.changedItem(k[a],!0)}))},modelHandler:{copy:function(a){if(!a.count)return this.onModelCopy(a)},copyMultiple:function(a){return this.onModelCopy(a)},create:function(a){return this.onModelCreate(a)},"delete":function(a){if(!a.count)return this.onModelDelete(a)},deleteMultiple:function(a){return this.onModelDelete(a)},"import":function(a){return this.changedItem(a.target,!0)},move:function(a){if(!a.count)return this.onModelMove(a)},
moveMultiple:function(a){return this.onModelMove(a)}},_makeDropTarget:function(a,c,d){if(this.dragAndDrop){var e=this,g=this.dragAndDrop,m=function(a){k=a.target};d&&(this._oldDragStart&&c.removeEventListener("dragstart",this._oldDragStart,!1),this._oldDragStart=m);c.addEventListener("dragstart",m,!1);m=function(){k=null};d&&(this._oldDragEnd&&c.removeEventListener("dragend",this._oldDragEnd,!1),this._oldDragEnd=m);c.addEventListener("dragend",m,!1);m=function(a){c.classList.remove("dragOver");a.preventDefault();
a.stopPropagation()};d&&(this._oldDragLeave&&c.removeEventListener("dragleave",this._oldDragLeave,!1),this._oldDragLeave=m);c.addEventListener("dragleave",m,!1);m=function(a){if(k)n=a.dataTransfer.dropEffect=(h.isMac?a.altKey:a.ctrlKey)?"copy":"move";else if(!h.isIE&&("all"===a.dataTransfer.effectAllowed||"uninitialized"===a.dataTransfer.effectAllowed||0<=a.dataTransfer.effectAllowed.indexOf("copy")))a.dataTransfer.dropEffect="copy";c.classList.add("dragOver");q.stop(a)};d&&(this._oldDragEnter&&c.removeEventListener("dragenter",
this._oldDragEnter,!1),this._oldDragEnter=m);c.addEventListener("dragenter",m,!1);m=function(a){if(k)n=a.dataTransfer.dropEffect=(h.isMac?a.altKey:a.ctrlKey)?"copy":"move";else if(!h.isIE&&("all"===a.dataTransfer.effectAllowed||"uninitialized"===a.dataTransfer.effectAllowed||0<=a.dataTransfer.effectAllowed.indexOf("copy")))a.dataTransfer.dropEffect="copy";q.stop(a)};d&&!this._oldDragOver&&(c.addEventListener("dragover",m,!1),this._oldDragOver=m);var v=null;e.registry&&(v=e.registry.getService("orion.page.progress"));
var z=function(a){v?v.setProgressResult(a):window.console.log(a)},r=function(c,d,k,e,n,h){!k.Location&&k.fileMetadata&&(k=k.fileMetadata);d=d||"";if(c.isFile)l.isAtRoot(k.Location)?e.registry&&e.registry.getService("orion.page.message").setProgressResult({Severity:"Error",Message:f["You cannot copy files directly into the workspace.  Create a folder first."]}):c.file(function(a){n(k,a,e,a.name.indexOf(".zip")===a.name.length-4&&window.confirm(b.formatMessage(f["Unzip ${0}?"],a.name)))});else if(c.isDirectory){var g=
c.createReader(),s=function(a){g.readEntries(function(b){for(var k=0;k<b.length;k++)r(b[k],d+c.name+"/",a,e,n,h)})};l.isAtRoot(k.Location)?(v?v.progress(h.createProject(k.ChildrenLocation,c.name),b.formatMessage(f["Creating ${0}"],c.name)):h.createProject(k.ChildrenLocation,c.name)).then(function(a){e.loadResourceList(e.treeRoot.Path,!0);(v?v.progress(h.read(a.ContentLocation,!0),f["Loading "]+a.name):h.read(a.ContentLocation,!0)).then(function(a){s(a)},z)},z):(v?v.progress(h.createFolder(k.Location,
c.name),b.formatMessage(f["Creating ${0}"],c.name)):h.createFolder(k.Location,c.name)).then(function(r){e.modelEventDispatcher.dispatchEvent({type:"create",parent:a,newValue:r});s(r)},z)}},m=function(d){var A;c.classList.remove("dragOver");if(k){A=e.fileClient;for(var D=k,C;D;){if(D._item){C=D._item;break}D=D.parentNode}if(!C)return;var h="copy"===n,D=h?A.copyFile:A.moveFile;(v?v.showWhile(D.apply(A,[C.Location,a.Location]),b.formatMessage(f[h?"Copying ${0}":"Moving ${0}"],C.Location)):D.apply(A,
[C.Location,a.Location])).then(function(r){e.modelEventDispatcher.dispatchEvent({type:h?"copy":"move",oldValue:C,newValue:r,parent:a})},z)}else if(d.dataTransfer.items&&0<d.dataTransfer.items.length)for(A=0;A<d.dataTransfer.items.length;A++)D=null,"function"===typeof d.dataTransfer.items[A].getAsEntry?D=d.dataTransfer.items[A].getAsEntry():"function"===typeof d.dataTransfer.items[A].webkitGetAsEntry&&(D=d.dataTransfer.items[A].webkitGetAsEntry()),D&&r(D,null,a,e,g,e.fileClient);else if(d.dataTransfer.files&&
0<d.dataTransfer.files.length)for(A=0;A<d.dataTransfer.files.length;A++)D=d.dataTransfer.files[A],!D.length&&(!D.type||""===D.type)?e.registry&&e.registry.getService("orion.page.message").setProgressResult({Severity:"Error",Message:b.formatMessage(f["Did not drop ${0}.  Folder drop is not supported in this browser."],D.name)}):l.isAtRoot(a.Location)?e.registry&&e.registry.getService("orion.page.message").setProgressResult({Severity:"Error",Message:f["You cannot copy files directly into the workspace.  Create a folder first."]}):
g(a,D,e,D.name.indexOf(".zip")===D.name.length-4&&window.confirm(b.formatMessage(f["Unzip ${0}?"],D.name)));q.stop(d)};d&&(this._oldDrop&&c.removeEventListener("drop",this._oldDrop,!1),this._oldDrop=m);c.addEventListener("drop",m,!1)}},createModel:function(){return new c(this.registry,this.treeRoot,this.fileClient,this.parentId,this.excludeFiles,this.excludeFolders)},changedItem:function(a,c){if(this.treeRoot&&this.treeRoot.Location===a.Location)return this.loadResourceList(this.treeRoot,c);var b=
this,d=new m;a.children=null;this.model.getChildren(a,function(k){b.getNavHandler();b.myTree.refresh.bind(b.myTree)(a,k,c);d.resolve(k)});return d},showItem:function(a,c){var b=new m;if(!a||!this.model||!this.myTree||!this.myTree.showRoot&&a.Location===this.treeRoot.Location)return b.reject();var d=this.getRow(a);if(d)b.resolve(d._item||a);else return a.Parents&&0<a.Parents.length?(a.Parents[0].Parents=a.Parents.slice(1),this.expandItem(a.Parents[0],c).then(function(c){var b=this.getRow(a);return!b?
this.changedItem(c,!0).then(function(){var c=this.getRow(a);return c?c._item:(new m).reject()}.bind(this)):b._item||a}.bind(this))):void 0===c||c?this.reroot(a):b.reject();return b},expandItem:function(a,c){var b=new m;this.showItem(a,c).then(function(a){this.myTree.isExpanded(a)?b.resolve(a):this.myTree.expand(this.model.getId(a),function(){b.resolve(a)})}.bind(this),b.reject);return b},reveal:function(a,c){return this.showItem(a,c).then(function(a){var c=this.getNavHandler();c&&(c.cursorOn(a,!0),
c.setSelection(a));return a}.bind(this))},reroot:function(){return(new m).reject()},isExpanded:function(a){a=this.model.getId(a);return this.renderer.tableTree.isExpanded(a)},getNameNode:function(a){if(a=this.model.getId(a))return q.node(a+"NameLink")},scopeUp:function(){},scopeDown:function(){},loadResourceList:function(a,c,b){a&&"object"===typeof a&&(a=a.ChildrenLocation||a.ContentLocation);a=l.makeRelative(a);if(!c&&a===this._lastPath)return(new m).resolve(this.treeRoot);this._lastPath=a;var d=
this;return c||a!==this.treeRoot.Path?this.load(this.fileClient.loadWorkspace(a),f["Loading "]+a).then(function(){d.treeRoot.Path=a;"function"===typeof b&&b();d.dispatchEvent({type:"rootChanged",root:d.treeRoot});return(new m).resolve(d.treeRoot)},function(a){d.treeRoot.Path=null;d.dispatchEvent({type:"rootChanged",root:d.treeRoot});return(new m).reject(a)}):(new m).resolve(d.treeRoot)},load:function(a,c,b){var d=q.node(this.parentId),k=q.node("progress");k||(k=document.createElement("div"),k.id=
"progress",q.empty(d),d.appendChild(k));q.empty(k);var e=setTimeout(function(){q.empty(k);k.appendChild(document.createTextNode(c))},500),n=this;return m.when(a,function(a){clearTimeout(e);if(!n.destroyed){n.treeRoot={};for(var r in a)n.treeRoot[r]=a[r];n.model=n.createModel();n.dragAndDrop&&(n._hookedDrag?n._makeDropTarget(n.treeRoot,d,!0):(a=(a=d&&("draggable"in d||"ondragstart"in d&&"ondrop"in d))&&!(!window.File||!window.FileList||!window.FileReader),n._hookedDrag=!0,a?n._makeDropTarget(n.treeRoot,
d,!0):(n.dragAndDrop=null,window.console.log("Local file drag and drop is not supported in this browser."))));var c=new m;n.createTree(n.parentId,n.model,{onComplete:function(a){c.resolve(a)},navHandlerFactory:n.navHandlerFactory,setFocus:"undefined"===typeof n.setFocus?!0:n.setFocus,selectionPolicy:n.renderer.selectionPolicy,onCollapse:function(a){if(n.getNavHandler())n.getNavHandler().onCollapse(a)}});return c.then(function(){if("function"===typeof b)try{b()}catch(a){n.registry&&n.registry.getService("orion.page.message").setErrorMessage(a)}if("function"===
typeof n.onchange)n.onchange(n.treeRoot);return n.treeRoot})}},function(a){clearTimeout(e);n.registry&&n.registry.getService("orion.page.message").setProgressResult(a);return(new m).reject(a)})},onchange:function(){}});a.prototype.constructor=a;return{FileExplorer:a,FileModel:c}});
define("orion/explorers/navigationUtils",[],function(){function f(f,b){!m&&f&&(f.push({domNode:b}),b.tabIndex=-1,b.style.outline="none")}var m=-1!==navigator.userAgent.indexOf("iPad");return{addNavGrid:function(m,b,l){m&&(m=m.getGridNavHolder(b,!0))&&f(m,l)},generateNavGrid:f,removeNavGrid:function(f,b){if(f)for(var l=0;l<f.length;l++)if(f[l].domNode===b){f.splice(l,1);break}}}});define("orion/extensionCommands",[],function(){return{getOpenWithCommands:function(){return[]}}});
define("orion/URITemplate",[],function(){function f(a){this._text=a}function m(a){return a.replace("%25","%")}function q(a,b){if("U"===b)return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()});if("U+R"===b)return encodeURI(a).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(c,m);if("U+R-,"===b)return encodeURI(a).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/,/g,"%2C");throw Error("Unknown allowed character set: "+b);}function b(a,c,b){for(var d=
[],e=0;e<a.length;e++)"undefined"!==typeof a[e]&&d.push(q(a[e],c));return d.join(b)}function l(a,c,b,d){for(var e=Object.keys(a),l=[],h=0;h<e.length;h++)"undefined"!==typeof a[e[h]]&&l.push(q(e[h],c)+b+q(a[e[h]],c));return l.join(d)}function g(a){if(0===a.length)throw Error("Invalid Expression: 0 length expression");(this._operator=d[a[0]])?a=a.substring(1):this._operator=d.NUL;for(var c=[],b=a.split(","),e=0;e<b.length;e++){var l=b[e].match(h);if(null===l)throw Error("Bad VarSpec: "+a);c.push({name:l[1],
explode:!!l[2],prefix:l[3]?parseInt(l[3],10):-1})}this._varSpecList=c}function e(a){for(var c=[],b=0,d=a.indexOf("{",b);-1!==d;){c.push(new f(a.substring(b,d)));b=a.indexOf("}",d+1);if(-1===b)throw Error("Invalid template: "+a);c.push(new g(a.substring(d+1,b)));b+=1;d=a.indexOf("{",b)}c.push(new f(a.substring(b)));this._templateComponents=c}var d={NUL:{first:"",sep:",",named:!1,ifemp:"",allow:"U"},"+":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R"},".":{first:".",sep:",",named:!1,ifemp:"",allow:"U"},
"/":{first:"/",sep:"/",named:!1,ifemp:"",allow:"U"},";":{first:";",sep:";",named:!0,ifemp:"",allow:"U"},"?":{first:"?",sep:"&",named:!0,ifemp:"=",allow:"U"},"&":{first:"&",sep:"&",named:!0,ifemp:"=",allow:"U"},"#":{first:"#",sep:",",named:!1,ifemp:"",allow:"U+R"},",":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R-,"}},h=/^((?:(?:[a-zA-Z0-9_])|(?:%[0-9A-F][0-9A-F]))(?:(?:[a-zA-Z0-9_.])|(?:%[0-9A-F][0-9A-F]))*)(?:(\*)|:([0-9]+))?$/,c=/%25[0-9A-F][0-9A-F]/g;f.prototype={expand:function(){return encodeURI(this._text)}};
g.prototype={expand:function(a){for(var c=[],d=0;d<this._varSpecList.length;d++){var e=this._varSpecList[d],h=e.name,g=a[h],f=typeof g;if("undefined"!==f&&null!==g){var y=0===c.length?this._operator.first:this._operator.sep,m=y;if("string"===f)this._operator.named&&(m+=q(h,"U+R"),m+=0===g.length?this._operator.ifemp:"="),-1!==e.prefix&&e.prefix<g.length&&(g=g.substring(0,e.prefix)),m+=q(g,this._operator.allow);else if(Array.isArray(g))e.explode?m+=b(g,this._operator.allow,this._operator.sep):(this._operator.named&&
(m+=q(h,"U+R"),m+=0===g.length?this._operator.ifemp:"="),m+=b(g,this._operator.allow,","));else if("object"===f)e.explode?m+=l(g,this._operator.allow,"=",this._operator.sep):(this._operator.named&&(m+=q(h,"U+R"),m+=0===Object.keys(g).length?this._operator.ifemp:"="),m+=l(g,this._operator.allow,",",","));else throw Error("bad param type: "+h+" : "+f);(m!==y||d<this._varSpecList.length-1)&&c.push(m)}}return c.join("")}};e.prototype={expand:function(a){for(var c=[],b=0;b<this._templateComponents.length;b++)c.push(this._templateComponents[b].expand(a));
return c.join("")}};return e});
define("orion/explorers/navigatorRenderer","i18n!orion/navigate/nls/messages orion/Deferred orion/explorers/explorer orion/explorers/navigationUtils orion/extensionCommands orion/objects orion/URITemplate orion/webui/littlelib".split(" "),function(f,m,q,b,l,g,e,d){function h(a){switch(a&&a.id){case "image/jpeg":case "image/png":case "image/gif":case "image/ico":case "image/tiff":case "image/svg":return!0}return!1}function c(a,c,b,d,f,y,q,v,z,r){var c=g.clone(c),t;if(c.Directory)t=document.createElement("a"),
t.className="navlinkonpage",t.href=!a?k:(new e(a+"#{,resource,params*}")).expand({resource:c.ChildrenLocation}),c.Name&&t.appendChild(document.createTextNode(c.Name));else{f||(f=l.getOpenWithCommands(b));if(!y)for(a=0;a<f.length;a++)"default"===f[a].isEditor&&(y=f[a]);t=document.createElement("a");t.className="navlink targetSelector";q&&"object"===typeof q&&Object.keys(q).forEach(function(a){t[a]=q[a]});var A=null,D=null;if(A=z?z.holderDom:t)D=document.createElement("span"),D.className="core-sprite-file modelDecorationSprite thumbnail",
A.appendChild(D);c.Name&&t.appendChild(document.createTextNode(c.Name));var C=!1,H=c.Location;v&&"object"===typeof v&&(c.params={},g.mixin(c.params,v));for(a=0;a<f.length;a++)if(v=f[a],v.visibleWhen(c)){H=v.hrefCallback({items:c});C=!0;break}m.when(d.getFileContentType(c),function(a){!C&&(y&&!h(a))&&(H=y.hrefCallback({items:c}));if(A){var b=A,d=D;if(a){var k,e=a.imageClass,n=a.image;e?(k=document.createElement("span"),k.className+=e,k.classList.add("thumbnail")):n&&(k=document.createElement("img"),
k.src=n,k.classList.add("thumbnail"));k&&b.replaceChild(k,d)}}t.href=H;r&&"function"===typeof r.updateFileNode&&r.updateFileNode(c,t,h(a))})}return t}function a(a,c,b,d){this.explorer=c;this.commandService=b;this.contentTypeService=d;this.openWithCommands=null;this.actionScopeId=a.actionScopeId;this._init(a);this.target="_self"}var k=new e("#{,resource,params*}");a.prototype=new q.SelectionRenderer;a.prototype.wrapperCallback=function(a){a.setAttribute("role","tree")};a.prototype.tableCallback=function(a){a.setAttribute("aria-label",
f.Navigator);a.setAttribute("role","presentation")};a.prototype.rowCallback=function(a){a.setAttribute("role","treeitem")};a.prototype.emptyCallback=function(a){var c=document.createElement("tr"),b=document.createElement("td");b.colSpan=this.oneColumn?1:3;var k=document.createElement("div");k.classList.add("noFile");k.textContent=f.NoFile;var e=document.createElement("span");e.appendChild(document.createTextNode(f.File));d.processDOMNodes(k,[e]);b.appendChild(k);c.appendChild(b);a.appendChild(c)};
a.prototype.getCellHeaderElement=function(a){if(this.oneColumn&&0!==a)return null;switch(a){case 0:case 1:case 2:document.createElement("th").style.height="8px"}};a.prototype.setTarget=function(a){this.target=a};a.prototype.getFolderImage=function(){if(!this.showFolderImage)return null;var a=document.createElement("span");a.className="core-sprite-folder modelDecorationSprite";return a};a.prototype.createFolderNode=function(a){var b;this.showFolderLinks?(b=c(this.folderLink||"",a,this.commandService,
this.contentTypeService),(a=this.getFolderImage(a))&&b.insertBefore(a,b.firstChild)):(b=document.createElement("span"),b.textContent=a.Name);return b};a.prototype.updateFileNode=function(){};a.prototype.showFolderLinks=!0;a.prototype.getCellElement=function(a,d,k){switch(a){case 0:var a=document.createElement("td"),e=document.createElement("span");e.id=k.id+"MainCol";e.setAttribute("role","presentation");a.appendChild(e);a.setAttribute("role","presentation");e.className="mainNavColumn";var h;if(d.Directory)this.getExpandImage(k,
e),h=this.createFolderNode(d),e.appendChild(h),this.explorer._makeDropTarget(d,h),this.explorer._makeDropTarget(d,k);else{if(!this.openWithCommands){this.openWithCommands=l.getOpenWithCommands(this.commandService);for(h=0;h<this.openWithCommands.length;h++)"default"===this.openWithCommands[h].isEditor&&(this.defaultEditor=this.openWithCommands[h])}h=c("",d,this.commandService,this.contentTypeService,this.openWithCommands,this.defaultEditor,{target:this.target},null,null,this);e.appendChild(h)}h&&
(h.id=k.id+"NameLink",1===h.nodeType&&(b.addNavGrid(this.explorer.getNavDict(),d,h),h.setAttribute("role","link"),h.setAttribute("tabindex","-1")));this.actionScopeId&&this.commandService.renderCommands(this.actionScopeId,e,d,this.explorer,"tool",null,!0);return a;case 1:if(this.oneColumn)return null;k=document.createElement("td");d.LocalTimeStamp&&(k.textContent=(new Date(d.LocalTimeStamp)).toLocaleString());return k;case 2:if(this.oneColumn)return null;k=document.createElement("td");!d.Directory&&
"number"===typeof d.Length&&(d=parseInt(d.Length,10)/1024,k.textContent=Math.ceil(d).toLocaleString()+" KB");k.style.textAlign="right";return k}};a.prototype.constructor=a;return{NavigatorRenderer:a,isImage:h,createLink:c}});
(function(){function f(a){this.tokens=[];this.tokens.links={};this.options=a||d.defaults;this.rules=h.normal;this.options.gfm&&(this.rules=this.options.tables?h.tables:h.gfm)}function m(a,b){this.options=b||d.defaults;this.links=a;this.rules=c.normal;if(!this.links)throw Error("Tokens array requires a `links` property.");this.options.gfm?this.rules=this.options.breaks?c.breaks:c.gfm:this.options.pedantic&&(this.rules=c.pedantic)}function q(a){this.tokens=[];this.token=null;this.options=a||d.defaults}
function b(a,c){return a.replace(!c?/&(?!#?\w+;)/g:/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function l(a,c){a=a.source;c=c||"";return function p(b,d){if(!b)return RegExp(a,c);d=d.source||d;d=d.replace(/(^|[^\[])\^/g,"$1");a=a.replace(b,d);return p}}function g(){}function e(a){for(var c=1,b,d;c<arguments.length;c++)for(d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a}function d(a,c,n){if(n||"function"===
typeof c){n||(n=c,c=null);c&&(c=e({},d.defaults,c));var l=c.highlight,h,g,w=0;try{h=f.lex(a,c)}catch(m){return n(m)}g=h.length;var x=function(a){var r,b;!0!==a&&delete c.highlight;try{r=q.parse(h,c)}catch(d){b=d}c.highlight=l;return b?n(b):n(null,r)};if(!l||3>l.length)return x(!0);if(!g)return x();for(;w<h.length;w++)(function(a){return"code"!==a.type?--g||x():l(a.text,a.lang,function(r,c){if(null==c||c===a.text)return--g||x();a.text=c;a.escaped=!0;--g||x()})})(h[w])}else try{return c&&(c=e({},d.defaults,
c)),q.parse(f.lex(a,c),c)}catch(v){v.message+="\nPlease report this to https://github.com/chjj/marked.";if((c||d.defaults).silent)return"<p>An error occured:</p><pre>"+b(v.message+"",!0)+"</pre>";throw v;}}var h={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:g,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:g,lheading:/^([^\n]+)\n *(=|-){3,} *\n*/,blockquote:/^( *>[^\n]+(\n[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,
def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:g,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/,bullet:/(?:[*+-]|\d+\.)/,item:/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/};h.item=l(h.item,"gm")(/bull/g,h.bullet)();h.list=l(h.list)(/bull/g,h.bullet)("hr",/\n+(?=(?: *[-*_]){3,} *(?:\n+|$))/)();h._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|@)\\b";
h.html=l(h.html)("comment",/<\!--[\s\S]*?--\>/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,h._tag)();h.paragraph=l(h.paragraph)("hr",h.hr)("heading",h.heading)("lheading",h.lheading)("blockquote",h.blockquote)("tag","<"+h._tag)("def",h.def)();h.normal=e({},h);h.gfm=e({},h.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/});h.gfm.paragraph=l(h.paragraph)("(?!","(?!"+h.gfm.fences.source.replace("\\1","\\2")+"|")();h.tables=
e({},h.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/});f.rules=h;f.lex=function(a,c){return(new f(c)).lex(a)};f.prototype.lex=function(a){a=a.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n");return this.token(a,!0)};f.prototype.token=function(a,c){for(var a=a.replace(/^ +$/gm,""),b,d,e,l,g,f,m;a;){if(e=this.rules.newline.exec(a))a=a.substring(e[0].length),1<
e[0].length&&this.tokens.push({type:"space"});if(e=this.rules.code.exec(a))a=a.substring(e[0].length),e=e[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:!this.options.pedantic?e.replace(/\n+$/,""):e});else if(e=this.rules.fences.exec(a))a=a.substring(e[0].length),this.tokens.push({type:"code",lang:e[2],text:e[3]});else if(e=this.rules.heading.exec(a))a=a.substring(e[0].length),this.tokens.push({type:"heading",depth:e[1].length,text:e[2]});else if(c&&(e=this.rules.nptable.exec(a))){a=
a.substring(e[0].length);g={type:"table",header:e[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:e[3].replace(/\n$/,"").split("\n")};for(f=0;f<g.align.length;f++)g.align[f]=/^ *-+: *$/.test(g.align[f])?"right":/^ *:-+: *$/.test(g.align[f])?"center":/^ *:-+ *$/.test(g.align[f])?"left":null;for(f=0;f<g.cells.length;f++)g.cells[f]=g.cells[f].split(/ *\| */);this.tokens.push(g)}else if(e=this.rules.lheading.exec(a))a=a.substring(e[0].length),this.tokens.push({type:"heading",
depth:"="===e[2]?1:2,text:e[1]});else if(e=this.rules.hr.exec(a))a=a.substring(e[0].length),this.tokens.push({type:"hr"});else if(e=this.rules.blockquote.exec(a))a=a.substring(e[0].length),this.tokens.push({type:"blockquote_start"}),e=e[0].replace(/^ *> ?/gm,""),this.token(e,c),this.tokens.push({type:"blockquote_end"});else if(e=this.rules.list.exec(a)){a=a.substring(e[0].length);l=e[2];this.tokens.push({type:"list_start",ordered:1<l.length});e=e[0].match(this.rules.item);b=!1;m=e.length;for(f=0;f<
m;f++)g=e[f],d=g.length,g=g.replace(/^ *([*+-]|\d+\.) +/,""),~g.indexOf("\n ")&&(d-=g.length,g=!this.options.pedantic?g.replace(RegExp("^ {1,"+d+"}","gm"),""):g.replace(/^ {1,4}/gm,"")),this.options.smartLists&&f!==m-1&&(d=h.bullet.exec(e[f+1])[0],l!==d&&!(1<l.length&&1<d.length)&&(a=e.slice(f+1).join("\n")+a,f=m-1)),d=b||/\n\n(?!\s*$)/.test(g),f!==m-1&&(b="\n"===g[g.length-1],d||(d=b)),this.tokens.push({type:d?"loose_item_start":"list_item_start"}),this.token(g,!1),this.tokens.push({type:"list_item_end"});
this.tokens.push({type:"list_end"})}else if(e=this.rules.html.exec(a))a=a.substring(e[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:"pre"===e[1]||"script"===e[1],text:e[0]});else if(c&&(e=this.rules.def.exec(a)))a=a.substring(e[0].length),this.tokens.links[e[1].toLowerCase()]={href:e[2],title:e[3]};else if(c&&(e=this.rules.table.exec(a))){a=a.substring(e[0].length);g={type:"table",header:e[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:e[2].replace(/^ *|\| *$/g,
"").split(/ *\| */),cells:e[3].replace(/(?: *\| *)?\n$/,"").split("\n")};for(f=0;f<g.align.length;f++)g.align[f]=/^ *-+: *$/.test(g.align[f])?"right":/^ *:-+: *$/.test(g.align[f])?"center":/^ *:-+ *$/.test(g.align[f])?"left":null;for(f=0;f<g.cells.length;f++)g.cells[f]=g.cells[f].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(g)}else if(c&&(e=this.rules.paragraph.exec(a)))a=a.substring(e[0].length),this.tokens.push({type:"paragraph",text:"\n"===e[1][e[1].length-1]?e[1].slice(0,-1):
e[1]});else if(e=this.rules.text.exec(a))a=a.substring(e[0].length),this.tokens.push({type:"text",text:e[0]});else if(a)throw Error("Infinite loop on byte: "+a.charCodeAt(0));}return this.tokens};var c={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:g,tag:/^<\!--[\s\S]*?--\>|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,
em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:g,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/,_inside:/(?:\[[^\]]*\]|[^\]]|\](?=[^\[]*\]))*/,_href:/\s*<?([^\s]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/};c.link=l(c.link)("inside",c._inside)("href",c._href)();c.reflink=l(c.reflink)("inside",c._inside)();c.normal=e({},c);c.pedantic=e({},c.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/});
c.gfm=e({},c.normal,{escape:l(c.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:l(c.text)("]|","~]|")("|","|https?://|")()});c.breaks=e({},c.gfm,{br:l(c.br)("{2,}","*")(),text:l(c.gfm.text)("{2,}","*")()});m.rules=c;m.output=function(a,c,b){return(new m(c,b)).output(a)};m.prototype.output=function(a){for(var c="",d,e;a;)if(e=this.rules.escape.exec(a))a=a.substring(e[0].length),c+=e[1];else if(e=this.rules.autolink.exec(a))a=a.substring(e[0].length),
"@"===e[2]?(d=":"===e[1][6]?this.mangle(e[1].substring(7)):this.mangle(e[1]),e=this.mangle("mailto:")+d):e=d=b(e[1]),c+='<a href="'+e+'">'+d+"</a>";else if(e=this.rules.url.exec(a))a=a.substring(e[0].length),e=d=b(e[1]),c+='<a href="'+e+'">'+d+"</a>";else if(e=this.rules.tag.exec(a))a=a.substring(e[0].length),c+=this.options.sanitize?b(e[0]):e[0];else if(e=this.rules.link.exec(a))a=a.substring(e[0].length),c+=this.outputLink(e,{href:e[2],title:e[3]});else if((e=this.rules.reflink.exec(a))||(e=this.rules.nolink.exec(a)))a=
a.substring(e[0].length),d=(e[2]||e[1]).replace(/\s+/g," "),d=this.links[d.toLowerCase()],!d||!d.href?(c+=e[0][0],a=e[0].substring(1)+a):c+=this.outputLink(e,d);else if(e=this.rules.strong.exec(a))a=a.substring(e[0].length),c+="<strong>"+this.output(e[2]||e[1])+"</strong>";else if(e=this.rules.em.exec(a))a=a.substring(e[0].length),c+="<em>"+this.output(e[2]||e[1])+"</em>";else if(e=this.rules.code.exec(a))a=a.substring(e[0].length),c+="<code>"+b(e[2],!0)+"</code>";else if(e=this.rules.br.exec(a))a=
a.substring(e[0].length),c+="<br>";else if(e=this.rules.del.exec(a))a=a.substring(e[0].length),c+="<del>"+this.output(e[1])+"</del>";else if(e=this.rules.text.exec(a))a=a.substring(e[0].length),c+=b(this.smartypants(e[0]));else if(a)throw Error("Infinite loop on byte: "+a.charCodeAt(0));return c};m.prototype.outputLink=function(a,c){return"!"!==a[0][0]?'<a href="'+b(c.href)+'"'+(c.title?' title="'+b(c.title)+'"':"")+">"+this.output(a[1])+"</a>":'<img src="'+b(c.href)+'" alt="'+b(a[1])+'"'+(c.title?
' title="'+b(c.title)+'"':"")+">"};m.prototype.smartypants=function(a){return!this.options.smartypants?a:a.replace(/--/g,"\u2014").replace(/'([^']*)'/g,"\u2018$1\u2019").replace(/"([^"]*)"/g,"\u201c$1\u201d").replace(/\.{3}/g,"\u2026")};m.prototype.mangle=function(a){for(var c="",b=a.length,d=0,e;d<b;d++)e=a.charCodeAt(d),0.5<Math.random()&&(e="x"+e.toString(16)),c+="&#"+e+";";return c};q.parse=function(a,c){return(new q(c)).parse(a)};q.prototype.parse=function(a){this.inline=new m(a.links,this.options);
this.tokens=a.reverse();for(a="";this.next();)a+=this.tok();return a};q.prototype.next=function(){return this.token=this.tokens.pop()};q.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0};q.prototype.parseText=function(){for(var a=this.token.text;"text"===this.peek().type;)a+="\n"+this.next().text;return this.inline.output(a)};q.prototype.tok=function(){switch(this.token.type){case "space":return"";case "hr":return"<hr>\n";case "heading":return"<h"+this.token.depth+">"+this.inline.output(this.token.text)+
"</h"+this.token.depth+">\n";case "code":if(this.options.highlight){var a=this.options.highlight(this.token.text,this.token.lang);null!=a&&a!==this.token.text&&(this.token.escaped=!0,this.token.text=a)}this.token.escaped||(this.token.text=b(this.token.text,!0));return"<pre><code"+(this.token.lang?' class="'+this.options.langPrefix+this.token.lang+'"':"")+">"+this.token.text+"</code></pre>\n";case "table":var c,d,e,l,a="<thead>\n<tr>\n";for(d=0;d<this.token.header.length;d++)c=this.inline.output(this.token.header[d]),
a+=this.token.align[d]?'<th align="'+this.token.align[d]+'">'+c+"</th>\n":"<th>"+c+"</th>\n";a+="</tr>\n</thead>\n<tbody>\n";for(d=0;d<this.token.cells.length;d++){c=this.token.cells[d];a+="<tr>\n";for(l=0;l<c.length;l++)e=this.inline.output(c[l]),a+=this.token.align[l]?'<td align="'+this.token.align[l]+'">'+e+"</td>\n":"<td>"+e+"</td>\n";a+="</tr>\n"}a+="</tbody>\n";return"<table>\n"+a+"</table>\n";case "blockquote_start":for(a="";"blockquote_end"!==this.next().type;)a+=this.tok();return"<blockquote>\n"+
a+"</blockquote>\n";case "list_start":d=this.token.ordered?"ol":"ul";for(a="";"list_end"!==this.next().type;)a+=this.tok();return"<"+d+">\n"+a+"</"+d+">\n";case "list_item_start":for(a="";"list_item_end"!==this.next().type;)a+="text"===this.token.type?this.parseText():this.tok();return"<li>"+a+"</li>\n";case "loose_item_start":for(a="";"list_item_end"!==this.next().type;)a+=this.tok();return"<li>"+a+"</li>\n";case "html":return!this.token.pre&&!this.options.pedantic?this.inline.output(this.token.text):
this.token.text;case "paragraph":return"<p>"+this.inline.output(this.token.text)+"</p>\n";case "text":return"<p>"+this.parseText()+"</p>\n"}};g.exec=g;d.options=d.setOptions=function(a){e(d.defaults,a);return d};d.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1};d.Parser=q;d.parser=q.parse;d.Lexer=f;d.lexer=f.lex;d.InlineLexer=m;d.inlineLexer=m.output;d.parse=d;"object"===typeof exports?module.exports=d:"function"===
typeof define&&define.amd?define("marked/marked",[],function(){return d}):this.marked=d}).call(function(){return this||("undefined"!==typeof window?window:global)}());define("orion/editor/i18n",{load:function(f,m,q){m.specified&&m.specified("orion/bootstrap")?m(["orion/i18n!"+f],function(b){q(b)}):q({})}});
define("orion/editor/nls/root/messages",{multipleAnnotations:"Multiple annotations:",line:"Line: ${0}",breakpoint:"Breakpoint",bookmark:"Bookmark",task:"Task",error:"Error",warning:"Warning",matchingSearch:"Matching Search",currentSearch:"Current Search",currentLine:"Current Line",matchingBracket:"Matching Bracket",currentBracket:"Current Bracket",lineUp:"Line Up",lineDown:"Line Down",lineStart:"Line Start",lineEnd:"Line End",charPrevious:"Previous Character",charNext:"Next Character",pageUp:"Page Up",
pageDown:"Page Down",scrollPageUp:"Scroll Page Up",scrollPageDown:"Scroll Page Down",scrollLineUp:"Scroll Line Up",scrollLineDown:"Scroll Line Down",wordPrevious:"Previous Word",wordNext:"Next Word",textStart:"Document Start",textEnd:"Document End",scrollTextStart:"Scroll Document Start",scrollTextEnd:"Scroll Document End",centerLine:"Center Line",selectLineUp:"Select Line Up",selectLineDown:"Select Line Down",selectWholeLineUp:" Select Whole Line Up",selectWholeLineDown:"Select Whole Line Down",
selectLineStart:"Select Line Start",selectLineEnd:"Select Line End",selectCharPrevious:"Select Previous Character",selectCharNext:"Select Next Character",selectPageUp:"Select Page Up",selectPageDown:"Select Page Down",selectWordPrevious:"Select Previous Word",selectWordNext:"Select Next Word",selectTextStart:"Select Document Start",selectTextEnd:"Select Document End",deletePrevious:"Delete Previous Character",deleteNext:"Delete Next Character",deleteWordPrevious:"Delete Previous Word",deleteWordNext:"Delete Next Word",
deleteLineStart:"Delete Line Start",deleteLineEnd:"Delete Line End",tab:"Insert Tab",enter:"Insert Line Delimiter",enterNoCursor:"Insert Line Delimiter",selectAll:"Select All",copy:"Copy",cut:"Cut",paste:"Paste",uppercase:"To Upper Case",lowercase:"To Lower Case",capitalize:"Capitalize",reversecase:"Reverse Case",toggleWrapMode:"Toggle Wrap Mode",toggleTabMode:"Toggle Tab Mode",toggleOverwriteMode:"Toggle Overwrite Mode",committerOnTime:"${0} on ${1}",emacs:"Emacs",exchangeMarkPoint:"Exchange Mark and Point",
setMarkCommand:"Set Mark",clearMark:"Clear Mark",digitArgument:"Digit Argument ${0}",negativeArgument:"Negative Argument",Comment:"Comment","Flat outline":"Flat outline",incrementalFindStr:"Incremental find: ${0}",incrementalFindStrNotFound:"Incremental find: ${0} (not found)",incrementalFindReverseStr:"Reverse Incremental find: ${0}",incrementalFindReverseStrNotFound:"Reverse Incremental find: ${0} (not found)",find:"Find...",undo:"Undo",redo:"Redo",cancelMode:"Cancel Current Mode",findNext:"Find Next Occurrence",
findPrevious:"Find Previous Occurrence",incrementalFind:"Incremental Find",incrementalFindReverse:"Incremental Find Reverse",indentLines:"Indent Lines",unindentLines:"Unindent Lines",moveLinesUp:"Move Lines Up",moveLinesDown:"Move Lines Down",copyLinesUp:"Copy Lines Up",copyLinesDown:"Copy Lines Down",deleteLines:"Delete Lines",gotoLine:"Goto Line...",gotoLinePrompty:"Goto Line:",nextAnnotation:"Next Annotation",prevAnnotation:"Previous Annotation",expand:"Expand",collapse:"Collapse",expandAll:"Expand All",
collapseAll:"Collapse All",lastEdit:"Last Edit Location",trimTrailingWhitespaces:"Trim Trailing Whitespaces",toggleLineComment:"Toggle Line Comment",addBlockComment:"Add Block Comment",removeBlockComment:"Remove Block Comment",linkedModeEntered:"Linked Mode entered",linkedModeExited:"Linked Mode exited",syntaxError:"Syntax Error",contentAssist:"Content Assist",lineColumn:"Line ${0} : Col ${1}",vi:"vi",vimove:"(Move)",viyank:"(Yank)",videlete:"(Delete)",vichange:"(Change)",viLeft:"${0} Left",viRight:"${0} Right",
viUp:"${0} Up",viDown:"${0} Down",viw:"${0} Next Word",vib:"${0} Beginning of Word",viW:"${0} Next Word (ws stop)",viB:"${0} Beginning of Word (ws stop)",vie:"${0} End of Word",viE:"${0} End of Word (ws stop)",vi$:"${0} End of the line","vi^_":"${0} First non-blank Char Current Line","vi+":"${0} First Char Next Line","vi-":"${0} First Char Previous Line","vi|":"${0} nth Column in Line",viH:"${0} Top of Page",viM:"${0} Middle of Page",viL:"${0} Bottom of Page","vi/":"${0} Search Forward","vi?":"${0} Search Backward",
vin:"${0} Next Search",viN:"${0} Previous Search",vif:"${0} Search Char Fwd",viF:"${0} Search Char Bckwd",vit:"${0} Search Before Char Fwd",viT:"${0} Search Before Char Bckwd","vi,":"${0} Repeat Reverse Char Search","vi;":"${0} Repeat Char Search",viG:"${0} Go to Line",viycd:"${0} Current Line",via:"Append After Cursor",viA:"Append to End of Line",vii:"Insert Before Cursor",viI:"Insert at Beginning of Line",viO:"Insert Line Above",vio:"Insert Line Below",viR:"Begin Overwriting Text",vis:"Substitute a Character",
viS:"Substitute Entire Line",viC:"Change Text Until Line End",vip:"Paste After Char or Line",viP:"Paste Before Char or Line",viStar:"Search Word Under Cursor",replaceAll:"Replacing all...",replacedMatches:"Replaced ${0} matches",nothingReplaced:"Nothing replaced",notFound:"Not found"});
define("orion/editor/nls/messages",["orion/editor/i18n!orion/editor/nls/messages","orion/editor/nls/root/messages"],function(f,m){var q={root:m},b;for(b in f)f.hasOwnProperty(b)&&"undefined"===typeof q[b]&&(q[b]=f[b]);return q});
define("orion/editor/eventTarget",[],function(){function f(){}f.addMixin=function(m){var q=f.prototype,b;for(b in q)q.hasOwnProperty(b)&&(m[b]=q[b])};f.prototype={addEventListener:function(f,q,b){this._eventTypes||(this._eventTypes={});var l=this._eventTypes[f];l||(l=this._eventTypes[f]={level:0,listeners:[]});l.listeners.push({listener:q,useCapture:b})},dispatchEvent:function(f){var q=f.type;this._dispatchEvent("pre"+q,f);this._dispatchEvent(q,f);this._dispatchEvent("post"+q,f)},_dispatchEvent:function(f,
q){var b=this._eventTypes?this._eventTypes[f]:null;if(b){var l=b.listeners;try{if(b.level++,l)for(var g=0,e=l.length;g<e;g++)if(l[g]){var d=l[g].listener;"function"===typeof d?d.call(this,q):d.handleEvent&&"function"===typeof d.handleEvent&&d.handleEvent(q)}}finally{if(b.level--,b.compact&&0===b.level){for(g=l.length-1;0<=g;g--)l[g]||l.splice(g,1);0===l.length&&delete this._eventTypes[f];b.compact=!1}}}},isListening:function(f){return!this._eventTypes?!1:void 0!==this._eventTypes[f]},removeEventListener:function(f,
q,b){if(this._eventTypes){var l=this._eventTypes[f];if(l){for(var g=l.listeners,e=0,d=g.length;e<d;e++){var h=g[e];if(h&&h.listener===q&&h.useCapture===b){0!==l.level?(g[e]=null,l.compact=!0):g.splice(e,1);break}}0===g.length&&delete this._eventTypes[f]}}}};return{EventTarget:f}});define("orion/regex",[],function(){return{escape:function(f){return f.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$&")},parse:function(f){return(f=/^\s*\/(.+)\/([gim]{0,3})\s*$/.exec(f))?{pattern:f[1],flags:f[2]}:null}}});
define("orion/editor/textModel",["orion/editor/eventTarget","orion/regex","orion/util"],function(f,m,q){function b(b,g){this._lastLineIndex=-1;this._text=[""];this._lineOffsets=[0];this.setText(b);this.setLineDelimiter(g)}b.prototype={destroy:function(){},find:function(b){1<this._text.length&&(this._text=[this._text.join("")]);var g=b.string,e=b.regex,d=g,h="",c=b.caseInsensitive;if(d)if(e){if(g=m.parse(d))d=g.pattern,h=g.flags}else d=g.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$&"),c&&(d=d.replace(/[iI\u0130\u0131]/g,
"[Ii\u0130\u0131]"));var a=null,k;if(d){var g=b.reverse,n=b.wrap,e=b.wholeWord,p=b.start||0,b=b.end,f=null!==b&&void 0!==b;-1===h.indexOf("g")&&(h+="g");-1===h.indexOf("m")&&(h+="m");c&&-1===h.indexOf("i")&&(h+="i");e&&(d="\\b"+d+"\\b");var s=this._text[0],w,q,x=0;f&&(c=p<b?p:b,s=s.substring(c,p<b?b:p),x=c);var v=RegExp(d,h);g?k=function(){var a=null;for(v.lastIndex=0;;){q=v.lastIndex;w=v.exec(s);if(q===v.lastIndex)return null;if(w){if(!(w.index+x<p)){if(!n||a)break;p=s.length+x}a={start:w.index+
x,end:v.lastIndex+x}}else break}a&&(p=a.start);return a}:(f||(v.lastIndex=p),k=function(){for(;;){q=v.lastIndex;w=v.exec(s);if(q===v.lastIndex)break;if(w)return{start:w.index+x,end:v.lastIndex+x};if(!(0!==q&&n))break}return null});a=k()}return{next:function(){var c=a;c&&(a=k());return c},hasNext:function(){return null!==a}}},getCharCount:function(){for(var b=0,g=0;g<this._text.length;g++)b+=this._text[g].length;return b},getLine:function(b,g){var e=this.getLineCount();if(!(0<=b&&b<e))return null;
var d=this._lineOffsets[b];if(b+1<e){e=this.getText(d,this._lineOffsets[b+1]);if(g)return e;for(var d=e.length,h;10===(h=e.charCodeAt(d-1))||13===h;)d--;return e.substring(0,d)}return this.getText(d)},getLineAtOffset:function(b){var g=this.getCharCount();if(!(0<=b&&b<=g))return-1;var e=this.getLineCount();if(b===g)return e-1;var d,h,c=this._lastLineIndex;if(0<=c&&c<e&&(d=this._lineOffsets[c],h=c+1<e?this._lineOffsets[c+1]:g,d<=b&&b<h))return c;for(var a=e,k=-1;1<a-k;)if(c=Math.floor((a+k)/2),d=this._lineOffsets[c],
h=c+1<e?this._lineOffsets[c+1]:g,b<=d)a=c;else if(b<h){a=c;break}else k=c;return this._lastLineIndex=a},getLineCount:function(){return this._lineOffsets.length},getLineDelimiter:function(){return this._lineDelimiter},getLineEnd:function(b,g){var e=this.getLineCount();if(!(0<=b&&b<e))return-1;if(b+1<e){e=this._lineOffsets[b+1];if(g)return e;for(var d=this.getText(Math.max(this._lineOffsets[b],e-2),e),h=d.length,c;10===(c=d.charCodeAt(h-1))||13===c;)h--;return e-(d.length-h)}return this.getCharCount()},
getLineStart:function(b){return!(0<=b&&b<this.getLineCount())?-1:this._lineOffsets[b]},getText:function(b,g){void 0===b&&(b=0);void 0===g&&(g=this.getCharCount());if(b===g)return"";for(var e=0,d=0,h;d<this._text.length;){h=this._text[d].length;if(b<=e+h)break;e+=h;d++}for(var c=e,a=d;d<this._text.length;){h=this._text[d].length;if(g<=e+h)break;e+=h;d++}if(a===d)return this._text[a].substring(b-c,g-e);c=this._text[a].substring(b-c);e=this._text[d].substring(0,g-e);return c+this._text.slice(a+1,d).join("")+
e},onChanging:function(b){return this.dispatchEvent(b)},onChanged:function(b){return this.dispatchEvent(b)},setLineDelimiter:function(b,g){"auto"===b&&(b=void 0,1<this.getLineCount()&&(b=this.getText(this.getLineEnd(0),this.getLineEnd(0,!0))));this._lineDelimiter=b?b:q.platformDelimiter;if(g){var e=this.getLineCount();if(1<e){for(var d=Array(e),h=0;h<e;h++)d[h]=this.getLine(h);this.setText(d.join(this._lineDelimiter))}}},setText:function(b,g,e){void 0===b&&(b="");void 0===g&&(g=0);void 0===e&&(e=
this.getCharCount());if(!(g===e&&""===b)){for(var d=this.getLineAtOffset(g),h=this.getLineAtOffset(e),c=g,a=e-g,k=h-d,n=b.length,p=0,f=this.getLineCount(),s=0,w=0,m=0,q=[];;){-1!==s&&s<=m&&(s=b.indexOf("\r",m));-1!==w&&w<=m&&(w=b.indexOf("\n",m));if(-1===w&&-1===s)break;m=-1!==s&&-1!==w?s+1===w?w+1:(s<w?s:w)+1:-1!==s?s+1:w+1;q.push(g+m);p++}this.onChanging({type:"Changing",text:b,start:c,removedCharCount:a,addedCharCount:n,removedLineCount:k,addedLineCount:p});0===q.length&&(m=this.getLineStart(d),
h=h+1<f?this.getLineStart(h+1):this.getCharCount(),g!==m&&(b=this.getText(m,g)+b,g=m),e!==h&&(b+=this.getText(e,h),e=h));m=n-a;for(h=d+k+1;h<f;h++)this._lineOffsets[h]+=m;if(5E4>q.length)d=[d+1,k].concat(q),Array.prototype.splice.apply(this._lineOffsets,d);else{m=d+1;this._lineOffsets.splice(m,k);for(f=0;f<q.length;f+=5E4)d=[m,0].concat(q.slice(f,Math.min(q.length,f+5E4))),Array.prototype.splice.apply(this._lineOffsets,d),m+=5E4}for(m=f=0;m<this._text.length;){h=this._text[m].length;if(g<=f+h)break;
f+=h;m++}d=f;for(q=m;m<this._text.length;){h=this._text[m].length;if(e<=f+h)break;f+=h;m++}h=this._text[m];g=this._text[q].substring(0,g-d);e=h.substring(e-f);q=[q,m-q+1];g&&q.push(g);b&&q.push(b);e&&q.push(e);Array.prototype.splice.apply(this._text,q);0===this._text.length&&(this._text=[""]);this.onChanged({type:"Changed",start:c,removedCharCount:a,addedCharCount:n,removedLineCount:k,addedLineCount:p})}}};f.EventTarget.addMixin(b.prototype);return{TextModel:b}});
define("orion/keyBinding",["orion/util"],function(f){function m(b,l,g,e,d,h){this.type=h||"keydown";this.keyCode="string"===typeof b&&"keydown"===this.type?b.toUpperCase().charCodeAt(0):b;this.mod1=void 0!==l&&null!==l?l:!1;this.mod2=void 0!==g&&null!==g?g:!1;this.mod3=void 0!==e&&null!==e?e:!1;this.mod4=void 0!==d&&null!==d?d:!1}function q(b){this.keys=b}m.prototype={getKeys:function(){return[this]},match:function(b,l){if(void 0!==l){if(0!==l)return!1}else if(b instanceof Array){if(1<b.length)return!1;
b=b[0]}return b.type!==this.type?!1:this.keyCode===b.keyCode||this.keyCode===String.fromCharCode(f.isOpera?b.which:void 0!==b.charCode?b.charCode:b.keyCode)?this.mod1!==(f.isMac?b.metaKey:b.ctrlKey)||"keydown"===this.type&&this.mod2!==b.shiftKey||this.mod3!==b.altKey||f.isMac&&this.mod4!==b.ctrlKey?!1:!0:!1},equals:function(b){return!b||this.keyCode!==b.keyCode||this.mod1!==b.mod1||this.mod2!==b.mod2||this.mod3!==b.mod3||this.mod4!==b.mod4||this.type!==b.type?!1:!0}};q.prototype={getKeys:function(){return this.keys.slice(0)},
match:function(b,l){var g=this.keys;if(void 0!==l)return l>g.length?!1:g[l].match(b)?l===g.length-1?!0:l+1:!1;b instanceof Array||(b=[b]);if(b.length>g.length)return!1;var e;for(e=0;e<b.length;e++)if(!g[e].match(b[e]))return!1;return e===g.length?!0:e},equals:function(b){if(!b.keys||b.keys.length!==this.keys.length)return!1;for(var l=0;l<b.keys.length;l++)if(!b.keys[l].equals(this.keys[l]))return!1;return!0}};return{KeyBinding:m,KeyStroke:m,KeySequence:q}});
define("orion/editor/keyModes",["orion/keyBinding","orion/util"],function(f,m){function q(b){b&&(this._view=b,this._keyBindings=this.createKeyBindings(),this._keyBindingIndex=0)}function b(b){q.call(this,b)}q.prototype={createKeyBindings:function(){return[]},getKeyBindings:function(b){for(var g=[],e=this._keyBindings,d=0;d<e.length;d++)e[d].actionID===b&&g.push(e[d].keyBinding);return g},getView:function(){return this._view},isActive:function(){return-1!==this._view.getKeyModes().indexOf(this)},match:function(b){if("keydown"===
b.type)switch(b.keyCode){case 16:case 17:case 18:case 91:return}for(var g=this._keyBindingIndex,e=this._matchingKeyBindings||this._keyBindings,d=[],h=0;h<e.length;h++){var c=e[h],a=c.keyBinding.match(b,g);if(!0===a)return this._keyBindingIndex=0,this._matchingKeyBindings=null,c.actionID;"number"===typeof a&&d.push(c)}if(0===d.length)this._keyBindingIndex=0,this._matchingKeyBindings=null;else return this._keyBindingIndex++,this._matchingKeyBindings=d,"noop"},setKeyBinding:function(b,g){for(var e=this._keyBindings,
d=0;d<e.length;d++){var h=e[d];if(h.keyBinding.equals(b)){g?h.actionID=g:h.predefined?h.actionID="noop":e.splice(d,1);return}}g&&e.push({keyBinding:b,actionID:g})},setView:function(b){this._view=b}};b.prototype=new q;b.prototype.createKeyBindings=function(){var b=f.KeyBinding,g=[];g.push({actionID:"lineUp",keyBinding:new b(38),predefined:!0});g.push({actionID:"lineDown",keyBinding:new b(40),predefined:!0});g.push({actionID:"charPrevious",keyBinding:new b(37),predefined:!0});g.push({actionID:"charNext",
keyBinding:new b(39),predefined:!0});m.isMac?(g.push({actionID:"scrollPageUp",keyBinding:new b(33),predefined:!0}),g.push({actionID:"scrollPageDown",keyBinding:new b(34),predefined:!0}),g.push({actionID:"pageUp",keyBinding:new b(33,null,null,!0),predefined:!0}),g.push({actionID:"pageDown",keyBinding:new b(34,null,null,!0),predefined:!0}),g.push({actionID:"lineStart",keyBinding:new b(37,!0),predefined:!0}),g.push({actionID:"lineEnd",keyBinding:new b(39,!0),predefined:!0}),g.push({actionID:"wordPrevious",
keyBinding:new b(37,null,null,!0),predefined:!0}),g.push({actionID:"wordNext",keyBinding:new b(39,null,null,!0),predefined:!0}),g.push({actionID:"scrollTextStart",keyBinding:new b(36),predefined:!0}),g.push({actionID:"scrollTextEnd",keyBinding:new b(35),predefined:!0}),g.push({actionID:"textStart",keyBinding:new b(38,!0),predefined:!0}),g.push({actionID:"textEnd",keyBinding:new b(40,!0),predefined:!0}),g.push({actionID:"scrollPageUp",keyBinding:new b(38,null,null,null,!0),predefined:!0}),g.push({actionID:"scrollPageDown",
keyBinding:new b(40,null,null,null,!0),predefined:!0}),g.push({actionID:"lineStart",keyBinding:new b(37,null,null,null,!0),predefined:!0}),g.push({actionID:"lineEnd",keyBinding:new b(39,null,null,null,!0),predefined:!0}),g.push({actionID:"lineStart",keyBinding:new b(38,null,null,!0),predefined:!0}),g.push({actionID:"lineEnd",keyBinding:new b(40,null,null,!0),predefined:!0})):(g.push({actionID:"pageUp",keyBinding:new b(33),predefined:!0}),g.push({actionID:"pageDown",keyBinding:new b(34),predefined:!0}),
g.push({actionID:"lineStart",keyBinding:new b(36),predefined:!0}),g.push({actionID:"lineEnd",keyBinding:new b(35),predefined:!0}),g.push({actionID:"wordPrevious",keyBinding:new b(37,!0),predefined:!0}),g.push({actionID:"wordNext",keyBinding:new b(39,!0),predefined:!0}),g.push({actionID:"textStart",keyBinding:new b(36,!0),predefined:!0}),g.push({actionID:"textEnd",keyBinding:new b(35,!0),predefined:!0}));m.isFirefox&&m.isLinux&&(g.push({actionID:"lineUp",keyBinding:new b(38,!0),predefined:!0}),g.push({actionID:"lineDown",
keyBinding:new b(40,!0),predefined:!0}));m.isWindows&&(g.push({actionID:"scrollLineUp",keyBinding:new b(38,!0),predefined:!0}),g.push({actionID:"scrollLineDown",keyBinding:new b(40,!0),predefined:!0}));g.push({actionID:"selectLineUp",keyBinding:new b(38,null,!0),predefined:!0});g.push({actionID:"selectLineDown",keyBinding:new b(40,null,!0),predefined:!0});g.push({actionID:"selectCharPrevious",keyBinding:new b(37,null,!0),predefined:!0});g.push({actionID:"selectCharNext",keyBinding:new b(39,null,!0),
predefined:!0});g.push({actionID:"selectPageUp",keyBinding:new b(33,null,!0),predefined:!0});g.push({actionID:"selectPageDown",keyBinding:new b(34,null,!0),predefined:!0});m.isMac?(g.push({actionID:"selectLineStart",keyBinding:new b(37,!0,!0),predefined:!0}),g.push({actionID:"selectLineEnd",keyBinding:new b(39,!0,!0),predefined:!0}),g.push({actionID:"selectWordPrevious",keyBinding:new b(37,null,!0,!0),predefined:!0}),g.push({actionID:"selectWordNext",keyBinding:new b(39,null,!0,!0),predefined:!0}),
g.push({actionID:"selectTextStart",keyBinding:new b(36,null,!0),predefined:!0}),g.push({actionID:"selectTextEnd",keyBinding:new b(35,null,!0),predefined:!0}),g.push({actionID:"selectTextStart",keyBinding:new b(38,!0,!0),predefined:!0}),g.push({actionID:"selectTextEnd",keyBinding:new b(40,!0,!0),predefined:!0}),g.push({actionID:"selectLineStart",keyBinding:new b(37,null,!0,null,!0),predefined:!0}),g.push({actionID:"selectLineEnd",keyBinding:new b(39,null,!0,null,!0),predefined:!0}),g.push({actionID:"selectLineStart",
keyBinding:new b(38,null,!0,!0),predefined:!0}),g.push({actionID:"selectLineEnd",keyBinding:new b(40,null,!0,!0),predefined:!0})):(m.isLinux&&(g.push({actionID:"selectWholeLineUp",keyBinding:new b(38,!0,!0),predefined:!0}),g.push({actionID:"selectWholeLineDown",keyBinding:new b(40,!0,!0),predefined:!0})),g.push({actionID:"selectLineStart",keyBinding:new b(36,null,!0),predefined:!0}),g.push({actionID:"selectLineEnd",keyBinding:new b(35,null,!0),predefined:!0}),g.push({actionID:"selectWordPrevious",
keyBinding:new b(37,!0,!0),predefined:!0}),g.push({actionID:"selectWordNext",keyBinding:new b(39,!0,!0),predefined:!0}),g.push({actionID:"selectTextStart",keyBinding:new b(36,!0,!0),predefined:!0}),g.push({actionID:"selectTextEnd",keyBinding:new b(35,!0,!0),predefined:!0}));g.push({actionID:"undo",keyBinding:new f.KeyBinding("z",!0),predefined:!0});m.isMac?g.push({actionID:"redo",keyBinding:new f.KeyBinding("z",!0,!0),predefined:!0}):g.push({actionID:"redo",keyBinding:new f.KeyBinding("y",!0),predefined:!0});
g.push({actionID:"deletePrevious",keyBinding:new b(8),predefined:!0});g.push({actionID:"deletePrevious",keyBinding:new b(8,null,!0),predefined:!0});g.push({actionID:"deleteNext",keyBinding:new b(46),predefined:!0});g.push({actionID:"deleteWordPrevious",keyBinding:new b(8,!0),predefined:!0});g.push({actionID:"deleteWordPrevious",keyBinding:new b(8,!0,!0),predefined:!0});g.push({actionID:"deleteWordNext",keyBinding:new b(46,!0),predefined:!0});g.push({actionID:"tab",keyBinding:new b(9),predefined:!0});
g.push({actionID:"shiftTab",keyBinding:new b(9,null,!0),predefined:!0});g.push({actionID:"enter",keyBinding:new b(13),predefined:!0});g.push({actionID:"enter",keyBinding:new b(13,null,!0),predefined:!0});g.push({actionID:"selectAll",keyBinding:new b("a",!0),predefined:!0});g.push({actionID:"toggleTabMode",keyBinding:new b("m",!0),predefined:!0});m.isMac&&(g.push({actionID:"deleteNext",keyBinding:new b(46,null,!0),predefined:!0}),g.push({actionID:"deleteWordPrevious",keyBinding:new b(8,null,null,!0),
predefined:!0}),g.push({actionID:"deleteWordNext",keyBinding:new b(46,null,null,!0),predefined:!0}));g.push({actionID:"toggleWrapMode",keyBinding:new f.KeyBinding("w",!0,!1,!0)});g.push({actionID:"toggleOverwriteMode",keyBinding:new f.KeyBinding(45)});if(!m.isFirefox){var e=m.isMac&&m.isChrome;g.push({actionID:"noop",keyBinding:new b("u",!e,!1,!1,e),predefined:!0});g.push({actionID:"noop",keyBinding:new b("i",!e,!1,!1,e),predefined:!0});g.push({actionID:"noop",keyBinding:new b("b",!e,!1,!1,e),predefined:!0})}m.isFirefox&&
(g.push({actionID:"copy",keyBinding:new b(45,!0),predefined:!0}),g.push({actionID:"paste",keyBinding:new b(45,null,!0),predefined:!0}),g.push({actionID:"cut",keyBinding:new b(46,null,!0),predefined:!0}));m.isMac&&(g.push({actionID:"lineStart",keyBinding:new b("a",!1,!1,!1,!0),predefined:!0}),g.push({actionID:"lineEnd",keyBinding:new b("e",!1,!1,!1,!0),predefined:!0}),g.push({actionID:"lineUp",keyBinding:new b("p",!1,!1,!1,!0),predefined:!0}),g.push({actionID:"lineDown",keyBinding:new b("n",!1,!1,
!1,!0),predefined:!0}),g.push({actionID:"charPrevious",keyBinding:new b("b",!1,!1,!1,!0),predefined:!0}),g.push({actionID:"charNext",keyBinding:new b("f",!1,!1,!1,!0),predefined:!0}),g.push({actionID:"deletePrevious",keyBinding:new b("h",!1,!1,!1,!0),predefined:!0}),g.push({actionID:"deleteNext",keyBinding:new b("d",!1,!1,!1,!0),predefined:!0}),g.push({actionID:"deleteLineEnd",keyBinding:new b("k",!1,!1,!1,!0),predefined:!0}),m.isFirefox?(g.push({actionID:"scrollPageDown",keyBinding:new b("v",!1,
!1,!1,!0),predefined:!0}),g.push({actionID:"deleteLineStart",keyBinding:new b("u",!1,!1,!1,!0),predefined:!0}),g.push({actionID:"deleteWordPrevious",keyBinding:new b("w",!1,!1,!1,!0),predefined:!0})):(g.push({actionID:"pageDown",keyBinding:new b("v",!1,!1,!1,!0),predefined:!0}),g.push({actionID:"centerLine",keyBinding:new b("l",!1,!1,!1,!0),predefined:!0}),g.push({actionID:"enterNoCursor",keyBinding:new b("o",!1,!1,!1,!0),predefined:!0})));return g};return{KeyMode:q,DefaultKeyMode:b}});
define("orion/editor/textTheme",["require","orion/editor/eventTarget","orion/util"],function(f,m,q){function b(b){b=b||{};this._document=b.document||document}var l={};b.getTheme=function(g){var g=g||"default",e=l[g];e||(e=l[g]=new b);return e};b.prototype={getThemeClass:function(){return this._themeClass},setThemeClass:function(b,e){var d=this,h=d._themeClass;d._themeClass=b;this._load(b,e,function(){d.onThemeChanged({type:"ThemeChanged",oldValue:h,newValue:d.getThemeClass()})})},onThemeChanged:function(b){return this.dispatchEvent(b)},
buildStyleSheet:function(b,e){function d(c,a,d){a&&(h.push("."+b+" ."+c+" {"),h.push("\t"+(d?"background-color":"color")+": "+a+";"),h.push("}"))}var h=[];h.push("");h.push("."+b+" {");e.fontFamily&&h.push("\tfont-family: "+e.fontFamily+";");e.fontSize&&h.push("\tfont-size: "+e.fontSize+";");e.fontSize&&h.push("\tcolor: "+e.text+";");h.push("}");h.push("."+b+".textview {");e.background&&h.push("\tbackground-color: "+e.background+";");h.push("}");d("ruler.annotations",e.annotationRuler,!0);d("ruler.lines",
e.annotationRuler,!0);d("ruler.folding",e.annotationRuler,!0);d("ruler.overview",e.overviewRuler,!0);d("rulerLines",e.lineNumber,!1);d("rulerLines.even",e.lineNumberEven,!1);d("rulerLines.odd",e.lineNumberOdd,!1);d("annotationLine.currentLine",e.currentLine,!0);d("entity-name-tag",e.keyword,!1);d("entity-other-attribute-name",e.attribute,!1);d("string-quoted",e.string,!1);d("meta.annotation.currentLine",e.currentLine,!0);d("keyword",e.keyword,!1);d("string",e.string,!1);d("comment",e.comment,!1);
d("comment.block.documentation",e.comment,!1);d("keyword.other.documentation.markup",e.comment,!1);return h.join("\n")},_createStyle:function(b,e,d,h){var c=this._document,b="orion-theme-"+b,a=c.getElementById(b);if(a){if(h||a.firstChild.data===e)return;a.removeChild(a.firstChild);a.appendChild(c.createTextNode(e))}else h?(a=q.createElement(c,"link"),a.rel="stylesheet",a.type="text/css",a.href=e,a.addEventListener("load",function(){d()})):(a=q.createElement(c,"style"),a.appendChild(c.createTextNode(e))),
a.id=b,(c.getElementsByTagName("head")[0]||c.documentElement).appendChild(a);h||d()},_load:function(b,e,d){if(b)if("string"===typeof e)this._createStyle(b,e,d);else if(e=e.href,".css"!==e.substring(e.length-4)&&(e+=".css"),/^\//.test(e)||/[a-zA-Z0-9]+:\/\//i.test(e)||!f.toUrl)this._createStyle(b,e,d,!0);else{var h=this;f(["text!"+e],function(c){h._createStyle(b,c,d,!1)})}else d()}};m.EventTarget.addMixin(b.prototype);return{TextTheme:b}});
define("orion/editor/util",[],function(){return{contains:function(f,m){if(!m)return!1;if(!f.compareDocumentPosition){for(var q=m;q;){if(f===q)return!0;q=q.parentNode}return!1}return f===m||0!==(f.compareDocumentPosition(m)&16)},addEventListener:function(f,m,q,b){"function"===typeof f.addEventListener?f.addEventListener(m,q,!0===b):f.attachEvent("on"+m,q)},removeEventListener:function(f,m,q,b){"function"===typeof f.removeEventListener?f.removeEventListener(m,q,!0===b):f.detachEvent("on"+m,q)}}});
define("orion/editor/textView","i18n!orion/editor/nls/messages orion/editor/textModel orion/editor/keyModes orion/editor/eventTarget orion/editor/textTheme orion/editor/util orion/util".split(" "),function(f,m,q,b,l,g,e){function d(a,c,b){if(b){c.className="";for(var b=c.attributes,d=b.length;0<d--;)(!e.isIE||9<=e.isIE||9>e.isIE&&b[d].specified)&&c.removeAttribute(b[d].name)}if(a){a.styleClass&&(c.className=a.styleClass);if(b=a.style)for(var k in b)b.hasOwnProperty(k)&&(c.style[k]=b[k]);if(a=a.attributes)for(var n in a)a.hasOwnProperty(n)&&
c.setAttribute(n,a[n])}}function h(a){return a instanceof Array?a.slice(0):a}function c(a,c){if(!a)return c;if(!c)return a;for(var b in c)c.hasOwnProperty(b)&&(a.hasOwnProperty(b)||(a[b]=c[b]));return a}function a(r,c){if(r===c)return!0;if(r&&!c||!r&&c||r&&r.constructor===String||c&&c.constructor===String)return!1;if(r instanceof Array||c instanceof Array){if(!(r instanceof Array&&c instanceof Array)||r.length!==c.length)return!1;for(var b=0;b<r.length;b++)if(!a(r[b],c[b]))return!1;return!0}if(!(r instanceof
Object)||!(c instanceof Object))return!1;for(b in r)if(r.hasOwnProperty(b)&&(!c.hasOwnProperty(b)||!a(r[b],c[b])))return!1;for(b in c)if(!r.hasOwnProperty(b))return!1;return!0}function k(a,c,b){for(var d=0,k=0,e=0,n=a.length;e<n;){-1!==d&&d<=e&&(d=a.indexOf("\r",e));-1!==k&&k<=e&&(k=a.indexOf("\n",e));var h=e,p;if(-1===k&&-1===d){c(a.substring(e));break}-1!==d&&-1!==k?d+1===k?(p=d,e=k+1):(p=d<k?d:k,e=(d<k?d:k)+1):-1!==d?(p=d,e=d+1):(p=k,e=k+1);c(a.substring(h,p));b()}}function n(a){var c,b,d,k,e=
a.ownerDocument.defaultView||a.ownerDocument.parentWindow;e.getComputedStyle?(a=e.getComputedStyle(a,null),c=a.getPropertyValue("padding-left"),b=a.getPropertyValue("padding-top"),d=a.getPropertyValue("padding-right"),k=a.getPropertyValue("padding-bottom")):a.currentStyle&&(c=a.currentStyle.paddingLeft,b=a.currentStyle.paddingTop,d=a.currentStyle.paddingRight,k=a.currentStyle.paddingBottom);return{left:parseInt(c,10)||0,top:parseInt(b,10)||0,right:parseInt(d,10)||0,bottom:parseInt(k,10)||0}}function p(a){var c,
b,d,k,e=a._trim;if(!e){var e=n(a),h=a.ownerDocument.defaultView||a.ownerDocument.parentWindow;h.getComputedStyle?(k=h.getComputedStyle(a,null),c=k.getPropertyValue("border-left-width"),b=k.getPropertyValue("border-top-width"),d=k.getPropertyValue("border-right-width"),k=k.getPropertyValue("border-bottom-width")):a.currentStyle&&(c=a.currentStyle.borderLeftWidth,b=a.currentStyle.borderTopWidth,d=a.currentStyle.borderRightWidth,k=a.currentStyle.borderBottomWidth);c=parseInt(c,10)||0;b=parseInt(b,10)||
0;d=parseInt(d,10)||0;k=parseInt(k,10)||0;e.left+=c;e.top+=b;e.right+=d;e.bottom+=k;a._trim=e}return e}function u(a,c,b){this.start=a;this.end=c;this.caret=b}function s(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom}function w(a,c,b){this.view=a;this.lineIndex=c;this._lineDiv=b}function y(a){this._init(a||{})}var x=g.addEventListener,v=g.removeEventListener,z=function(a){this.options=a};z.prototype.play=function(){var a="number"===typeof this.options.duration?this.options.duration:
350,c=this.options.easing||this.defaultEasing,b=this.options.onAnimate||function(){},d=this.options.curve[0],k=this.options.curve[1],e=k-d,n=-1,h,p=this;this.interval=this.options.window.setInterval(function(){n=-1===n?(new Date).getTime():n;var g=((new Date).getTime()-n)/a;1>g?(g=c(g),h=d+g*e,b(h)):(b(k),p.stop())},"number"===typeof this.options.rate?this.options.rate:20)};z.prototype.stop=function(){this.options.window.clearInterval(this.interval);(this.options.onEnd||function(){})()};z.prototype.defaultEasing=
function(a){return Math.sin(a*(Math.PI/2))};u.prototype={clone:function(){return new u(this.start,this.end,this.caret)},collapse:function(){this.caret?this.end=this.start:this.start=this.end},extend:function(a){this.caret?this.start=a:this.end=a;this.start>this.end&&(a=this.start,this.start=this.end,this.end=a,this.caret=!this.caret)},setCaret:function(a){this.end=this.start=a;this.caret=!1},getCaret:function(){return this.caret?this.start:this.end},toString:function(){return"start="+this.start+" end="+
this.end+(this.caret?" caret is at start":" caret is at end")},isEmpty:function(){return this.start===this.end},equals:function(a){return this.caret===a.caret&&this.start===a.start&&this.end===a.end}};s.prototype={toString:function(){return"{l="+this.left+", t="+this.top+", r="+this.right+", b="+this.bottom+"}"}};w.prototype={create:function(a,c){if(!this._lineDiv){var b=this._lineDiv=this._createLine(a,c,this.lineIndex);b._line=this;return b}},_createLine:function(r,c,b){var k=this.view,n=k._model,
h=n.getLine(b),p=n.getLineStart(b),g={type:"LineStyle",textView:k,lineIndex:b,lineText:h,lineStart:p};if(2E3>h.length)k.onLineStyle(g);n=c||e.createElement(r.ownerDocument,"div");if(!c||!a(c.viewStyle,g.style))d(g.style,n,c),c&&(c._trim=null),n.viewStyle=g.style,n.setAttribute("role","presentation");n.lineIndex=b;b=[];this._createRanges(g.ranges,h,0,h.length,p,{tabOffset:0,ranges:b});h=" ";!k._fullSelection&&9>e.isIE&&(h="\ufeff");g={text:h,style:k._metrics.largestFontStyle,ignoreChars:1};0===b.length||
!b[b.length-1].style||"div"!==b[b.length-1].style.tagName?b.push(g):b.splice(b.length-1,0,g);var f,l,s,m,w,h=k=0,v,u;if(c){if(l=c.modelChangedEvent)0===l.removedLineCount&&0===l.addedLineCount?(u=l.start-p,v=l.addedCharCount-l.removedCharCount):u=-1,c.modelChangedEvent=void 0;l=c.firstChild}for(p=0;p<b.length;p++){g=b[p];m=g.text;k+=m.length;f=g.style;if(l)if(w=l.firstChild.data,s=l.viewStyle,w===m&&a(f,s)){h+=w.length;l._rectsCache=void 0;f=l=l.nextSibling;continue}else for(;l;){if(-1!==u){s=k;s>=
u&&(s-=v);w=(w=l.firstChild.data)?w.length:0;if(h+w>s)break;h+=w}s=l.nextSibling;n.removeChild(l);l=s}f=this._createSpan(n,m,f,g.ignoreChars);l?n.insertBefore(f,l):n.appendChild(f);c&&(c.lineWidth=void 0)}if(c)for(r=f?f.nextSibling:null;r;)s=r.nextSibling,c.removeChild(r),r=s;else r.appendChild(n);return n},_createRanges:function(r,c,b,d,k,e){if(!(b>d)){if(r)for(var n=0;n<r.length;n++){var h=r[n];if(!(h.end<k+b)){var p=Math.max(k+b,h.start)-k;if(p>d)break;var g=Math.min(k+d,h.end)-k;if(p<=g){p=Math.max(b,
p);g=Math.min(d,g);b<p&&this._createRange(c,b,p,null,e);if(!h.style||!h.style.unmergeable)for(;n+1<r.length&&r[n+1].start-k===g&&a(h.style,r[n+1].style);)h=r[n+1],g=Math.min(k+d,h.end)-k,n++;this._createRange(c,p,g,h.style,e);b=g}}}b<d&&this._createRange(c,b,d,null,e)}},_createRange:function(a,c,b,d,k){if(!(c>b)){var e=this.view._customTabSize;if(e&&8!==e)for(var n=a.indexOf("\t",c);-1!==n&&n<b;){c<n&&(c={text:a.substring(c,n),style:d},k.ranges.push(c),k.tabOffset+=c.text.length);c=e-k.tabOffset%
e;if(0<c){for(var h="\u00a0",p=1;p<c;p++)h+=" ";c={text:h,style:d,ignoreChars:c-1};k.ranges.push(c);k.tabOffset+=c.text.length}c=n+1;if(c===b)return;n=a.indexOf("\t",c)}c<=b&&(c={text:a.substring(c,b),style:d},k.ranges.push(c),k.tabOffset+=c.text.length)}},_createSpan:function(a,c,b,k){var n=this.view,h="span";b&&b.tagName&&(h=b.tagName.toLowerCase());var p="a"===h;p&&(a.hasLink=!0);p&&!n._linksVisible&&(h="span");p=a.ownerDocument;a=e.createElement(a.ownerDocument,h);b&&b.html?(a.innerHTML=b.html,
a.ignore=!0):b&&b.node?(a.appendChild(b.node),a.ignore=!0):a.appendChild(p.createTextNode(b&&b.text?b.text:c));d(b,a);if("a"===h){var g=n._getWindow();x(a,"click",function(a){return n._handleLinkClick(a?a:g.event)},!1)}a.viewStyle=b;k&&(a.ignoreChars=k);return a},_ensureCreated:function(){return this._lineDiv?this._lineDiv:this._createdDiv=this.create(this.view._clientDiv,null)},getBoundingClientRect:function(a,c){var b=this._ensureCreated(),d=this.view;if(void 0===a)return this._getLineBoundingClientRect(b,
!0);var k=d._model,n=b.ownerDocument,h=this.lineIndex,p=null;if(a<k.getLineEnd(h)){h=k.getLineStart(h);for(k=b.firstChild;k;){if(!k.ignore){var g=k.firstChild,f=g.length;k.ignoreChars&&(f-=k.ignoreChars);if(h+f>a){p=a-h;if(1===g.length)p=new s(k.getBoundingClientRect());else if(d._isRangeRects)n=n.createRange(),n.setStart(g,p),n.setEnd(g,p+1),p=new s(n.getBoundingClientRect());else if(e.isIE)n=n.body.createTextRange(),n.moveToElementText(k),n.collapse(),(h=0===p&&8===e.isIE)&&(p=1),n.moveEnd("character",
p+1),n.moveStart("character",p),p=new s(n.getBoundingClientRect()),h&&(p.left=k.getClientRects()[0].left);else{var l=g.data;k.removeChild(g);k.appendChild(n.createTextNode(l.substring(0,p)));var m=e.createElement(n,"span");m.appendChild(n.createTextNode(l.substring(p,p+1)));k.appendChild(m);k.appendChild(n.createTextNode(l.substring(p+1)));p=new s(m.getBoundingClientRect());k.innerHTML="";k.appendChild(g);this._createdDiv||(n=d._getSelection(),(h<=n.start&&n.start<h+f||h<=n.end&&n.end<h+f)&&d._updateDOMSelection())}e.isIE&&
(n=b.ownerDocument.defaultView||b.ownerDocument.parentWindow,b=n.screen.logicalXDPI/n.screen.deviceXDPI,n=n.screen.logicalYDPI/n.screen.deviceYDPI,p.left*=b,p.right*=b,p.top*=n,p.bottom*=n);break}h+=f}k=k.nextSibling}}b=this.getBoundingClientRect();p||(d._wrapMode?(d=this.getClientRects(),p=d[d.length-1],p.left=p.right,p.left+=b.left,p.top+=b.top,p.right+=b.left,p.bottom+=b.top):(p=new s(b),p.left=p.right));if(c||void 0===c)p.left-=b.left,p.top-=b.top,p.right-=b.left,p.bottom-=b.top;return p},_getClientRects:function(a,
c){var b,d,k,e;if(!a._rectsCache){b=a.getClientRects();d=Array(b.length);for(e=0;e<b.length;e++)k=d[e]=new s(b[e]),k.left-=c.left,k.top-=c.top,k.right-=c.left,k.bottom-=c.top;a._rectsCache=d}b=a._rectsCache;d=[b.length];for(e=0;e<b.length;e++)d[e]=new s(b[e]);return d},getClientRects:function(a){if(!this.view._wrapMode)return[this.getBoundingClientRect()];for(var c=this._ensureCreated(),b=[],d=c.firstChild,k,e=c.getBoundingClientRect();d;){if(!d.ignore)for(var n=this._getClientRects(d,e),c=0;c<n.length;c++){var h=
n[c],p;if(h.top!==h.bottom){var g=h.top+(h.bottom-h.top)/2;for(p=0;p<b.length&&!(k=b[p],k.top<=g&&g<k.bottom);p++);p===b.length?b.push(h):(h.left<k.left&&(k.left=h.left),h.top<k.top&&(k.top=h.top),h.right>k.right&&(k.right=h.right),h.bottom>k.bottom&&(k.bottom=h.bottom))}}d=d.nextSibling}return void 0!==a?b[a]:b},_getLineBoundingClientRect:function(a,c){var b=new s(a.getBoundingClientRect());if(!this.view._wrapMode){b.right=b.left;for(var d=a.lastChild;d&&d.ignoreChars===d.firstChild.length;)d=d.previousSibling;
d&&(d=d.getBoundingClientRect(),b.right=d.right+p(a).right)}c&&(d=p(a),b.left+=d.left,b.right-=d.right);return b},getLineCount:function(){return!this.view._wrapMode?1:this.getClientRects().length},getLineIndex:function(a){if(!this.view._wrapMode)return 0;for(var c=this.getClientRects(),a=this.getBoundingClientRect(a),a=a.top+(a.bottom-a.top)/2,b=0;b<c.length;b++)if(c[b].top<=a&&a<c[b].bottom)return b;return c.length-1},getLineStart:function(a){if(!this.view._wrapMode||0===a)return this.view._model.getLineStart(a);
var c=this.getClientRects();return this.getOffset(c[a].left+1,c[a].top+1)},getOffset:function(a,c){var b=this.view,d=b._model,k=this.lineIndex,n=d.getLineStart(k),h=d.getLineEnd(k);if(n===h)return n;var p=this._ensureCreated(),g=this.getBoundingClientRect(),f,l;if(b._wrapMode){f=this.getClientRects();c<f[0].top&&(c=f[0].top);for(var s=0;s<f.length&&!(l=f[s],l.top<=c&&c<l.bottom);s++);a<l.left&&(a=l.left);a>l.right&&(a=l.right-1)}else 0>a&&(a=0),a>g.right-g.left&&(a=g.right-g.left);var m=p.ownerDocument,
s=m.defaultView||m.parentWindow,w=e.isIE?s.screen.logicalXDPI/s.screen.deviceXDPI:1,v=e.isIE?s.screen.logicalYDPI/s.screen.deviceYDPI:1,s=n,u=p.firstChild;a:for(;u;){if(!u.ignore){var q=u.firstChild,p=q.length;u.ignoreChars&&(p-=u.ignoreChars);var y,z,x;f=this._getClientRects(u,g);for(var K=0;K<f.length;K++)if(l=f[K],l.left<=a&&a<l.right&&(!b._wrapMode||l.top<=c&&c<l.bottom)){var K=l.left+g.left,G;if(e.isIE||b._isRangeRects){for(var m=b._isRangeRects?m.createRange():m.body.createTextRange(),F=p,L=
-1;1<F-L;){var V=Math.floor((F+L)/2);f=L+1;l=V===p-1&&u.ignoreChars?q.length:V+1;G=0===f&&8===e.isIE;b._isRangeRects?(m.setStart(q,f),m.setEnd(q,l)):(G&&(f=1),m.moveToElementText(u),m.move("character",f),m.moveEnd("character",l-f));f=m.getClientRects();for(var X=!1,W=0;W<f.length;W++)if(l=f[W],y=(G?K:l.left)*w-g.left,x=l.right*w-g.left,z=l.top*v-g.top,l=l.bottom*v-g.top,y<=a&&a<x&&(!b._wrapMode||z<=c&&c<l)){X=!0;break}X?F=V:L=V}s+=F;f=F;l=F===p-1&&u.ignoreChars?q.length:Math.min(F+1,q.length);b._isRangeRects?
(m.setStart(q,f),m.setEnd(q,l)):(m.moveToElementText(u),m.move("character",f),m.moveEnd("character",l-f));f=m.getClientRects();b=!1;0<f.length&&(l=f[0],y=(G?K:l.left)*w-g.left,x=l.right*w-g.left,b=a>y+(x-y)/2);g=s-n;d=d.getLine(k);k=d.charCodeAt(g);55296<=k&&56319>=k&&b?g<d.length&&(k=d.charCodeAt(g+1),56320<=k&&57343>=k&&(s+=1)):56320<=k&&(57343>=k&&!b)&&0<g&&(k=d.charCodeAt(g-1),55296<=k&&56319>=k&&(s-=1));b&&s++}else{d=[];for(k=0;k<p;k++)d.push("<span>"),k===p-1?d.push(q.data.substring(k)):d.push(q.data.substring(k,
k+1)),d.push("</span>");u.innerHTML=d.join("");for(d=u.firstChild;d;){l=d.getBoundingClientRect();y=l.left-g.left;x=l.right-g.left;if(y<=a&&a<x){a>y+(x-y)/2&&s++;break}s++;d=d.nextSibling}this._createdDiv||(u.innerHTML="",u.appendChild(q),g=b._getSelection(),(s<=g.start&&g.start<s+p||s<=g.end&&g.end<s+p)&&b._updateDOMSelection())}break a}s+=p}u=u.nextSibling}return Math.min(h,Math.max(n,s))},getNextOffset:function(a,c){if("line"===c.unit){var b=this.view._model,d=b.getLineAtOffset(a);if(0<c.count)return c.count--,
b.getLineEnd(d);c.count++;return b.getLineStart(d)}return"wordend"===c.unit||"wordWS"===c.unit||"wordendWS"===c.unit?this._getNextOffset_W3C(a,c):e.isIE?this._getNextOffset_IE(a,c):this._getNextOffset_W3C(a,c)},_getNextOffset_W3C:function(a,c){function b(a){return 33<=a&&47>=a||58<=a&&64>=a||91<=a&&94>=a||96===a||123<=a&&126>=a}function d(a){return 32===a||9===a}var k=this.view._model,e=k.getLineAtOffset(a),n=k.getLine(e),h=k.getLineStart(e),k=k.getLineEnd(e),e=n.length,p=a-h,g,f=0>c.count?-1:1;if("word"===
c.unit||"wordend"===c.unit||"wordWS"===c.unit||"wordendWS"===c.unit)for(var l,s,m;0!==c.count;){if(0<c.count){if(p===e)return k;g=n.charCodeAt(p);l=b(g);s=!l&&!d(g);for(p++;p<e;){g=n.charCodeAt(p);if("wordWS"!==c.unit&&"wordendWS"!==c.unit){m=b(g);if("wordend"===c.unit){if(!m&&l)break}else if(m&&!l)break;g=!m&&!d(g)}else g=!d(g);if("wordend"===c.unit||"wordendWS"===c.unit){if(!g&&s)break}else if(g&&!s)break;s=g;l=m;p++}}else{if(0===p)return h;p--;g=n.charCodeAt(p);l=b(g);for(s=!l&&!d(g);0<p;){g=n.charCodeAt(p-
1);if("wordWS"!==c.unit&&"wordendWS"!==c.unit){m=b(g);if("wordend"===c.unit){if(m&&!l)break}else if(!m&&l)break;g=!m&&!d(g)}else g=!d(g);if("wordend"===c.unit||"wordendWS"===c.unit){if(g&&!s)break}else if(!g&&s)break;s=g;l=m;p--}}c.count-=f}else for(;0!==c.count&&0<=p+f&&p+f<=e;)p+=f,g=n.charCodeAt(p),56320<=g&&57343>=g&&0<p&&(g=n.charCodeAt(p-1),55296<=g&&56319>=g&&(p+=f)),c.count-=f;return h+p},_getNextOffset_IE:function(a,c){var b=this._ensureCreated(),d=this.view._model,k=this.lineIndex,e=0,n;
n=d.getLineStart(k);var h=b.ownerDocument,p=0>c.count?-1:1;if(a===d.getLineEnd(k)){for(b=b.lastChild;b&&b.ignoreChars===b.firstChild.length;)b=b.previousSibling;if(!b)return n;e=h.body.createTextRange();e.moveToElementText(b);n=e.text.length;e.moveEnd(c.unit,p);e=a+e.text.length-n}else if(a===n&&0>c.count)e=n;else for(b=b.firstChild;b;){d=b.firstChild.length;b.ignoreChars&&(d-=b.ignoreChars);if(n+d>a){e=h.body.createTextRange();if(a===n&&0>c.count){for(n=b.previousSibling;n&&(!n.firstChild||!n.firstChild.length);)n=
n.previousSibling;e.moveToElementText(n?n:b.previousSibling)}else e.moveToElementText(b),e.collapse(),e.moveEnd("character",a-n);n=e.text.length;e.moveEnd(c.unit,p);e=a+e.text.length-n;break}n=d+n;b=b.nextSibling}c.count-=p;return e},destroy:function(){var a=this._createdDiv;a&&(a.parentNode.removeChild(a),this._createdDiv=null)}};y.prototype={addKeyMode:function(a,c){var b=this._keyModes;void 0!==c?b.splice(c,0,a):b.push(a);a._modeAdded&&a._modeAdded()},addRuler:function(a,c){a.setView(this);var b=
this._rulers;if(void 0!==c){var d,k;for(k=d=0;d<b.length&&k<c;d++)a.getLocation()===b[d].getLocation()&&k++;b.splice(k,0,a);c=k}else b.push(a);this._createRuler(a,c);this._update()},computeSize:function(){var a=0,c=0,b=this._model,d=this._clientDiv;if(!d)return{width:a,height:c};var k=d.style.width;e.isWebkit&&(d.style.width="0x7fffffffpx");for(var b=b.getLineCount(),n=0;n<b;n++){var h=this._getLine(n),p=h.getBoundingClientRect(),a=Math.max(a,p.right-p.left),c=c+(p.bottom-p.top);h.destroy()}e.isWebkit&&
(d.style.width=k);d=this._getViewPadding();a+=d.right+d.left+this._metrics.scrollWidth;c+=d.bottom+d.top+this._metrics.scrollWidth;return{width:a,height:c}},convert:function(a,c,b){if(this._clientDiv){var d=this._getScroll(),k=this._getViewPadding(),e=this._viewDiv.getBoundingClientRect();"document"===c&&(void 0!==a.x&&(a.x+=-d.x+e.left+k.left),void 0!==a.y&&(a.y+=-d.y+e.top+k.top));"document"===b&&(void 0!==a.x&&(a.x+=d.x-e.left-k.left),void 0!==a.y&&(a.y+=d.y-e.top-k.top));return a}},destroy:function(){for(var a=
0;a<this._rulers.length;a++)this._rulers[a].setView(null);this.rulers=null;this._destroyView();this.onDestroy({type:"Destroy"});this._parent=null;this._model&&this._model.destroy&&this._model.destroy();this._actions=this._keyModes=this._doubleClickSelection=this._selection=this._theme=this._model=null},focus:function(){this._clientDiv&&(this._updateDOMSelection(),this._clientDiv.focus(),this._updateDOMSelection())},hasFocus:function(){return this._hasFocus},getActionDescription:function(a){if(a=this._actions[a])return a.actionDescription},
getActions:function(a){var c=[],b=this._actions,d;for(d in b)b.hasOwnProperty(d)&&(a||!b[d].defaultHandler)&&c.push(d);return c},getBottomIndex:function(a){return!this._clientDiv?0:this._getBottomIndex(a)},getBottomPixel:function(){return!this._clientDiv?0:this._getScroll().y+this._getClientHeight()},getCaretOffset:function(){return this._getSelection().getCaret()},getClientArea:function(){if(!this._clientDiv)return{x:0,y:0,width:0,height:0};var a=this._getScroll();return{x:a.x,y:a.y,width:this._getClientWidth(),
height:this._getClientHeight()}},getHorizontalPixel:function(){return!this._clientDiv?0:this._getScroll().x},getKeyBindings:function(a){for(var c=[],b=this._keyModes,d=0;d<b.length;d++)c=c.concat(b[d].getKeyBindings(a));return c},getKeyModes:function(){return this._keyModes.slice(0)},getLineHeight:function(a){return!this._clientDiv?0:this._getLineHeight(a)},getLineIndex:function(a){return!this._clientDiv?0:this._getLineIndex(a)},getLinePixel:function(a){return!this._clientDiv?0:this._getLinePixel(a)},
getLocationAtOffset:function(a){if(!this._clientDiv)return{x:0,y:0};var c=this._model,a=Math.min(Math.max(0,a),c.getCharCount()),c=c.getLineAtOffset(a),b=this._getLine(c),a=b.getBoundingClientRect(a);b.destroy();b=a.left;c=this._getLinePixel(c)+a.top;return{x:b,y:c}},getNextOffset:function(a,c){var b=new u(a,a,!1);this._doMove(c,b);return b.getCaret()},getOptions:function(){var a;if(0===arguments.length)a=this._defaultOptions();else if(1===arguments.length){if(a=arguments[0],"string"===typeof a)return h(this["_"+
a])}else{a={};for(var c in arguments)arguments.hasOwnProperty(c)&&(a[arguments[c]]=void 0)}for(var b in a)a.hasOwnProperty(b)&&(a[b]=h(this["_"+b]));return a},getModel:function(){return this._model},getOffsetAtLocation:function(a,c){if(!this._clientDiv)return 0;var b=this._getLineIndex(c),d=this._getLine(b),b=d.getOffset(a,c-this._getLinePixel(b));d.destroy();return b},getLineAtOffset:function(a){this.getModel().getLineAtOffset(a)},getLineStart:function(a){this.getModel().getLineStart(a)},getRulers:function(){return this._rulers.slice(0)},
getSelection:function(){var a=this._getSelection();return{start:a.start,end:a.end}},getText:function(a,c){return this._model.getText(a,c)},getTopIndex:function(a){return!this._clientDiv?0:this._getTopIndex(a)},getTopPixel:function(){return!this._clientDiv?0:this._getScroll().y},invokeAction:function(a,c,b){if(this._clientDiv){if(a=this._actions[a]){if(!c&&a.handler&&a.handler(b))return!0;if(a.defaultHandler)return"boolean"===typeof a.defaultHandler(b)}return!1}},isDestroyed:function(){return!this._clientDiv},
onContextMenu:function(a){return this.dispatchEvent(a)},onDragStart:function(a){return this.dispatchEvent(a)},onDrag:function(a){return this.dispatchEvent(a)},onDragEnd:function(a){return this.dispatchEvent(a)},onDragEnter:function(a){return this.dispatchEvent(a)},onDragOver:function(a){return this.dispatchEvent(a)},onDragLeave:function(a){return this.dispatchEvent(a)},onDrop:function(a){return this.dispatchEvent(a)},onDestroy:function(a){return this.dispatchEvent(a)},onLineStyle:function(a){return this.dispatchEvent(a)},
onKeyDown:function(a){return this.dispatchEvent(a)},onKeyPress:function(a){return this.dispatchEvent(a)},onKeyUp:function(a){return this.dispatchEvent(a)},onModelChanged:function(a){return this.dispatchEvent(a)},onModelChanging:function(a){return this.dispatchEvent(a)},onModify:function(a){return this.dispatchEvent(a)},onMouseDown:function(a){return this.dispatchEvent(a)},onMouseUp:function(a){return this.dispatchEvent(a)},onMouseMove:function(a){return this.dispatchEvent(a)},onMouseOver:function(a){return this.dispatchEvent(a)},
onMouseOut:function(a){return this.dispatchEvent(a)},onSelection:function(a){return this.dispatchEvent(a)},onScroll:function(a){return this.dispatchEvent(a)},onVerify:function(a){return this.dispatchEvent(a)},onFocus:function(a){return this.dispatchEvent(a)},onBlur:function(a){return this.dispatchEvent(a)},redraw:function(){if(!(0<this._redrawCount)){var a=this._model.getLineCount();this.redrawRulers(0,a);this.redrawLines(0,a)}},redrawRulers:function(a,c){if(!(0<this._redrawCount))for(var b=this.getRulers(),
d=0;d<b.length;d++)this.redrawLines(a,c,b[d])},redrawLines:function(a,c,b){if(!(0<this._redrawCount)&&(void 0===a&&(a=0),void 0===c&&(c=this._model.getLineCount()),a!==c)){var d=this._clientDiv;if(d){if(b)for(d=this._getRulerParent(b).firstChild;d&&d._ruler!==b;)d=d.nextSibling;b?d.rulerChanged=!0:this._lineHeight&&this._resetLineHeight(a,c);if(!b||"page"===b.getOverview())for(d=d.firstChild;d;){var k=d.lineIndex;a<=k&&k<c&&(d.lineChanged=!0);d=d.nextSibling}!b&&(!this._wrapMode&&a<=this._maxLineIndex&&
this._maxLineIndex<c)&&(this._checkMaxLineIndex=this._maxLineIndex,this._maxLineIndex=-1,this._maxLineWidth=0);this._queueUpdate()}}},redrawRange:function(a,c){if(!(0<this._redrawCount)){var b=this._model;void 0===a&&(a=0);void 0===c&&(c=b.getCharCount());var d=b.getLineAtOffset(a),b=b.getLineAtOffset(Math.max(a,c-1))+1;this.redrawLines(d,b)}},removeKeyMode:function(a){for(var c=this._keyModes,b=0;b<c.length;b++)if(c[b]===a){c.splice(b,1);break}a._modeRemoved&&a._modeRemoved()},removeRuler:function(a){for(var c=
this._rulers,b=0;b<c.length;b++)if(c[b]===a){c.splice(b,1);a.setView(null);this._destroyRuler(a);this._update();break}},resize:function(){this._clientDiv&&this._handleResize(null)},setAction:function(a,c,b){if(a){var d=this._actions,k=d[a];k||(k=d[a]={});k.handler=c;void 0!==b&&(k.actionDescription=b)}},setKeyBinding:function(a,c){this._keyModes[0].setKeyBinding(a,c)},setCaretOffset:function(a,c,b){var d=this._model.getCharCount(),a=Math.max(0,Math.min(a,d)),a=new u(a,a,!1);this._setSelection(a,void 0===
c||c,!0,b)},setHorizontalPixel:function(a){this._clientDiv&&(a=Math.max(0,a),this._scrollView(a-this._getScroll().x,0))},setRedraw:function(a){a?0===--this._redrawCount&&this.redraw():this._redrawCount++},setModel:function(a){if(a&&a!==this._model){this._model.removeEventListener("preChanging",this._modelListener.onChanging);this._model.removeEventListener("postChanged",this._modelListener.onChanged);var c=this._model.getLineCount(),b=this._model.getCharCount(),d=a.getLineCount(),k=a.getCharCount(),
e={type:"ModelChanging",text:a.getText(),start:0,removedCharCount:b,addedCharCount:k,removedLineCount:c,addedLineCount:d};this.onModelChanging(e);this._model=a;e={type:"ModelChanged",start:0,removedCharCount:b,addedCharCount:k,removedLineCount:c,addedLineCount:d};this.onModelChanged(e);this._model.addEventListener("preChanging",this._modelListener.onChanging);this._model.addEventListener("postChanged",this._modelListener.onChanged);this._reset();this._update()}},setOptions:function(c){var b=this._defaultOptions(),
d;for(d in c)if(c.hasOwnProperty(d)){var k=c[d];if(!a(this["_"+d],k)){var e=b[d]?b[d].update:null;e?e.call(this,k):this["_"+d]=h(k)}}},setSelection:function(a,c,b,d){var k=a>c;if(k)var e=a,a=c,c=e;e=this._model.getCharCount();a=Math.max(0,Math.min(a,e));c=Math.max(0,Math.min(c,e));a=new u(a,c,k);this._setSelection(a,void 0===b||b,!0,d)},setText:function(a,c,b){var d=void 0===c&&void 0===b;void 0===c&&(c=0);void 0===b&&(b=this._model.getCharCount());d&&(this._variableLineHeight=!1);this._modifyContent({text:a,
start:c,end:b,_code:!0},!d);d&&(this._columnX=-1,this._setSelection(new u(0,0,!1),!0),e.isFirefox&&this._fixCaret())},setTopIndex:function(a){this._clientDiv&&this._scrollView(0,this._getLinePixel(Math.max(0,a))-this._getScroll().y)},setTopPixel:function(a){this._clientDiv&&this._scrollView(0,Math.max(0,a)-this._getScroll().y)},showSelection:function(){return this._showCaret(!0)},update:function(a,c){this._clientDiv&&(a&&this._updateStyle(),void 0===c||c?this._update():this._queueUpdate())},_handleRootMouseDown:function(a){if(!this._ignoreEvent(a)){e.isFirefox&&
1===a.which&&(this._clientDiv.contentEditable=!1,this._ignoreBlur=(this._overlayDiv||this._clientDiv).draggable=!0);var c=this._overlayDiv||this._clientDiv;9>e.isIE&&(c=this._viewDiv);for(var b=a.target?a.target:a.srcElement;b;){if(c===b)return;b=b.parentNode}a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();if(!this._isW3CEvents){var d=this;this._getWindow().setTimeout(function(){d._clientDiv.focus()},0)}}},_handleRootMouseUp:function(a){!this._ignoreEvent(a)&&(e.isFirefox&&
1===a.which)&&(this._clientDiv.contentEditable=!0,(this._overlayDiv||this._clientDiv).draggable=!1,this._fixCaret(),this._ignoreBlur=!1)},_handleBlur:function(){if(!this._ignoreBlur){this._hasFocus=!1;if(9>e.isIE&&!this._getSelection().isEmpty()){var a=this._rootDiv,c=e.createElement(a.ownerDocument,"div");a.appendChild(c);a.removeChild(c)}this._cursorDiv&&(this._cursorDiv.style.display="none");if(this._selDiv1)if(this._selDiv1.style.background="lightgray",this._selDiv2.style.background="lightgray",
this._selDiv3.style.background="lightgray",a=this._getWindow(),c=this._selDiv1.ownerDocument,a.getSelection){c=a.getSelection();for(a=c.anchorNode;a;){if(a===this._clientDiv){0<c.rangeCount&&c.removeAllRanges();break}a=a.parentNode}}else if(c.selection){this._ignoreSelect=!1;for(a=c.selection.createRange().parentElement();a;){if(a===this._clientDiv){c.selection.empty();break}a=a.parentNode}this._ignoreSelect=!0}if(!this._ignoreFocus)this.onBlur({type:"Blur"})}},_handleContextMenu:function(a){if(!this._ignoreEvent(a)){e.isIE&&
3===this._lastMouseButton&&this._updateDOMSelection();var c=!1;this.isListening("ContextMenu")?(c=this._createMouseEvent("ContextMenu",a),c.screenX=a.screenX,c.screenY=a.screenY,this.onContextMenu(c),c=c.defaultPrevented):e.isMac&&(e.isFirefox&&0===a.button)&&(c=!0);if(c)return a.preventDefault&&a.preventDefault(),!1}},_handleCopy:function(a){if(!this._ignoreEvent(a)&&!this._ignoreCopy&&this._doCopy(a))return a.preventDefault&&a.preventDefault(),!1},_handleCut:function(a){if(!this._ignoreEvent(a)&&
this._doCut(a))return a.preventDefault&&a.preventDefault(),!1},_handleDataModified:function(a){this._ignoreEvent(a)||this._startIME()},_handleDblclick:function(a){this._ignoreEvent(a)||(this._lastMouseTime=a.timeStamp?a.timeStamp:(new Date).getTime(),2!==this._clickCount&&(this._clickCount=2,this._handleMouse(a)))},_handleDragStart:function(a){if(!this._ignoreEvent(a)){if(e.isFirefox){var c=this;this._getWindow().setTimeout(function(){c._clientDiv.contentEditable=!0;c._clientDiv.draggable=!1;c._ignoreBlur=
!1},0)}if(this.isListening("DragStart")&&-1!==this._dragOffset)this._isMouseDown=!1,this.onDragStart(this._createMouseEvent("DragStart",a)),this._dragOffset=-1;else return a.preventDefault&&a.preventDefault(),!1}},_handleDrag:function(a){if(!this._ignoreEvent(a)&&this.isListening("Drag"))this.onDrag(this._createMouseEvent("Drag",a))},_handleDragEnd:function(a){if(!this._ignoreEvent(a)){this._dropTarget=!1;this._dragOffset=-1;if(this.isListening("DragEnd"))this.onDragEnd(this._createMouseEvent("DragEnd",
a));e.isFirefox&&(this._fixCaret(),"none"===a.dataTransfer.dropEffect&&!a.dataTransfer.mozUserCancelled&&this._fixCaret())}},_handleDragEnter:function(a){if(!this._ignoreEvent(a)){var c=!0;this._dropTarget=!0;this.isListening("DragEnter")&&(c=!1,this.onDragEnter(this._createMouseEvent("DragEnter",a)));if(e.isWebkit||c)return a.preventDefault&&a.preventDefault(),!1}},_handleDragOver:function(a){if(!this._ignoreEvent(a)){var c=!0;this.isListening("DragOver")&&(c=!1,this.onDragOver(this._createMouseEvent("DragOver",
a)));if(e.isWebkit||c)return c&&(a.dataTransfer.dropEffect="none"),a.preventDefault&&a.preventDefault(),!1}},_handleDragLeave:function(a){if(!this._ignoreEvent(a)&&(this._dropTarget=!1,this.isListening("DragLeave")))this.onDragLeave(this._createMouseEvent("DragLeave",a))},_handleDrop:function(a){if(!this._ignoreEvent(a)){this._dropTarget=!1;if(this.isListening("Drop"))this.onDrop(this._createMouseEvent("Drop",a));a.preventDefault&&a.preventDefault();return!1}},_handleFocus:function(){this._hasFocus=
!0;e.isIOS&&void 0!==this._lastTouchOffset?(this.setCaretOffset(this._lastTouchOffset,!0),this._lastTouchOffset=void 0):this._updateDOMSelection();this._cursorDiv&&(this._cursorDiv.style.display="block");if(this._selDiv1){var a=this._highlightRGB;this._selDiv1.style.background=a;this._selDiv2.style.background=a;this._selDiv3.style.background=a}if(!this._ignoreFocus)this.onFocus({type:"Focus"})},_handleKeyDown:function(a){if(!this._ignoreEvent(a)){if(this.isListening("KeyDown")){var c=this._createKeyEvent("KeyDown",
a);this.onKeyDown(c);if(c.defaultPrevented){e.isFirefox&&(this._keyDownPrevented=!0);a.preventDefault();return}}c=!1;switch(a.keyCode){case 16:case 17:case 18:case 91:c=!0;break;default:this._setLinksVisible(!1)}if(229===a.keyCode){if(this._readonly)return a.preventDefault&&a.preventDefault(),!1;c=!0;e.isSafari&&e.isMac&&a.ctrlKey&&(c=!1,a.keyCode=129);c&&this._startIME()}else c||this._commitIME();if((e.isMac||e.isLinux)&&4>e.isFirefox||12.16>e.isOpera)return this._keyDownEvent=a,!0;if(this._doAction(a))return a.preventDefault?
(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!0,a.returnValue=!1,a.keyCode=0),!1}},_handleKeyPress:function(a){if(!this._ignoreEvent(a))if(this._keyDownPrevented)a.preventDefault&&(a.preventDefault(),a.stopPropagation()),this._keyDownPrevented=void 0;else{if(e.isMac&&e.isWebkit&&(63232<=a.keyCode&&63487>=a.keyCode||13===a.keyCode||8===a.keyCode)||((e.isMac||e.isLinux)&&4>e.isFirefox||12.16>e.isOpera)&&this._doAction(this._keyDownEvent))return a.preventDefault&&a.preventDefault(),!1;var c=
e.isMac?a.metaKey:a.ctrlKey;if(void 0!==a.charCode&&c)switch(a.charCode){case 99:case 118:case 120:return!0}if(this.isListening("KeyPress")&&(c=this._createKeyEvent("KeyPress",a),this.onKeyPress(c),c.defaultPrevented)){a.preventDefault();return}if(this._doAction(a))return a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!0,a.returnValue=!1,a.keyCode=0),!1;c=!1;if(e.isMac){if(a.ctrlKey||a.metaKey)c=!0}else if(e.isFirefox){if(a.ctrlKey||a.altKey)c=!0}else a.ctrlKey^a.altKey&&
(c=!0);if(!c&&(c=e.isOpera?a.which:void 0!==a.charCode?a.charCode:a.keyCode,31<c))return this._doContent(String.fromCharCode(c)),a.preventDefault&&a.preventDefault(),!1}},_handleDocKeyUp:function(a){(e.isMac?a.metaKey:a.ctrlKey)||this._setLinksVisible(!1)},_handleKeyUp:function(a){if(!this._ignoreEvent(a)){if(this.isListening("KeyUp")){var c=this._createKeyEvent("KeyUp",a);this.onKeyUp(c);if(c.defaultPrevented){a.preventDefault();return}}this._handleDocKeyUp(a);13===a.keyCode&&this._commitIME()}},
_handleLinkClick:function(a){if(!(e.isMac?a.metaKey:a.ctrlKey))return a.preventDefault&&a.preventDefault(),!1},_handleMouse:function(a){var c=this._getWindow(),b=!0,d=c;if(e.isIE||e.isFirefox&&!this._overlayDiv)d=this._clientDiv;if(this._overlayDiv){this._hasFocus&&(this._ignoreFocus=!0);var k=this;c.setTimeout(function(){k.focus();k._ignoreFocus=!1},0)}1===this._clickCount?(b=this._setSelectionTo(a.clientX,a.clientY,a.shiftKey,(!e.isOpera||12.16<=e.isOpera)&&this._hasFocus&&this.isListening("DragStart")))&&
this._setGrab(d):(this._isW3CEvents&&this._setGrab(d),this._doubleClickSelection=null,this._setSelectionTo(a.clientX,a.clientY,a.shiftKey),this._doubleClickSelection=this._getSelection());return b},_handleMouseDown:function(a){if(!this._ignoreEvent(a)){if(this._linksVisible)if("A"!==(a.target||a.srcElement).tagName)this._setLinksVisible(!1);else return;this._commitIME();var c=a.which;c||(4===a.button&&(c=2),2===a.button&&(c=3),1===a.button&&(c=1));var b=2!==c&&a.timeStamp?a.timeStamp:(new Date).getTime(),
d=b-this._lastMouseTime,k=Math.abs(this._lastMouseX-a.clientX),n=Math.abs(this._lastMouseY-a.clientY),h=this._lastMouseButton===c;this._lastMouseX=a.clientX;this._lastMouseY=a.clientY;this._lastMouseTime=b;this._lastMouseButton=c;1===c&&(this._isMouseDown=!0,h&&d<=this._clickTime&&k<=this._clickDist&&n<=this._clickDist?this._clickCount++:this._clickCount=1);if(this.isListening("MouseDown")&&(b=this._createMouseEvent("MouseDown",a),this.onMouseDown(b),b.defaultPrevented)){a.preventDefault();return}if(1===
c&&this._handleMouse(a)&&(9<=e.isIE||e.isOpera||e.isChrome||e.isSafari||e.isFirefox&&!this._overlayDiv))this._hasFocus||this.focus(),a.preventDefault();e.isFirefox&&3===this._lastMouseButton&&this._updateDOMSelection()}},_handleMouseOver:function(a){if(!this._ignoreEvent(a)&&!this._animation&&this.isListening("MouseOver"))this.onMouseOver(this._createMouseEvent("MouseOver",a))},_handleMouseOut:function(a){if(!this._ignoreEvent(a)&&!this._animation&&this.isListening("MouseOut"))this.onMouseOut(this._createMouseEvent("MouseOut",
a))},_handleMouseMove:function(a){if(!this._animation){var c=this._isClientDiv(a);if(this.isListening("MouseMove")&&c)this.onMouseMove(this._createMouseEvent("MouseMove",a));if(!this._dropTarget){var b=this._linksVisible||this._lastMouseMoveX!==a.clientX||this._lastMouseMoveY!==a.clientY;this._lastMouseMoveX=a.clientX;this._lastMouseMoveY=a.clientY;this._setLinksVisible(b&&!this._isMouseDown&&(e.isMac?a.metaKey:a.ctrlKey));if(!this._isW3CEvents){if(0===a.button)return this._setGrab(null),!0;if(!this._isMouseDown&&
1===a.button&&0!==(this._clickCount&1)&&c)return this._clickCount=2,this._handleMouse(a,this._clickCount)}if(this._isMouseDown&&-1===this._dragOffset){var c=a.clientX,a=a.clientY,d=this._getViewPadding(),k=this._viewDiv.getBoundingClientRect(),n=this._getClientWidth(),h=this._getClientHeight(),b=k.left+d.left,p=k.top+d.top,n=k.left+d.left+n,d=k.top+d.top+h;a<p?this._doAutoScroll("up",c,a-p):a>d?this._doAutoScroll("down",c,a-d):c<b&&!this._wrapMode?this._doAutoScroll("left",c-b,a):c>n&&!this._wrapMode?
this._doAutoScroll("right",c-n,a):(this._endAutoScroll(),this._setSelectionTo(c,a,!0))}}}},_isClientDiv:function(a){for(var c=this._overlayDiv||this._clientDiv,a=a.target?a.target:a.srcElement;a;){if(c===a)return!0;a=a.parentNode}return!1},_createKeyEvent:function(a,c){return{type:a,event:c,preventDefault:function(){this.defaultPrevented=!0}}},_createMouseEvent:function(a,c){var b=this.convert({x:c.clientX,y:c.clientY},"page","document");return{type:a,event:c,clickCount:this._clickCount,x:b.x,y:b.y,
preventDefault:function(){this.defaultPrevented=!0}}},_handleMouseUp:function(a){var c=a.which?0===a.button:1===a.button;if(this.isListening("MouseUp")&&(this._isClientDiv(a)||c&&this._isMouseDown))this.onMouseUp(this._createMouseEvent("MouseUp",a));!this._linksVisible&&(c&&this._isMouseDown)&&(-1!==this._dragOffset&&(c=this._getSelection(),c.extend(this._dragOffset),c.collapse(),this._setSelection(c,!0,!0),this._dragOffset=-1),this._isMouseDown=!1,this._endAutoScroll(),this._isW3CEvents&&this._setGrab(null),
e.isFirefox&&a.preventDefault())},_handleMouseWheel:function(a){var c=this._getLineHeight(),b=0,d=0;e.isIE||e.isOpera?d=-a.wheelDelta/40*c:e.isFirefox?(c=e.isMac?3*a.detail:Math.max(-256,Math.min(256,a.detail))*c,a.axis===a.HORIZONTAL_AXIS?b=c:d=c):e.isMac?(d=a.timeStamp-this._wheelTimeStamp,this._wheelTimeStamp=a.timeStamp,b=0!==a.wheelDeltaX%120?1:40>d?40/(40-d):40,d=0!==a.wheelDeltaY%120?1:40>d?40/(40-d):40,b=Math.ceil(-a.wheelDeltaX/b),-1<b&&0>b&&(b=-1),0<b&&1>b&&(b=1),d=Math.ceil(-a.wheelDeltaY/
d),-1<d&&0>d&&(d=-1),0<d&&1>d&&(d=1)):(b=-a.wheelDeltaX,d=8*(-a.wheelDeltaY/120)*c);if(e.isSafari){for(c=a.target;c&&void 0===c.lineIndex;)c=c.parentNode;this._mouseWheelLine=c}c=this._getScroll();this._scrollView(b,d);b=this._getScroll();if(c.x!==b.x||c.y!==b.y)return a.preventDefault&&a.preventDefault(),!1},_handlePaste:function(a){if(!this._ignoreEvent(a)&&!this._ignorePaste&&this._doPaste(a)){if(e.isIE){var c=this;this._ignoreFocus=!0;this._getWindow().setTimeout(function(){c._updateDOMSelection();
c._ignoreFocus=!1},0)}a.preventDefault&&a.preventDefault();return!1}},_handleResize:function(){var c=this._rootDiv.clientWidth,b=this._rootDiv.clientHeight;if(this._rootWidth!==c||this._rootHeight!==b)this._rootWidth!==c&&this._wrapMode&&this._resetLineHeight(),this._rootWidth=c,this._rootHeight=b,c=9>e.isIE,b=this._calculateMetrics(),a(b,this._metrics)||(this._variableLineHeight&&(this._variableLineHeight=!1,this._resetLineHeight()),this._metrics=b,c=!0),c?this._queueUpdate():this._update()},_handleRulerEvent:function(a){for(var c=
a.target?a.target:a.srcElement,b=c.lineIndex;c&&!c._ruler;)void 0===b&&void 0!==c.lineIndex&&(b=c.lineIndex),c=c.parentNode;var d=c?c._ruler:null;if(void 0===b&&d&&"document"===d.getOverview()){var b=this._getClientHeight(),k=this._model.getLineCount(),e=this._getViewPadding(),n=this._viewDiv.getBoundingClientRect(),b=Math.floor((a.clientY-n.top-this._metrics.scrollWidth)*k/(b+e.top+e.bottom-2*this._metrics.scrollWidth));0<=b&&b<k||(b=void 0)}if(d)switch(a.type){case "click":if(d.onClick)d.onClick(b,
a);break;case "dblclick":if(d.onDblClick)d.onDblClick(b,a);break;case "mousemove":if(d.onMouseMove)d.onMouseMove(b,a);break;case "mouseover":if(d.onMouseOver)d.onMouseOver(b,a);break;case "mouseout":if(d.onMouseOut){for(k=a.relatedTarget;k&&k!==this._rootDiv;){if(k===c)return;k=k.parentNode}d.onMouseOut(b,a)}}},_handleScroll:function(){var a=this._getScroll(!1),c=this._hScroll,b=this._vScroll;if(c!==a.x||b!==a.y)this._hScroll=a.x,this._vScroll=a.y,this._commitIME(),this._update(b===a.y),this.onScroll({type:"Scroll",
oldValue:{x:c,y:b},newValue:a})},_handleSelectStart:function(a){if(this._ignoreSelect)return a&&a.preventDefault&&a.preventDefault(),!1},_getModelOffset:function(a,c){if(a){var b;b="DIV"===a.tagName?a:a.parentNode.parentNode;var d=0,k=b.lineIndex;if("DIV"!==a.tagName)for(b=b.firstChild;b;){var e=b.firstChild;if(e===a){b.ignoreChars&&(d-=b.ignoreChars);d+=c;break}b.ignoreChars&&(d-=b.ignoreChars);d+=e.data.length;b=b.nextSibling}return Math.max(0,d)+this._model.getLineStart(k)}},_updateSelectionFromDOM:function(){var a=
this._getWindow().getSelection(),c=this._getModelOffset(a.anchorNode,a.anchorOffset),a=this._getModelOffset(a.focusNode,a.focusOffset);void 0===c||void 0===a||this._setSelection(new u(c,a),!1,!1)},_handleSelectionChange:function(){if(-1===this._imeOffset)if(e.isAndroid){var a=this._getWindow();this._selTimer&&a.clearTimeout(this._selTimer);var c=this;this._selTimer=a.setTimeout(function(){c._clientDiv&&(c._selTimer=null,c._updateSelectionFromDOM())},250)}else this._updateSelectionFromDOM()},_handleTextInput:function(a){if(!this._ignoreEvent(a)){this._imeOffset=
-1;var c=this._getWindow().getSelection();if(c.anchorNode!==this._anchorNode||c.focusNode!==this._focusNode||c.anchorOffset!==this._anchorOffset||c.focusOffset!==this._focusOffset){for(var b=c.anchorNode;b&&void 0===b.lineIndex;)b=b.parentNode;if(b){var d=this._model,k=b.lineIndex,e=d.getLine(k),n=e,h=0,d=d.getLineStart(k);0<c.rangeCount&&(c.getRangeAt(0).deleteContents(),k=b.ownerDocument.createTextNode(a.data),c.getRangeAt(0).insertNode(k),h=this._getDOMText(b,k),n=h.text,h=h.offset,k.parentNode.removeChild(k));
b.lineRemoved=!0;for(b=0;e.charCodeAt(b)===n.charCodeAt(b)&&b<h;)b++;c=e.length-1;for(k=n.length-e.length;e.charCodeAt(c)===n.charCodeAt(c+k)&&c+k>=h+a.data.length;)c--;c++;e=n.substring(b,c+k);this._modifyContent({text:e,start:b+d,end:c+d,_ignoreDOMSelection:!0},!0)}}else this._doContent(a.data);a.preventDefault()}},_handleTouchStart:function(a){this._commitIME();var c=this._getWindow();this._touchScrollTimer&&(this._vScrollDiv.style.display="none",this._hScrollDiv.style.display="none",c.clearInterval(this._touchScrollTimer),
this._touchScrollTimer=null);var b=a.touches;if(1===b.length){var b=b[0],d=b.clientX,k=b.clientY;this._touchStartX=d;this._touchStartY=k;if(e.isAndroid&&(k<b.pageY-c.pageYOffset||d<b.pageX-c.pageXOffset))d=b.pageX-c.pageXOffset,k=b.pageY-c.pageYOffset;c=this.convert({x:d,y:k},"page","document");this._lastTouchOffset=this.getOffsetAtLocation(c.x,c.y);this._touchStartTime=a.timeStamp;this._touching=!0}},_handleTouchMove:function(a){var c=a.touches;if(1===c.length){c=c[0];this._touchCurrentX=c.clientX;
this._touchCurrentY=c.clientY;if(!this._touchScrollTimer&&200>a.timeStamp-this._touchStartTime){this._vScrollDiv.style.display="block";this._wrapMode||(this._hScrollDiv.style.display="block");var b=this,d=this._getWindow();this._touchScrollTimer=d.setInterval(function(){var a=0,c=0;if(b._touching)a=b._touchStartX-b._touchCurrentX,c=b._touchStartY-b._touchCurrentY,b._touchSpeedX=a/10,b._touchSpeedY=c/10,b._touchStartX=b._touchCurrentX,b._touchStartY=b._touchCurrentY;else{if(0.1>Math.abs(b._touchSpeedX)&&
0.1>Math.abs(b._touchSpeedY)){b._vScrollDiv.style.display="none";b._hScrollDiv.style.display="none";d.clearInterval(b._touchScrollTimer);b._touchScrollTimer=null;return}a=10*b._touchSpeedX;c=10*b._touchSpeedY;b._touchSpeedX*=0.95;b._touchSpeedY*=0.95}b._scrollView(a,c)},10)}this._touchScrollTimer&&a.preventDefault()}},_handleTouchEnd:function(a){0===a.touches.length&&(this._touching=!1)},_doAction:function(a){var c,b,d=this._keyModes;for(b=d.length-1;0<=b;b--)if(c=d[b],"function"===typeof c.match&&
(c=c.match(a),void 0!==c))return this.invokeAction(c);return!1},_doMove:function(a,c){var b=this._model,d=c.getCaret(),k=b.getLineAtOffset(d);a.count||(a.count=1);for(;0!==a.count;){var e=b.getLineStart(k);if(0>a.count&&d===e)if(0<k)"character"===a.unit&&a.count++,k--,c.extend(b.getLineEnd(k));else break;else if(0<a.count&&d===b.getLineEnd(k))if(k+1<b.getLineCount())"character"===a.unit&&a.count--,k++,c.extend(b.getLineStart(k));else break;else{var n=!1;a.expandTab&&("character"===a.unit&&0===(d-
e)%this._tabSize)&&(e=b.getText(e,d),n=!/[^ ]/.test(e));n?(c.extend(d-this._tabSize),a.count+=0>a.count?1:-1):(e=this._getLine(k),c.extend(e.getNextOffset(d,a)),e.destroy())}d=c.getCaret()}return c},_doBackspace:function(a){var c=this._getSelection();c.isEmpty()&&(a.count||(a.count=1),a.count*=-1,a.expandTab=this._expandTab,this._doMove(a,c));this._modifyContent({text:"",start:c.start,end:c.end},!0);return!0},_doCase:function(a){var c=this._getSelection();this._doMove(a,c);var b=this.getText(c.start,
c.end);this._setSelection(c,!0);switch(a.type){case "lower":b=b.toLowerCase();break;case "capitalize":b=b.replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()});break;case "reverse":a="";for(c=0;c<b.length;c++)var d=b[c],k=d.toLowerCase(),d=k!==d?k:d.toUpperCase(),a=a+d;b=a;break;default:b=b.toUpperCase()}this._doContent(b);return!0},_doContent:function(a){var c=this._getSelection();if(this._overwriteMode&&c.isEmpty()){var b=this._model,d=b.getLineAtOffset(c.end);c.end<b.getLineEnd(d)&&(b=this._getLine(d),
c.extend(b.getNextOffset(c.getCaret(),{unit:"character",count:1})),b.destroy())}this._modifyContent({text:a,start:c.start,end:c.end,_ignoreDOMSelection:!0},!0)},_doCopy:function(a){var c=this._getSelection();return!c.isEmpty()?(c=this._getBaseText(c.start,c.end),this._setClipboardText(c,a)):!0},_doCursorNext:function(a){var c=this._getSelection();!c.isEmpty()&&!a.select?c.start=c.end:this._doMove(a,c);a.select||c.collapse();this._setSelection(c,!0);return!0},_doCursorPrevious:function(a){var c=this._getSelection();
!c.isEmpty()&&!a.select?c.end=c.start:(a.count||(a.count=1),a.count*=-1,this._doMove(a,c));a.select||c.collapse();this._setSelection(c,!0);return!0},_doCut:function(a){var c=this._getSelection();return!c.isEmpty()?(c=this._getBaseText(c.start,c.end),this._doContent(""),this._setClipboardText(c,a)):!0},_doDelete:function(a){var c=this._getSelection();c.isEmpty()&&this._doMove(a,c);this._modifyContent({text:"",start:c.start,end:c.end},!0);return!0},_doEnd:function(a){var c=this._getSelection(),b=this._model,
d;if(a.ctrl)c.extend(b.getCharCount()),d=function(){};else{var k=c.getCaret(),e=b.getLineAtOffset(k);if(this._wrapMode){var n=this._getLine(e),k=n.getLineIndex(k),k=k===n.getLineCount()-1?b.getLineEnd(e):n.getLineStart(k+1)-1;n.destroy()}else a.count&&0<a.count&&(e=Math.min(e+a.count-1,b.getLineCount()-1)),k=b.getLineEnd(e);c.extend(k)}a.select||c.collapse();this._setSelection(c,!0,!0,d);return!0},_doEnter:function(a){var c=this._model,b=this._getSelection();this._doContent(c.getLineDelimiter());
a&&a.noCursor&&(b.end=b.start,this._setSelection(b,!0));return!0},_doHome:function(a){var c=this._getSelection(),b=this._model,d;if(a.ctrl)c.extend(0),d=function(){};else{var k=c.getCaret(),e=b.getLineAtOffset(k);this._wrapMode?(b=this._getLine(e),k=b.getLineIndex(k),k=b.getLineStart(k),b.destroy()):k=b.getLineStart(e);c.extend(k)}a.select||c.collapse();this._setSelection(c,!0,!0,d);return!0},_doLineDown:function(a){var c=this._model,b=this._getSelection(),d=b.getCaret(),k=c.getLineAtOffset(d),n=
this._getLine(k),h=this._columnX,p=1,g=!1;if(-1===h||a.wholeLine||a.select&&e.isIE)h=a.wholeLine?c.getLineEnd(k+1):d,h=n.getBoundingClientRect(h).left;(d=n.getLineIndex(d))<n.getLineCount()-1?p=n.getClientRects(d+1).top+1:(d=c.getLineCount()-1,g=k===d,a.count&&0<a.count?k=Math.min(k+a.count,d):k++);d=!1;if(g){if(a.select||e.isMac||e.isLinux)b.extend(c.getCharCount()),d=!0}else n.lineIndex!==k&&(n.destroy(),n=this._getLine(k)),b.extend(n.getOffset(h,p)),d=!0;d&&(a.select||b.collapse(),this._setSelection(b,
!0,!0));this._columnX=h;n.destroy();return!0},_doLineUp:function(a){var c=this._model,b=this._getSelection(),d=b.getCaret(),k=c.getLineAtOffset(d),n=this._getLine(k),h=this._columnX,p=!1,g;if(-1===h||a.wholeLine||a.select&&e.isIE)h=a.wholeLine?c.getLineStart(k-1):d,h=n.getBoundingClientRect(h).left;0<(d=n.getLineIndex(d))?g=n.getClientRects(d-1).top+1:(p=0===k,p||(a.count&&0<a.count?k=Math.max(k-a.count,0):k--,g=this._getLineHeight(k)-1));d=!1;if(p){if(a.select||e.isMac||e.isLinux)b.extend(0),d=!0}else n.lineIndex!==
k&&(n.destroy(),n=this._getLine(k)),b.extend(n.getOffset(h,g)),d=!0;d&&(a.select||b.collapse(),this._setSelection(b,!0,!0));this._columnX=h;n.destroy();return!0},_doNoop:function(){return!0},_doPageDown:function(a){var c=this,b=this._model,d=this._getSelection(),k=d.getCaret(),n=b.getLineAtOffset(k),h=b.getLineCount(),p=this._getScroll(),b=this._getClientHeight(),g,f;if(this._lineHeight){g=this._columnX;p=this._getBoundsAtOffset(k);if(-1===g||a.select&&e.isIE)g=p.left;k=this._getLineIndex(p.top+b);
f=this._getLine(k);n=this._getLinePixel(k);k=f.getOffset(g,p.top+b-n);b=f.getBoundingClientRect(k);f.destroy();d.extend(k);a.select||d.collapse();this._setSelection(d,!0,!0,function(){c._columnX=g},b.top+n-p.top);return!0}if(n<h-1){var l=this._getLineHeight(),s=Math.min(h-n-1,Math.floor(b/l)),s=Math.max(1,s);g=this._columnX;if(-1===g||a.select&&e.isIE)f=this._getLine(n),g=f.getBoundingClientRect(k).left,f.destroy();f=this._getLine(n+s);d.extend(f.getOffset(g,0));f.destroy();a.select||d.collapse();
a=h*l;k=p.y+s*l;k+b>a&&(k=a-b);this._setSelection(d,!0,!0,function(){c._columnX=g},k-p.y)}return!0},_doPageUp:function(a){var c=this,b=this._model,d=this._getSelection(),k=d.getCaret(),n=b.getLineAtOffset(k),h=this._getScroll(),p=this._getClientHeight(),g;if(this._lineHeight){g=this._columnX;h=this._getBoundsAtOffset(k);if(-1===g||a.select&&e.isIE)g=h.left;k=this._getLineIndex(h.bottom-p);b=this._getLine(k);n=this._getLinePixel(k);k=b.getOffset(g,h.bottom-p-n);p=b.getBoundingClientRect(k);b.destroy();
d.extend(k);a.select||d.collapse();this._setSelection(d,!0,!0,function(){c._columnX=g},p.top+n-h.top);return!0}if(0<n){var f=this._getLineHeight(),p=Math.max(1,Math.min(n,Math.floor(p/f)));g=this._columnX;if(-1===g||a.select&&e.isIE)b=this._getLine(n),g=b.getBoundingClientRect(k).left,b.destroy();b=this._getLine(n-p);d.extend(b.getOffset(g,this._getLineHeight(n-p)-1));b.destroy();a.select||d.collapse();a=Math.max(0,h.y-p*f);this._setSelection(d,!0,!0,function(){c._columnX=g},a-h.y)}return!0},_doPaste:function(a){var c=
this;return null!==this._getClipboardText(a,function(a){a&&(e.isLinux&&2===c._lastMouseButton&&(new Date).getTime()-c._lastMouseTime<=c._clickTime&&c._setSelectionTo(c._lastMouseX,c._lastMouseY),c._doContent(a))})},_doScroll:function(a){var c=a.type,b=this._model,d=b.getLineCount(),a=this._getClientHeight(),k=this._getLineHeight(),d=d*k,e=this._getScroll().y,n;switch(c){case "textStart":n=0;break;case "textEnd":n=d-a;break;case "pageDown":n=e+a;break;case "pageUp":n=e-a;break;case "lineDown":n=e+
k;break;case "lineUp":n=e-k;break;case "centerLine":c=this._getSelection(),n=b.getLineAtOffset(c.start),b=(b.getLineAtOffset(c.end)-n+1)*k,n=n*k-a/2+b/2}void 0!==n&&(n=Math.min(Math.max(0,n),d-a),this._scrollViewAnimated(0,n-e,function(){}));return!0},_doSelectAll:function(){var a=this._model,c=this._getSelection();c.setCaret(0);c.extend(a.getCharCount());this._setSelection(c,!1);return!0},_doTab:function(){if(this._tabMode&&!this._readonly){var a="\t";if(this._expandTab)var c=this._model,a=this._getSelection().getCaret(),
b=c.getLineAtOffset(a),c=c.getLineStart(b),a=Array(this._tabSize-(a-c)%this._tabSize+1).join(" ");this._doContent(a);return!0}},_doShiftTab:function(){if(this._tabMode&&!this._readonly)return!0},_doOverwriteMode:function(){if(!this._readonly)return this.setOptions({overwriteMode:!this.getOptions("overwriteMode")}),!0},_doTabMode:function(){this._tabMode=!this._tabMode;return!0},_doWrapMode:function(){this.setOptions({wrapMode:!this.getOptions("wrapMode")});return!0},_autoScroll:function(){var a=this._model,
c=this._getSelection(),b=this.convert({x:this._autoScrollX,y:this._autoScrollY},"page","document"),d=c.getCaret(),k=a.getLineCount(),n=a.getLineAtOffset(d),h;if("up"===this._autoScrollDir||"down"===this._autoScrollDir)d=this._autoScrollY/this._getLineHeight(),d=0>d?Math.floor(d):Math.ceil(d),h=Math.max(0,Math.min(k-1,n+d));else if("left"===this._autoScrollDir||"right"===this._autoScrollDir)h=this._getLineIndex(b.y),n=this._getLine(n),b.x+=n.getBoundingClientRect(d,!1).left,n.destroy();0===h&&(e.isMac||
e.isLinux)?c.extend(0):h===k-1&&(e.isMac||e.isLinux)?c.extend(a.getCharCount()):(n=this._getLine(h),c.extend(n.getOffset(b.x,b.y-this._getLinePixel(h))),n.destroy());this._setSelection(c,!0)},_autoScrollTimer:function(){this._autoScroll();var a=this;this._autoScrollTimerID=this._getWindow().setTimeout(function(){a._autoScrollTimer()},this._AUTO_SCROLL_RATE)},_calculateLineHeightTimer:function(a){if(this._lineHeight&&!this._calculateLHTimer){var c=this._model.getLineCount(),b=0;if(a){for(var a=0,d=
(new Date).getTime(),k=0;b<c&&!(this._lineHeight[b]||(a++,k||(k=b),this._lineHeight[b]=this._calculateLineHeight(b)),b++,100<(new Date).getTime()-d););this.redrawRulers(0,c);this._queueUpdate()}a=this._getWindow();if(b!==c){var e=this;this._calculateLHTimer=a.setTimeout(function(){e._calculateLHTimer=null;e._calculateLineHeightTimer(!0)},0)}else this._calculateLHTimer&&(a.clearTimeout(this._calculateLHTimer),this._calculateLHTimer=void 0)}},_calculateLineHeight:function(a){var a=this._getLine(a),
c=a.getBoundingClientRect();a.destroy();return Math.max(1,c.bottom-c.top)},_calculateMetrics:function(){var a=this._clientDiv,c=a.ownerDocument,b=e.createElement(c,"div");b.style.lineHeight="normal";var k={type:"LineStyle",textView:this,"0":0,lineText:this._model.getLine(0),lineStart:0};this.onLineStyle(k);d(k.style,b);b.style.position="fixed";b.style.left="-1000px";var h=e.createElement(c,"span");h.appendChild(c.createTextNode(" "));b.appendChild(h);var g=e.createElement(c,"span");g.style.fontStyle=
"italic";g.appendChild(c.createTextNode(" "));b.appendChild(g);var f=e.createElement(c,"span");f.style.fontWeight="bold";f.appendChild(c.createTextNode(" "));b.appendChild(f);k=e.createElement(c,"span");k.style.fontWeight="bold";k.style.fontStyle="italic";k.appendChild(c.createTextNode(" "));b.appendChild(k);a.appendChild(b);var l=b.getBoundingClientRect(),h=h.getBoundingClientRect(),g=g.getBoundingClientRect(),f=f.getBoundingClientRect(),k=k.getBoundingClientRect(),h=h.bottom-h.top,g=g.bottom-g.top,
f=f.bottom-f.top,s=k.bottom-k.top,m=0,k=0>=l.bottom-l.top,l=Math.max(1,l.bottom-l.top);g>h&&(m=1);f>g&&(m=2);s>f&&(m=3);var w;0!==m&&(w={style:{}},0!==(m&1)&&(w.style.fontStyle="italic"),0!==(m&2)&&(w.style.fontWeight="bold"));h=p(b);a.removeChild(b);s=n(this._viewDiv);b=e.createElement(c,"div");b.style.position="fixed";b.style.left="-1000px";b.style.paddingLeft=s.left+"px";b.style.paddingTop=s.top+"px";b.style.paddingRight=s.right+"px";b.style.paddingBottom=s.bottom+"px";b.style.width="100px";b.style.height=
"100px";s=e.createElement(c,"div");s.style.width="100%";s.style.height="100%";b.appendChild(s);a.appendChild(b);m=b.getBoundingClientRect();g=s.getBoundingClientRect();f=0;this._singleMode||(b.style.overflow="hidden",s.style.height="200px",f=b.clientWidth,b.style.overflow="scroll",f-=b.clientWidth);a.removeChild(b);s={left:g.left-m.left,top:g.top-m.top,right:m.right-g.right,bottom:m.bottom-g.bottom};g=m=0;if(!k&&(this._wrapOffset||this._marginOffset))b=e.createElement(c,"div"),b.style.position="fixed",
b.style.left="-1000px",b.innerHTML=Array(this._wrapOffset+1).join(" "),a.appendChild(b),m=b.getBoundingClientRect(),m=Math.ceil(m.right-m.left),b.innerHTML=Array(this._marginOffset+1).join(" "),g=b.getBoundingClientRect(),g=Math.ceil(g.right-g.left),a.removeChild(b);return{lineHeight:l,largestFontStyle:w,lineTrim:h,viewPadding:s,scrollWidth:f,wrapWidth:m,marginWidth:g,invalid:k}},_cancelAnimation:function(){this._animation&&(this._animation.stop(),this._animation=null)},_clearSelection:function(a){var c=
this._getSelection();if(c.isEmpty())return!1;"next"===a?c.start=c.end:c.end=c.start;this._setSelection(c,!0);return!0},_commitIME:function(){if(-1!==this._imeOffset){this._scrollDiv.focus();this._clientDiv.focus();var a=this._model,c=a.getLineAtOffset(this._imeOffset),b=a.getLineStart(c),d=this._getDOMText(this._getLineNode(c)).text,a=a.getLine(c),b=this._imeOffset-b,a=b+d.length-a.length;b!==a&&(d=d.substring(b,a),this._doContent(d));this._imeOffset=-1}},_createActions:function(){this.addKeyMode(new q.DefaultKeyMode(this));
var a=this;this._actions={noop:{defaultHandler:function(){return a._doNoop()}},lineUp:{defaultHandler:function(b){return a._doLineUp(c(b,{select:!1}))},actionDescription:{name:f.lineUp}},lineDown:{defaultHandler:function(b){return a._doLineDown(c(b,{select:!1}))},actionDescription:{name:f.lineDown}},lineStart:{defaultHandler:function(b){return a._doHome(c(b,{select:!1,ctrl:!1}))},actionDescription:{name:f.lineStart}},lineEnd:{defaultHandler:function(b){return a._doEnd(c(b,{select:!1,ctrl:!1}))},actionDescription:{name:f.lineEnd}},
charPrevious:{defaultHandler:function(b){return a._doCursorPrevious(c(b,{select:!1,unit:"character"}))},actionDescription:{name:f.charPrevious}},charNext:{defaultHandler:function(b){return a._doCursorNext(c(b,{select:!1,unit:"character"}))},actionDescription:{name:f.charNext}},pageUp:{defaultHandler:function(b){return a._doPageUp(c(b,{select:!1}))},actionDescription:{name:f.pageUp}},pageDown:{defaultHandler:function(b){return a._doPageDown(c(b,{select:!1}))},actionDescription:{name:f.pageDown}},scrollPageUp:{defaultHandler:function(b){return a._doScroll(c(b,
{type:"pageUp"}))},actionDescription:{name:f.scrollPageUp}},scrollPageDown:{defaultHandler:function(b){return a._doScroll(c(b,{type:"pageDown"}))},actionDescription:{name:f.scrollPageDown}},scrollLineUp:{defaultHandler:function(b){return a._doScroll(c(b,{type:"lineUp"}))},actionDescription:{name:f.scrollLineUp}},scrollLineDown:{defaultHandler:function(b){return a._doScroll(c(b,{type:"lineDown"}))},actionDescription:{name:f.scrollLineDown}},wordPrevious:{defaultHandler:function(b){return a._doCursorPrevious(c(b,
{select:!1,unit:"word"}))},actionDescription:{name:f.wordPrevious}},wordNext:{defaultHandler:function(b){return a._doCursorNext(c(b,{select:!1,unit:"word"}))},actionDescription:{name:f.wordNext}},textStart:{defaultHandler:function(b){return a._doHome(c(b,{select:!1,ctrl:!0}))},actionDescription:{name:f.textStart}},textEnd:{defaultHandler:function(b){return a._doEnd(c(b,{select:!1,ctrl:!0}))},actionDescription:{name:f.textEnd}},scrollTextStart:{defaultHandler:function(b){return a._doScroll(c(b,{type:"textStart"}))},
actionDescription:{name:f.scrollTextStart}},scrollTextEnd:{defaultHandler:function(b){return a._doScroll(c(b,{type:"textEnd"}))},actionDescription:{name:f.scrollTextEnd}},centerLine:{defaultHandler:function(b){return a._doScroll(c(b,{type:"centerLine"}))},actionDescription:{name:f.centerLine}},selectLineUp:{defaultHandler:function(b){return a._doLineUp(c(b,{select:!0}))},actionDescription:{name:f.selectLineUp}},selectLineDown:{defaultHandler:function(b){return a._doLineDown(c(b,{select:!0}))},actionDescription:{name:f.selectLineDown}},
selectWholeLineUp:{defaultHandler:function(b){return a._doLineUp(c(b,{select:!0,wholeLine:!0}))},actionDescription:{name:f.selectWholeLineUp}},selectWholeLineDown:{defaultHandler:function(b){return a._doLineDown(c(b,{select:!0,wholeLine:!0}))},actionDescription:{name:f.selectWholeLineDown}},selectLineStart:{defaultHandler:function(b){return a._doHome(c(b,{select:!0,ctrl:!1}))},actionDescription:{name:f.selectLineStart}},selectLineEnd:{defaultHandler:function(b){return a._doEnd(c(b,{select:!0,ctrl:!1}))},
actionDescription:{name:f.selectLineEnd}},selectCharPrevious:{defaultHandler:function(b){return a._doCursorPrevious(c(b,{select:!0,unit:"character"}))},actionDescription:{name:f.selectCharPrevious}},selectCharNext:{defaultHandler:function(b){return a._doCursorNext(c(b,{select:!0,unit:"character"}))},actionDescription:{name:f.selectCharNext}},selectPageUp:{defaultHandler:function(b){return a._doPageUp(c(b,{select:!0}))},actionDescription:{name:f.selectPageUp}},selectPageDown:{defaultHandler:function(b){return a._doPageDown(c(b,
{select:!0}))},actionDescription:{name:f.selectPageDown}},selectWordPrevious:{defaultHandler:function(b){return a._doCursorPrevious(c(b,{select:!0,unit:"word"}))},actionDescription:{name:f.selectWordPrevious}},selectWordNext:{defaultHandler:function(b){return a._doCursorNext(c(b,{select:!0,unit:"word"}))},actionDescription:{name:f.selectWordNext}},selectTextStart:{defaultHandler:function(b){return a._doHome(c(b,{select:!0,ctrl:!0}))},actionDescription:{name:f.selectTextStart}},selectTextEnd:{defaultHandler:function(b){return a._doEnd(c(b,
{select:!0,ctrl:!0}))},actionDescription:{name:f.selectTextEnd}},deletePrevious:{defaultHandler:function(b){return a._doBackspace(c(b,{unit:"character"}))},actionDescription:{name:f.deletePrevious}},deleteNext:{defaultHandler:function(b){return a._doDelete(c(b,{unit:"character"}))},actionDescription:{name:f.deleteNext}},deleteWordPrevious:{defaultHandler:function(b){return a._doBackspace(c(b,{unit:"word"}))},actionDescription:{name:f.deleteWordPrevious}},deleteWordNext:{defaultHandler:function(b){return a._doDelete(c(b,
{unit:"word"}))},actionDescription:{name:f.deleteWordNext}},deleteLineStart:{defaultHandler:function(b){return a._doBackspace(c(b,{unit:"line"}))},actionDescription:{name:f.deleteLineStart}},deleteLineEnd:{defaultHandler:function(b){return a._doDelete(c(b,{unit:"line"}))},actionDescription:{name:f.deleteLineEnd}},tab:{defaultHandler:function(){return a._doTab()},actionDescription:{name:f.tab}},shiftTab:{defaultHandler:function(){return a._doShiftTab()},actionDescription:{name:f.shiftTab}},enter:{defaultHandler:function(){return a._doEnter()},
actionDescription:{name:f.enter}},enterNoCursor:{defaultHandler:function(b){return a._doEnter(c(b,{noCursor:!0}))},actionDescription:{name:f.enterNoCursor}},selectAll:{defaultHandler:function(){return a._doSelectAll()},actionDescription:{name:f.selectAll}},copy:{defaultHandler:function(){return a._doCopy()},actionDescription:{name:f.copy}},cut:{defaultHandler:function(){return a._doCut()},actionDescription:{name:f.cut}},paste:{defaultHandler:function(){return a._doPaste()},actionDescription:{name:f.paste}},
uppercase:{defaultHandler:function(b){return a._doCase(c(b,{type:"upper"}))},actionDescription:{name:f.uppercase}},lowercase:{defaultHandler:function(b){return a._doCase(c(b,{type:"lower"}))},actionDescription:{name:f.lowercase}},capitalize:{defaultHandler:function(b){return a._doCase(c(b,{unit:"word",type:"capitalize"}))},actionDescription:{name:f.capitalize}},reversecase:{defaultHandler:function(b){return a._doCase(c(b,{type:"reverse"}))},actionDescription:{name:f.reversecase}},toggleOverwriteMode:{defaultHandler:function(){return a._doOverwriteMode()},
actionDescription:{name:f.toggleOverwriteMode}},toggleTabMode:{defaultHandler:function(){return a._doTabMode()},actionDescription:{name:f.toggleTabMode}},toggleWrapMode:{defaultHandler:function(){return a._doWrapMode()},actionDescription:{name:f.toggleWrapMode}}}},_createRulerParent:function(a){var c=e.createElement(document,"div");c.className=a;c.tabIndex=-1;c.style.overflow="hidden";c.style.MozUserSelect="none";c.style.WebkitUserSelect="none";c.style.position="absolute";c.style.top="0px";c.style.bottom=
"0px";c.style.cursor="default";c.style.display="none";c.setAttribute("aria-hidden","true");this._rootDiv.appendChild(c);return c},_createRuler:function(a,c){if(this._clientDiv){var b=this._getRulerParent(a);if(b){if(b!==this._marginDiv||this._marginOffset)b.style.display="block";var d=e.createElement(b.ownerDocument,"div");d._ruler=a;d.rulerChanged=!0;d.style.position="relative";d.style.cssFloat="left";d.style.styleFloat="left";d.style.outline="none";if(void 0===c||0>c||c>=b.children.length)b.appendChild(d);
else{for(var k=b.firstChild;k&&0<c--;)k=k.nextSibling;b.insertBefore(d,k)}}}},_createView:function(){if(!this._clientDiv){for(var a=this._parent;a.hasChildNodes();)a.removeChild(a.lastChild);var c=a.ownerDocument,b=e.createElement(c,"div");this._rootDiv=b;b.tabIndex=-1;b.style.position="relative";b.style.overflow="hidden";b.style.width="100%";b.style.height="100%";b.style.overflow="hidden";b.style.WebkitTextSizeAdjust="100%";b.setAttribute("role","application");a.appendChild(b);this._leftDiv=this._createRulerParent("textviewLeftRuler");
a=e.createElement(c,"div");a.className="textviewScroll";this._viewDiv=a;a.tabIndex=-1;a.style.position="absolute";a.style.top="0px";a.style.bottom="0px";a.style.borderWidth="0px";a.style.margin="0px";a.style.outline="none";a.style.background="transparent";e.isMac&&e.isWebkit&&(a.style.pointerEvents="none",a.style.zIndex="2");b.appendChild(a);var d=this._createRulerParent("textviewRightRuler");this._rightDiv=d;d.style.right="0px";this._scrollDiv=d=e.createElement(c,"div");d.style.margin="0px";d.style.borderWidth=
"0px";d.style.padding="0px";a.appendChild(d);(this._marginDiv=this._createRulerParent("textviewMarginRuler")).style.zIndex="4";!e.isIE&&!e.isIOS&&(this._clipDiv=a=e.createElement(c,"div"),a.style.position="absolute",a.style.overflow="hidden",a.style.margin="0px",a.style.borderWidth="0px",a.style.padding="0px",a.style.background="transparent",b.appendChild(a),this._clipScrollDiv=d=e.createElement(c,"div"),d.style.position="absolute",d.style.height="1px",d.style.top="-1000px",d.style.background="transparent",
a.appendChild(d));this._setFullSelection(this._fullSelection,!0);a=e.createElement(c,"div");a.className="textviewContent";this._clientDiv=a;a.tabIndex=0;a.style.position="absolute";a.style.borderWidth="0px";a.style.margin="0px";a.style.padding="0px";a.style.outline="none";a.style.zIndex="1";a.style.WebkitUserSelect="text";a.setAttribute("spellcheck","false");if(e.isIOS||e.isAndroid)a.style.WebkitTapHighlightColor="transparent";(this._clipDiv||b).appendChild(a);if(e.isIOS||e.isAndroid)this._vScrollDiv=
d=e.createElement(c,"div"),d.style.position="absolute",d.style.borderWidth="1px",d.style.borderColor="white",d.style.borderStyle="solid",d.style.borderRadius="4px",d.style.backgroundColor="black",d.style.opacity="0.5",d.style.margin="0px",d.style.padding="0px",d.style.outline="none",d.style.zIndex="3",d.style.width="8px",d.style.display="none",b.appendChild(d),this._hScrollDiv=d=e.createElement(c,"div"),d.style.position="absolute",d.style.borderWidth="1px",d.style.borderColor="white",d.style.borderStyle=
"solid",d.style.borderRadius="4px",d.style.backgroundColor="black",d.style.opacity="0.5",d.style.margin="0px",d.style.padding="0px",d.style.outline="none",d.style.zIndex="3",d.style.height="8px",d.style.display="none",b.appendChild(d);e.isFirefox&&!a.setCapture&&(this._overlayDiv=c=e.createElement(c,"div"),c.style.position=a.style.position,c.style.borderWidth=a.style.borderWidth,c.style.margin=a.style.margin,c.style.padding=a.style.padding,c.style.cursor="text",c.style.zIndex="2",(this._clipDiv||
b).appendChild(c));a.contentEditable="true";a.setAttribute("role","textbox");a.setAttribute("aria-multiline","true");this._setWrapMode(this._wrapMode,!0);this._setReadOnly(this._readonly);this._setThemeClass(this._themeClass,!0);this._setTabSize(this._tabSize,!0);this._setMarginOffset(this._marginOffset,!0);this._hookEvents();b=this._rulers;for(c=0;c<b.length;c++)this._createRuler(b[c]);this._update()}},_defaultOptions:function(){return{parent:{value:void 0,update:null},model:{value:void 0,update:this.setModel},
scrollAnimation:{value:0,update:null},readonly:{value:!1,update:this._setReadOnly},fullSelection:{value:!0,update:this._setFullSelection},tabMode:{value:!0,update:null},tabSize:{value:8,update:this._setTabSize},expandTab:{value:!1,update:null},singleMode:{value:!1,update:this._setSingleMode},overwriteMode:{value:!1,update:this._setOverwriteMode},blockCursorVisible:{value:!1,update:this._setBlockCursor},marginOffset:{value:0,update:this._setMarginOffset},wrapOffset:{value:0,update:this._setWrapOffset},
wrapMode:{value:!1,update:this._setWrapMode},wrappable:{value:!1,update:null},theme:{value:l.TextTheme.getTheme(),update:this._setTheme},themeClass:{value:void 0,update:this._setThemeClass}}},_destroyRuler:function(a){var c=this._getRulerParent(a);if(c)for(var b=c.firstChild;b;){if(b._ruler===a){b._ruler=void 0;c.removeChild(b);if(0===c.children.length&&(c!==this._marginDiv||!this._marginOffset))c.style.display="none";break}b=b.nextSibling}},_destroyView:function(){if(this._clientDiv){this._setGrab(null);
this._unhookEvents();var a=this._getWindow();this._autoScrollTimerID&&(a.clearTimeout(this._autoScrollTimerID),this._autoScrollTimerID=null);this._updateTimer&&(a.clearTimeout(this._updateTimer),this._updateTimer=null);a=this._rootDiv;a.parentNode.removeChild(a);this._hScrollDiv=this._vScrollDiv=this._cursorDiv=this._marginDiv=this._rightDiv=this._leftDiv=this._overlayDiv=this._clientDiv=this._clipScrollDiv=this._clipDiv=this._viewDiv=this._scrollDiv=this._rootDiv=this._clipboardDiv=this._selDiv3=
this._selDiv2=this._selDiv1=null}},_doAutoScroll:function(a,c,b){this._autoScrollDir=a;this._autoScrollX=c;this._autoScrollY=b;this._autoScrollTimerID||this._autoScrollTimer()},_endAutoScroll:function(){this._autoScrollTimerID&&this._getWindow().clearTimeout(this._autoScrollTimerID);this._autoScrollTimerID=this._autoScrollDir=void 0},_fixCaret:function(){var a=this._clientDiv;if(a){var c=this._hasFocus;this._ignoreFocus=!0;c&&a.blur();a.contentEditable=!1;a.contentEditable=!0;c&&a.focus();this._ignoreFocus=
!1}},_getBaseText:function(a,c){var b=this._model;b.getBaseModel&&(a=b.mapOffset(a),c=b.mapOffset(c),b=b.getBaseModel());return b.getText(a,c)},_getBottomIndex:function(a){var c=this._bottomChild;if(a&&this._getClientHeight()>this._getLineHeight()){var a=c.getBoundingClientRect(),b=this._clientDiv.getBoundingClientRect();a.bottom>b.bottom&&(c=this._getLinePrevious(c)||c)}return c.lineIndex},_getBoundsAtOffset:function(a){var c=this._getLine(this._model.getLineAtOffset(a)),a=c.getBoundingClientRect(a),
b=this._getLinePixel(c.lineIndex);a.top+=b;a.bottom+=b;c.destroy();return a},_getClientHeight:function(){var a=this._getViewPadding();return Math.max(0,this._viewDiv.clientHeight-a.top-a.bottom)},_getClientWidth:function(){var a=this._getViewPadding();return Math.max(0,this._viewDiv.clientWidth-a.left-a.right)},_getClipboardText:function(a,c){var b=this._model.getLineDelimiter(),d,n,h=this._getWindow(),p=h.clipboardData;!p&&a&&(p=a.clipboardData);if(p)return d=[],n=p.getData(e.isIE?"Text":"text/plain"),
k(n,function(a){d.push(a)},function(){d.push(b)}),n=d.join(""),c&&c(n),n;if(e.isFirefox){this._ignoreFocus=!0;var g=this._clipboardDiv,p=this._rootDiv.ownerDocument;g||(this._clipboardDiv=g=e.createElement(p,"div"),g.style.position="fixed",g.style.whiteSpace="pre",g.style.left="-1000px",this._rootDiv.appendChild(g));g.innerHTML="<pre contenteditable=''></pre>";g.firstChild.focus();var f=this,l=function(){var a=f._getTextFromElement(g);g.innerHTML="";d=[];k(a,function(a){d.push(a)},function(){d.push(b)});
return d.join("")},s=!1;this._ignorePaste=!0;if(!e.isLinux||2!==this._lastMouseButton)try{s=p.execCommand("paste",!1,null)}catch(m){s=1<g.childNodes.length||g.firstChild&&0<g.firstChild.childNodes.length}this._ignorePaste=!1;if(!s){if(a)return h.setTimeout(function(){f.focus();(n=l())&&c&&c(n);f._ignoreFocus=!1},0),null;this.focus();this._ignoreFocus=!1;return""}this.focus();this._ignoreFocus=!1;(n=l())&&c&&c(n);return n}return""},_getDOMText:function(a,c){for(var b=a.firstChild,d="",k=0;b;){var e;
if(!b.ignore)if(b.ignoreChars){e=b.lastChild;for(var n=0,h=[],p=-1;e;){var g=e.data;if(g)for(var f=g.length-1;0<=f;f--){var l=g.substring(f,f+1);n<b.ignoreChars&&(" "===l||"\u200b"===l||"\ufeff"===l)?n++:h.push("\u00a0"===l?"\t":l)}c===e&&(p=h.length);e=e.previousSibling}h=h.reverse().join("");-1!==p&&(k=d.length+h.length-p);d+=h}else for(e=b.firstChild;e;)c===e&&(k=d.length),d+=e.data,e=e.nextSibling;b=b.nextSibling}return{text:d,offset:k}},_getTextFromElement:function(a){var c=a.ownerDocument,b=
c.defaultView;if(!b.getSelection)return a.innerText||a.textContent;c=c.createRange();c.selectNode(a);var a=b.getSelection(),b=[],d;for(d=0;d<a.rangeCount;d++)b.push(a.getRangeAt(d));this._ignoreSelect=!0;a.removeAllRanges();a.addRange(c);c=a.toString();a.removeAllRanges();for(d=0;d<b.length;d++)a.addRange(b[d]);this._ignoreSelect=!1;return c},_getViewPadding:function(){return this._metrics.viewPadding},_getLine:function(a){var c=this._getLineNode(a);return c&&!c.lineChanged&&!c.lineRemoved?c._line:
new w(this,a)},_getLineHeight:function(a,c){if(void 0!==a&&this._lineHeight){var b=this._lineHeight[a];if(b)return b;if(c||void 0===c)return this._lineHeight[a]=this._calculateLineHeight(a)}return this._metrics.lineHeight},_getLineNode:function(a){for(var c=this._clientDiv.firstChild;c;){if(a===c.lineIndex)return c;c=c.nextSibling}},_getLineNext:function(a){for(a=a?a.nextSibling:this._clientDiv.firstChild;a&&-1===a.lineIndex;)a=a.nextSibling;return a},_getLinePrevious:function(a){for(a=a?a.previousSibling:
this._clientDiv.lastChild;a&&-1===a.lineIndex;)a=a.previousSibling;return a},_getLinePixel:function(a){a=Math.min(Math.max(0,a),this._model.getLineCount());if(this._lineHeight){var c=this._getTopIndex(),b=-this._topIndexY+this._getScroll().y;if(a>c)for(;c<a;c++)b+=this._getLineHeight(c);else for(c-=1;c>=a;c--)b-=this._getLineHeight(c);return b}return this._getLineHeight()*a},_getLineIndex:function(a){var c,b=0,d=this._model.getLineCount();if(this._lineHeight){var b=this._getTopIndex(),k=-this._topIndexY+
this._getScroll().y;if(a!==k)if(a<k)for(;a<k&&0<b;)a+=this._getLineHeight(--b);else for(c=this._getLineHeight(b);a-c>=k&&b<d-1;)a-=c,c=this._getLineHeight(++b)}else c=this._getLineHeight(),b=Math.floor(a/c);return Math.max(0,Math.min(d-1,b))},_getRulerParent:function(a){switch(a.getLocation()){case "left":return this._leftDiv;case "right":return this._rightDiv;case "margin":return this._marginDiv}return null},_getScroll:function(a){(void 0===a||a)&&this._cancelAnimation();a=this._viewDiv;return{x:a.scrollLeft,
y:a.scrollTop}},_getSelection:function(){return this._selection.clone()},_getTopIndex:function(a){var c=this._topChild;if(a&&this._getClientHeight()>this._getLineHeight()){var a=c.getBoundingClientRect(),b=this._getViewPadding(),d=this._viewDiv.getBoundingClientRect();a.top<d.top+b.top&&(c=this._getLineNext(c)||c)}return c.lineIndex},_hookEvents:function(){var a=this;this._modelListener={onChanging:function(c){a._onModelChanging(c)},onChanged:function(c){a._onModelChanged(c)}};this._model.addEventListener("preChanging",
this._modelListener.onChanging);this._model.addEventListener("postChanged",this._modelListener.onChanged);this._themeListener={onChanged:function(){a._setThemeClass(a._themeClass)}};this._theme.addEventListener("ThemeChanged",this._themeListener.onChanged);var c=this._handlers=[],b=this._clientDiv,d=this._viewDiv,k=this._rootDiv,n=this._overlayDiv||b,h=b.ownerDocument,p=this._getWindow(),g=e.isIE?h:p;c.push({target:p,type:"resize",handler:function(c){return a._handleResize(c?c:p.event)}});c.push({target:b,
type:"blur",handler:function(c){return a._handleBlur(c?c:p.event)}});c.push({target:b,type:"focus",handler:function(c){return a._handleFocus(c?c:p.event)}});c.push({target:d,type:"focus",handler:function(){b.focus()}});c.push({target:d,type:"scroll",handler:function(c){return a._handleScroll(c?c:p.event)}});c.push({target:b,type:"textInput",handler:function(c){return a._handleTextInput(c?c:p.event)}});c.push({target:b,type:"keydown",handler:function(c){return a._handleKeyDown(c?c:p.event)}});c.push({target:b,
type:"keypress",handler:function(c){return a._handleKeyPress(c?c:p.event)}});c.push({target:b,type:"keyup",handler:function(c){return a._handleKeyUp(c?c:p.event)}});e.isIE&&c.push({target:h,type:"keyup",handler:function(c){return a._handleDocKeyUp(c?c:p.event)}});c.push({target:b,type:"contextmenu",handler:function(c){return a._handleContextMenu(c?c:p.event)}});c.push({target:b,type:"copy",handler:function(c){return a._handleCopy(c?c:p.event)}});c.push({target:b,type:"cut",handler:function(c){return a._handleCut(c?
c:p.event)}});c.push({target:b,type:"paste",handler:function(c){return a._handlePaste(c?c:p.event)}});if(e.isIOS||e.isAndroid)c.push({target:h,type:"selectionchange",handler:function(c){return a._handleSelectionChange(c?c:p.event)}}),c.push({target:b,type:"touchstart",handler:function(c){return a._handleTouchStart(c?c:p.event)}}),c.push({target:b,type:"touchmove",handler:function(c){return a._handleTouchMove(c?c:p.event)}}),c.push({target:b,type:"touchend",handler:function(c){return a._handleTouchEnd(c?
c:p.event)}});else{c.push({target:b,type:"selectstart",handler:function(c){return a._handleSelectStart(c?c:p.event)}});c.push({target:b,type:"mousedown",handler:function(c){return a._handleMouseDown(c?c:p.event)}});c.push({target:b,type:"mouseover",handler:function(c){return a._handleMouseOver(c?c:p.event)}});c.push({target:b,type:"mouseout",handler:function(c){return a._handleMouseOut(c?c:p.event)}});c.push({target:g,type:"mouseup",handler:function(c){return a._handleMouseUp(c?c:p.event)}});c.push({target:g,
type:"mousemove",handler:function(c){return a._handleMouseMove(c?c:p.event)}});c.push({target:k,type:"mousedown",handler:function(c){return a._handleRootMouseDown(c?c:p.event)}});c.push({target:k,type:"mouseup",handler:function(c){return a._handleRootMouseUp(c?c:p.event)}});c.push({target:n,type:"dragstart",handler:function(c){return a._handleDragStart(c?c:p.event)}});c.push({target:n,type:"drag",handler:function(c){return a._handleDrag(c?c:p.event)}});c.push({target:n,type:"dragend",handler:function(c){return a._handleDragEnd(c?
c:p.event)}});c.push({target:n,type:"dragenter",handler:function(c){return a._handleDragEnter(c?c:p.event)}});c.push({target:n,type:"dragover",handler:function(c){return a._handleDragOver(c?c:p.event)}});c.push({target:n,type:"dragleave",handler:function(c){return a._handleDragLeave(c?c:p.event)}});c.push({target:n,type:"drop",handler:function(c){return a._handleDrop(c?c:p.event)}});c.push({target:this._clientDiv,type:e.isFirefox?"DOMMouseScroll":"mousewheel",handler:function(c){return a._handleMouseWheel(c?
c:p.event)}});this._clipDiv&&c.push({target:this._clipDiv,type:e.isFirefox?"DOMMouseScroll":"mousewheel",handler:function(c){return a._handleMouseWheel(c?c:p.event)}});if(e.isFirefox&&(!e.isWindows||15<=e.isFirefox))(d=p.MutationObserver||p.MozMutationObserver)?(this._mutationObserver=new d(function(c){a._handleDataModified(c)}),this._mutationObserver.observe(b,{subtree:!0,characterData:!0})):c.push({target:this._clientDiv,type:"DOMCharacterDataModified",handler:function(c){return a._handleDataModified(c?
c:p.event)}});this._overlayDiv&&(c.push({target:this._overlayDiv,type:"mousedown",handler:function(c){return a._handleMouseDown(c?c:p.event)}}),c.push({target:this._overlayDiv,type:"mouseover",handler:function(c){return a._handleMouseOver(c?c:p.event)}}),c.push({target:this._overlayDiv,type:"mouseout",handler:function(c){return a._handleMouseOut(c?c:p.event)}}),c.push({target:this._overlayDiv,type:"contextmenu",handler:function(c){return a._handleContextMenu(c?c:p.event)}}));this._isW3CEvents||c.push({target:this._clientDiv,
type:"dblclick",handler:function(c){return a._handleDblclick(c?c:p.event)}})}this._hookRulerEvents(this._leftDiv,c);this._hookRulerEvents(this._rightDiv,c);this._hookRulerEvents(this._marginDiv,c);for(d=0;d<c.length;d++)k=c[d],x(k.target,k.type,k.handler,k.capture)},_hookRulerEvents:function(a,c){if(a){var b=this,d=this._getWindow();e.isIE&&c.push({target:a,type:"selectstart",handler:function(){return!1}});c.push({target:a,type:e.isFirefox?"DOMMouseScroll":"mousewheel",handler:function(a){return b._handleMouseWheel(a?
a:d.event)}});c.push({target:a,type:"click",handler:function(a){b._handleRulerEvent(a?a:d.event)}});c.push({target:a,type:"dblclick",handler:function(a){b._handleRulerEvent(a?a:d.event)}});c.push({target:a,type:"mousemove",handler:function(a){b._handleRulerEvent(a?a:d.event)}});c.push({target:a,type:"mouseover",handler:function(a){b._handleRulerEvent(a?a:d.event)}});c.push({target:a,type:"mouseout",handler:function(a){b._handleRulerEvent(a?a:d.event)}})}},_getWindow:function(){return this._parent.ownerDocument.defaultView||
this._parent.ownerDocument.parentWindow},_ignoreEvent:function(a){for(a=a.target;a&&a!==this._clientDiv;){if(a.ignore)return!0;a=a.parentNode}return!1},_init:function(a){var c=a.parent;"string"===typeof c&&(c=(a.document||document).getElementById(c));if(!c)throw"no parent";a.parent=c;a.model=a.model||new m.TextModel;var b=this._defaultOptions(),d;for(d in b)b.hasOwnProperty(d)&&(this["_"+d]=void 0!==a[d]?a[d]:b[d].value);this._keyModes=[];this._rulers=[];this._selection=new u(0,0,!1);this._linksVisible=
!1;this._maxLineWidth=this._redrawCount=0;this._maxLineIndex=-1;this._ignoreSelect=!0;this._hasFocus=this._ignoreFocus=!1;this._dragOffset=this._columnX=-1;this._isRangeRects=(!e.isIE||9<=e.isIE)&&"function"===typeof c.ownerDocument.createRange().getBoundingClientRect;this._isW3CEvents=c.addEventListener;this._autoScrollTimerID=this._autoScrollY=this._autoScrollX=null;this._AUTO_SCROLL_RATE=50;this._mouseUpClosure=this._moseMoveClosure=this._grabControl=null;this._clickCount=this._lastMouseTime=this._lastMouseY=
this._lastMouseX=0;this._clickTime=250;this._clickDist=5;this._isMouseDown=!1;this._doubleClickSelection=null;this._vScroll=this._hScroll=0;this._imeOffset=-1;this._createActions();this._createView()},_modifyContent:function(a,c){if(!this._readonly||a._code)if(a.type="Verify",this.onVerify(a),!(null===a.text||void 0===a.text)){var b=this._model;try{a._ignoreDOMSelection&&(this._ignoreDOMSelection=!0),b.setText(a.text,a.start,a.end)}finally{a._ignoreDOMSelection&&(this._ignoreDOMSelection=!1)}c&&(b=
this._getSelection(),b.setCaret(a.start+a.text.length),this._setSelection(b,!0));this.onModify({type:"Modify"})}},_onModelChanged:function(a){a.type="ModelChanged";this.onModelChanged(a);a.type="Changed";var c=a.start,b=a.addedCharCount,d=a.removedCharCount,k=a.addedLineCount,e=a.removedLineCount,n=this._getSelection();n.end>c&&(n.end>c&&n.start<c+d?n.setCaret(c+b):(n.start+=b-d,n.end+=b-d),this._setSelection(n,!1,!1));c=this._model.getLineAtOffset(c);for(b=this._getLineNext();b;)d=b.lineIndex,c<=
d&&d<=c+e&&(c===d&&!b.modelChangedEvent&&!b.lineRemoved?(b.modelChangedEvent=a,b.lineChanged=!0):(b.lineRemoved=!0,b.lineChanged=!1,b.modelChangedEvent=null)),d>c+e&&(b.lineIndex=d+k-e,b._line.lineIndex=b.lineIndex),b=this._getLineNext(b);this._lineHeight&&(a=[c,e].concat(Array(k)),Array.prototype.splice.apply(this._lineHeight,a));!this._wrapMode&&(c<=this._maxLineIndex&&this._maxLineIndex<=c+e)&&(this._checkMaxLineIndex=this._maxLineIndex,this._maxLineIndex=-1,this._maxLineWidth=0);this._update()},
_onModelChanging:function(a){a.type="ModelChanging";this.onModelChanging(a);a.type="Changing"},_queueUpdate:function(){if(!this._updateTimer&&!this._ignoreQueueUpdate){var a=this;this._updateTimer=this._getWindow().setTimeout(function(){a._updateTimer=null;a._update()},0)}},_resetLineHeight:function(a,c){if(this._wrapMode||this._variableLineHeight){if(void 0!==a&&void 0!==c)for(var b=a;b<c;b++)this._lineHeight[b]=void 0;else this._lineHeight=Array(this._model.getLineCount());this._calculateLineHeightTimer()}else this._lineHeight=
null},_resetLineWidth:function(){var a=this._clientDiv;if(a)for(a=a.firstChild;a;)a.lineWidth=void 0,a=a.nextSibling},_reset:function(){this._maxLineIndex=-1;this._maxLineWidth=0;this._columnX=-1;this._bottomChild=this._topChild=null;this._topIndexY=0;this._variableLineHeight=!1;this._resetLineHeight();this._setSelection(new u(0,0,!1),!1,!1);this._viewDiv&&(this._viewDiv.scrollLeft=0,this._viewDiv.scrollTop=0);var a=this._clientDiv;if(a){for(var c=a.firstChild;c;)c.lineRemoved=!0,c=c.nextSibling;
e.isFirefox&&(this._ignoreFocus=!1,(c=this._hasFocus)&&a.blur(),a.contentEditable=!1,a.contentEditable=!0,c&&a.focus(),this._ignoreFocus=!1)}},_scrollViewAnimated:function(a,c,b){var d=this._getWindow();if(b&&this._scrollAnimation){var k=this;this._animation=new z({window:d,duration:this._scrollAnimation,curve:[c,0],onAnimate:function(a){a=c-Math.floor(a);k._scrollView(0,a);c-=a},onEnd:function(){k._animation=null;k._scrollView(a,c);b&&d.setTimeout(b,0)}});this._animation.play()}else this._scrollView(a,
c),b&&d.setTimeout(b,0)},_scrollView:function(a,c){this._ensureCaretVisible=!1;var b=this._viewDiv;a&&(b.scrollLeft+=a);c&&(b.scrollTop+=c)},_setClipboardText:function(a,c){var b,d=this._getWindow(),n=d.clipboardData;!n&&c&&(n=c.clipboardData);if(n&&(b=[],k(a,function(a){b.push(a)},function(){b.push(e.platformDelimiter)}),n.setData(e.isIE?"Text":"text/plain",b.join(""))))return!0;var h=this._parent.ownerDocument,p=e.createElement(h,"pre");p.style.position="fixed";p.style.left="-1000px";k(a,function(a){p.appendChild(h.createTextNode(a))},
function(){p.appendChild(e.createElement(h,"br"))});p.appendChild(h.createTextNode(" "));this._clientDiv.appendChild(p);n=h.createRange();n.setStart(p.firstChild,0);n.setEndBefore(p.lastChild);var g=d.getSelection();0<g.rangeCount&&g.removeAllRanges();g.addRange(n);var f=this,n=function(){p&&p.parentNode===f._clientDiv&&f._clientDiv.removeChild(p);f._updateDOMSelection()},g=!1;this._ignoreCopy=!0;try{g=h.execCommand("copy",!1,null)}catch(l){}this._ignoreCopy=!1;if(!g&&c)return d.setTimeout(n,0),!1;
n();return!0},_setDOMSelection:function(a,c,b,d,k){for(var n,h,p,g,f=0,l=a.firstChild,s,m,w=this._model.getLine(a.lineIndex).length;l;){if(!l.ignore){s=l.firstChild;m=s.length;l.ignoreChars&&(m-=l.ignoreChars);if(f+m>c||f+m>=w){n=s;h=c-f;l.ignoreChars&&(0<m&&h===m)&&(h+=l.ignoreChars);break}f+=m}l=l.nextSibling}for(var f=0,l=b.firstChild,u=this._model.getLine(b.lineIndex).length;l;){if(!l.ignore){s=l.firstChild;m=s.length;l.ignoreChars&&(m-=l.ignoreChars);if(m+f>d||f+m>=u){p=s;g=d-f;l.ignoreChars&&
(0<m&&g===m)&&(g+=l.ignoreChars);break}f+=m}l=l.nextSibling}this._setDOMFullSelection(a,c,w,b,d,u);a=this._getWindow();c=this._parent.ownerDocument;if(a.getSelection){b=a.getSelection();a=c.createRange();a.setStart(n,h);a.setEnd(p,g);if(this._hasFocus&&(b.anchorNode!==n||b.anchorOffset!==h||b.focusNode!==p||b.focusOffset!==g||b.anchorNode!==p||b.anchorOffset!==g||b.focusNode!==n||b.focusOffset!==h))this._anchorNode=n,this._anchorOffset=h,this._focusNode=p,this._focusOffset=g,this._ignoreSelect=!1,
0<b.rangeCount&&b.removeAllRanges(),b.addRange(a),this._ignoreSelect=!0;this._cursorDiv&&(a=c.createRange(),k?(a.setStart(n,h),a.setEnd(n,h)):(a.setStart(p,g),a.setEnd(p,g)),p=a.getClientRects()[0],g=this._cursorDiv.parentNode,n=g.getBoundingClientRect(),p&&n&&(this._cursorDiv.style.top=p.top-n.top+g.scrollTop+"px",this._cursorDiv.style.left=p.left-n.left+g.scrollLeft+"px"))}else c.selection&&this._hasFocus&&(k=c.body,a=e.createElement(c,"div"),k.appendChild(a),k.removeChild(a),a=k.createTextRange(),
a.moveToElementText(n.parentNode),a.moveStart("character",h),n=k.createTextRange(),n.moveToElementText(p.parentNode),n.moveStart("character",g),a.setEndPoint("EndToStart",n),this._ignoreSelect=!1,a.select(),this._ignoreSelect=!0)},_setDOMFullSelection:function(a,c,b,d,k){if(this._selDiv1&&(b=this._selDiv1,b.style.width="0px",b.style.height="0px",b=this._selDiv2,b.style.width="0px",b.style.height="0px",b=this._selDiv3,b.style.width="0px",b.style.height="0px",!(a===d&&c===k))){var e=this._model,n=this._getViewPadding(),
h=this._clientDiv.getBoundingClientRect(),p=this._viewDiv.getBoundingClientRect(),b=p.left+n.left,g=h.right,n=p.top+n.top,f=h.bottom,p=h=0;this._clipDiv?(p=this._clipDiv.getBoundingClientRect(),h=p.left-this._clipDiv.scrollLeft):(p=this._rootDiv.getBoundingClientRect(),h=p.left);p=p.top;this._ignoreDOMSelection=!0;var l=(new w(this,a.lineIndex,a)).getBoundingClientRect(e.getLineStart(a.lineIndex)+c,!1),s=l.left,c=(new w(this,d.lineIndex,d)).getBoundingClientRect(e.getLineStart(d.lineIndex)+k,!1),
e=c.left;this._ignoreDOMSelection=!1;var m=this._selDiv1,s=Math.min(g,Math.max(b,s)),u=Math.min(f,Math.max(n,l.top)),v=g,k=Math.min(f,Math.max(n,l.bottom));m.style.left=s-h+"px";m.style.top=u-p+"px";m.style.width=Math.max(0,v-s)+"px";m.style.height=Math.max(0,k-u)+"px";a.lineIndex===d.lineIndex?(v=Math.min(e,g),m.style.width=Math.max(0,v-s)+"px"):(l=Math.min(f,Math.max(n,c.top)),e=Math.min(g,Math.max(b,e)),n=Math.min(f,Math.max(n,c.bottom)),f=this._selDiv3,f.style.left=b-h+"px",f.style.top=l-p+"px",
f.style.width=Math.max(0,e-b)+"px",f.style.height=Math.max(0,n-l)+"px",1<Math.abs(a.lineIndex-d.lineIndex)&&(a=this._selDiv2,a.style.left=b-h+"px",a.style.top=k-p+"px",a.style.width=Math.max(0,g-b)+"px",a.style.height=Math.max(0,l-k)+"px"))}},_setGrab:function(a){a!==this._grabControl&&(a?(a.setCapture&&a.setCapture(),this._grabControl=a):(this._grabControl.releaseCapture&&this._grabControl.releaseCapture(),this._grabControl=null))},_setLinksVisible:function(a){if(this._linksVisible!==a){this._linksVisible=
a;e.isIE&&a&&(this._hadFocus=this._hasFocus);var c=this._clientDiv;c.contentEditable=!a;this._hadFocus&&!a&&c.focus();this._overlayDiv&&(this._overlayDiv.style.zIndex=a?"-1":"1");for(a=this._getLineNext();a;){if(a.hasLink)for(c=a.firstChild;c;)if(c.ignore)c=c.nextSibling;else{var b=c.nextSibling,d=c.viewStyle;d&&(d.tagName&&"a"===d.tagName.toLowerCase())&&a.replaceChild(a._line._createSpan(a,c.firstChild.data,d),c);c=b}a=this._getLineNext(a)}this._updateDOMSelection()}},_setSelection:function(a,c,
b,d,k){if(a){this._columnX=-1;void 0===b&&(b=!0);var e=this._selection;this._selection=a;!1!==c&&this._showCaret(!1,d,c,k);b&&this._updateDOMSelection();if(!e.equals(a))this.onSelection({type:"Selection",oldValue:{start:e.start,end:e.end},newValue:{start:a.start,end:a.end}})}},_setSelectionTo:function(a,c,b,d){var k=this._model,e=this._getSelection(),c=this.convert({x:a,y:c},"page","document"),a=this._getLineIndex(c.y);if(1===this._clickCount){k=this._getLine(a);a=k.getOffset(c.x,c.y-this._getLinePixel(a));
k.destroy();if(d&&!b&&e.start<=a&&a<e.end)return this._dragOffset=a,!1;e.extend(a);b||e.collapse()}else 0===(this._clickCount&1)?(k=this._getLine(a),a=k.getOffset(c.x,c.y-this._getLinePixel(a)),this._doubleClickSelection?a>=this._doubleClickSelection.start?(b=this._doubleClickSelection.start,d=k.getNextOffset(a,{unit:"wordend",count:1})):(b=k.getNextOffset(a,{unit:"word",count:-1}),d=this._doubleClickSelection.end):(b=k.getNextOffset(a,{unit:"word",count:-1}),d=k.getNextOffset(b,{unit:"wordend",count:1})),
k.destroy()):this._doubleClickSelection?(d=k.getLineAtOffset(this._doubleClickSelection.start),a>=d?(b=k.getLineStart(d),d=k.getLineEnd(a)):(b=k.getLineStart(a),d=k.getLineEnd(d))):(b=k.getLineStart(a),d=k.getLineEnd(a)),e.setCaret(b),e.extend(d);this._setSelection(e,!0,!0);return!0},_setFullSelection:function(a,c){this._fullSelection=a;e.isWebkit&&(this._fullSelection=!0);var b=this._clipDiv||this._rootDiv;if(b)if(this._fullSelection){if(!this._selDiv1&&this._fullSelection&&!e.isIOS){var d=b.ownerDocument;
this._highlightRGB=e.isWebkit?"transparent":"Highlight";var k=e.createElement(d,"div");this._selDiv1=k;k.style.position="absolute";k.style.borderWidth="0px";k.style.margin="0px";k.style.padding="0px";k.style.outline="none";k.style.background=this._highlightRGB;k.style.width="0px";k.style.height="0px";k.style.zIndex="0";b.appendChild(k);var n=e.createElement(d,"div");this._selDiv2=n;n.style.position="absolute";n.style.borderWidth="0px";n.style.margin="0px";n.style.padding="0px";n.style.outline="none";
n.style.background=this._highlightRGB;n.style.width="0px";n.style.height="0px";n.style.zIndex="0";b.appendChild(n);this._selDiv3=d=e.createElement(d,"div");d.style.position="absolute";d.style.borderWidth="0px";d.style.margin="0px";d.style.padding="0px";d.style.outline="none";d.style.background=this._highlightRGB;d.style.width="0px";d.style.height="0px";d.style.zIndex="0";b.appendChild(d);if(e.isFirefox&&e.isMac){b=this._getWindow().getComputedStyle(d,null).getPropertyValue("background-color");switch(b){case "rgb(119, 141, 168)":b=
"rgb(199, 208, 218)";break;case "rgb(127, 127, 127)":b="rgb(198, 198, 198)";break;case "rgb(255, 193, 31)":b="rgb(250, 236, 115)";break;case "rgb(243, 70, 72)":b="rgb(255, 176, 139)";break;case "rgb(255, 138, 34)":b="rgb(255, 209, 129)";break;case "rgb(102, 197, 71)":b="rgb(194, 249, 144)";break;case "rgb(140, 78, 184)":b="rgb(232, 184, 255)";break;default:b="rgb(180, 213, 255)"}this._highlightRGB=b;k.style.background=b;n.style.background=b;d.style.background=b}c||this._updateDOMSelection()}}else this._selDiv1&&
(b.removeChild(this._selDiv1),this._selDiv1=null),this._selDiv2&&(b.removeChild(this._selDiv2),this._selDiv2=null),this._selDiv3&&(b.removeChild(this._selDiv3),this._selDiv3=null)},_setBlockCursor:function(a){this._blockCursorVisible=a;this._updateBlockCursorVisible()},_setOverwriteMode:function(a){this._overwriteMode=a;this._updateBlockCursorVisible()},_updateBlockCursorVisible:function(){if(this._blockCursorVisible||this._overwriteMode){if(!this._cursorDiv){var a=e.createElement(document,"div");
a.className="textviewBlockCursor";this._cursorDiv=a;a.tabIndex=-1;a.style.zIndex="2";a.style.color="transparent";a.style.position="absolute";a.style.pointerEvents="none";a.innerHTML="&nbsp;";this._viewDiv.appendChild(a);this._updateDOMSelection()}}else this._cursorDiv&&(this._cursorDiv.parentNode.removeChild(this._cursorDiv),this._cursorDiv=null)},_setMarginOffset:function(a,c){this._marginOffset=a;this._marginDiv.style.display=a?"block":"none";c||(this._metrics=this._calculateMetrics(),this._queueUpdate())},
_setWrapOffset:function(a,c){this._wrapOffset=a;c||(this._metrics=this._calculateMetrics(),this._queueUpdate())},_setReadOnly:function(a){this._readonly=a;this._clientDiv.setAttribute("aria-readonly",a?"true":"false")},_setSingleMode:function(a,c){this._singleMode=a;this._updateOverflow();this._updateStyle(c)},_setTabSize:function(a,c){this._tabSize=a;this._customTabSize=void 0;var b=this._clientDiv;e.isOpera?b&&(b.style.OTabSize=this._tabSize+""):537.1<=e.isWebkit?b&&(b.style.tabSize=this._tabSize+
""):4<=e.isFirefox?b&&(b.style.MozTabSize=this._tabSize+""):8!==this._tabSize&&(this._customTabSize=this._tabSize);c||(this.redrawLines(),this._resetLineWidth())},_setTheme:function(a){this._theme&&this._theme.removeEventListener("ThemeChanged",this._themeListener.onChanged);(this._theme=a)&&this._theme.addEventListener("ThemeChanged",this._themeListener.onChanged);this._setThemeClass(this._themeClass)},_setThemeClass:function(a,c){this._themeClass=a;var b="textview",d=this._theme.getThemeClass();
d&&(b+=" "+d);this._themeClass&&d!==this._themeClass&&(b+=" "+this._themeClass);this._rootDiv.className=b;this._updateStyle(c)},_setWrapMode:function(a,c){this._wrapMode=a&&this._wrappable;var b=this._clientDiv;this._wrapMode?(b.style.whiteSpace="pre-wrap",b.style.wordWrap="break-word"):(b.style.whiteSpace="pre",b.style.wordWrap="normal");this._updateOverflow();c||(this.redraw(),this._resetLineWidth());this._resetLineHeight()},_showCaret:function(a,c,b,d){if(this._clientDiv){var k=this._model,e=this._getSelection(),
n=this._getScroll(),h=e.getCaret(),p=e.start,g=e.end,f=k.getLineAtOffset(g),l=Math.max(Math.max(p,k.getLineStart(f)),g-1),k=this._getClientWidth(),f=this._getClientHeight(),s=k/4,m=this._getBoundsAtOffset(h===p?p:l),w=m.left,u=m.right,v=m.top,q=m.bottom;a&&!e.isEmpty()&&(m=this._getBoundsAtOffset(h===g?p:l),m.top===v?h===p?u=w+Math.min(m.right-w,k):w=u-Math.min(u-m.left,k):h===p?q=v+Math.min(m.bottom-v,f):v=q-Math.min(q-m.top,f));a=0;w<n.x&&(a=Math.min(w-n.x,-s));u>n.x+k&&(a=Math.max(u-n.x-k,s));
e=0;v<n.y?e=v-n.y:q>n.y+f&&(e=q-n.y-f);d&&(0<d?0<e&&(e=Math.max(e,d)):0>e&&(e=Math.min(e,d)));if(0!==a||0!==e)return 0!==e&&"number"===typeof b&&(0>b&&(b=0),1<b&&(b=1),e+=Math.floor(0<e?b*f:-b*f)),this._scrollViewAnimated(a,e,c),f!==this._getClientHeight()||k!==this._getClientWidth()?this._showCaret():this._ensureCaretVisible=!0,!0;c&&c();return!1}},_startIME:function(){if(-1===this._imeOffset){var a=this._getSelection();a.isEmpty()||this._modifyContent({text:"",start:a.start,end:a.end},!0);this._imeOffset=
a.start}},_unhookEvents:function(){this._model.removeEventListener("preChanging",this._modelListener.onChanging);this._model.removeEventListener("postChanged",this._modelListener.onChanged);this._theme.removeEventListener("ThemeChanged",this._themeListener.onChanged);this._modelListener=null;for(var a=0;a<this._handlers.length;a++){var c=this._handlers[a];v(c.target,c.type,c.handler)}this._handlers=null;this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null)},_updateDOMSelection:function(){if(!(0<
this._redrawCount)&&!this._ignoreDOMSelection&&this._clientDiv){var a=this._getSelection(),c=this._model,b=c.getLineAtOffset(a.start),d=c.getLineAtOffset(a.end),k=this._getLineNext();if(k){var e=this._getLinePrevious(),n;b<k.lineIndex?(n=k,b=0):b>e.lineIndex?(n=e,b=0):(n=this._getLineNode(b),b=a.start-c.getLineStart(b));d<k.lineIndex?c=0:d>e.lineIndex?(k=e,c=0):(k=this._getLineNode(d),c=a.end-c.getLineStart(d));this._setDOMSelection(n,b,k,c,a.caret)}}},_update:function(a){if(!(0<this._redrawCount)){this._updateTimer&&
(this._getWindow().clearTimeout(this._updateTimer),this._updateTimer=null,a=!1);var c=this._clientDiv,b=this._viewDiv;if(c){this._metrics.invalid&&(this._ignoreQueueUpdate=!0,this._updateStyle(),this._ignoreQueueUpdate=!1);var d=this._model,k=this._getScroll(!1),n=this._getViewPadding(),h=d.getLineCount(),p=this._getLineHeight(),g=!1,f=!1,l=!1,s=this._metrics.scrollWidth;this._wrapMode&&(c.style.width=(this._metrics.wrapWidth||this._getClientWidth())+"px");var m,u,v,q,y=0,z=0,x;if(this._lineHeight){for(;z<
h;){x=this._getLineHeight(z);if(y+x>k.y)break;y+=x;z++}m=z;u=Math.max(0,m-1);v=d=k.y-y;0<m&&(d+=this._getLineHeight(m-1))}else q=Math.max(0,k.y)/p,m=Math.floor(q),u=Math.max(0,m-1),d=Math.round((q-u)*p),v=Math.round((q-m)*p);this._topIndexY=v;q=this._rootDiv;var P=q.clientWidth,K=q.clientHeight;if(a){p=0;this._leftDiv&&(m=this._leftDiv.getBoundingClientRect(),p=m.right-m.left);m=this._getClientWidth();q=this._getClientHeight();f=m;this._wrapMode?this._metrics.wrapWidth&&(f=this._metrics.wrapWidth):
f=Math.max(this._maxLineWidth,f);for(;z<h;)x=this._getLineHeight(z,!1),y+=x,z++;h=y}else{q=this._getClientHeight();v=Math.min(m+Math.floor((q+v)/p),h-1);var k=Math.min(v+1,h-1),G;for(x=c.firstChild;x;){G=x.lineIndex;var F=x.nextSibling;if(!(u<=G&&G<=k)||x.lineRemoved||-1===x.lineIndex)this._mouseWheelLine===x?(x.style.display="none",x.lineIndex=-1):c.removeChild(x);x=F}x=this._getLineNext();var F=b.ownerDocument,L=F.createDocumentFragment();for(G=u;G<=k;G++)!x||x.lineIndex>G?(new w(this,G)).create(L,
null):(L.firstChild&&(c.insertBefore(L,x),L=F.createDocumentFragment()),x&&x.lineChanged&&(x=(new w(this,G)).create(L,x),x.lineChanged=!1),x=this._getLineNext(x));L.firstChild&&c.insertBefore(L,x);e.isWebkit&&!this._wrapMode&&(c.style.width="0x7fffffffpx");x=this._getLineNext();G=q+d;for(L=!1;x;)u=x.lineWidth,void 0===u&&(F=x._line.getBoundingClientRect(),u=x.lineWidth=Math.ceil(F.right-F.left),F=F.bottom-F.top,this._lineHeight?this._lineHeight[x.lineIndex]=F:0!==p&&(0!==F&&Math.ceil(p)!==Math.ceil(F))&&
(this._variableLineHeight=!0,this._lineHeight=[],this._lineHeight[x.lineIndex]=F)),this._lineHeight&&!L&&(G-=this._lineHeight[x.lineIndex],0>G&&(v=x.lineIndex,L=!0)),this._wrapMode||(u>=this._maxLineWidth&&(this._maxLineWidth=u,this._maxLineIndex=x.lineIndex),this._checkMaxLineIndex===x.lineIndex&&(this._checkMaxLineIndex=-1)),x.lineIndex===m&&(this._topChild=x),x.lineIndex===v&&(this._bottomChild=x),x=this._getLineNext(x);-1!==this._checkMaxLineIndex&&(G=this._checkMaxLineIndex,this._checkMaxLineIndex=
-1,0<=G&&G<h&&(p=new w(this,G),F=p.getBoundingClientRect(),u=F.right-F.left,u>=this._maxLineWidth&&(this._maxLineWidth=u,this._maxLineIndex=G),p.destroy()));for(;z<h;)x=this._getLineHeight(z,z<=v),y+=x,z++;h=y;this._updateRuler(this._leftDiv,m,k,K);this._updateRuler(this._rightDiv,m,k,K);this._updateRuler(this._marginDiv,m,k,K);p=0;this._leftDiv&&(m=this._leftDiv.getBoundingClientRect(),p=m.right-m.left);k=0;this._rightDiv&&(k=this._rightDiv.getBoundingClientRect(),k=k.right-k.left);b.style.left=
p+"px";b.style.right=k+"px";k=this._scrollDiv;k.style.height=h+"px";m=this._getClientWidth();!this._singleMode&&!this._wrapMode&&(y=g=q,(z="scroll"===b.style.overflowX)?g+=s:y-=s,x=v=m,(u="scroll"===b.style.overflowY)?v+=s:x-=s,q=g,m=v,h>q&&(l=!0,m=x),this._maxLineWidth>m&&(f=!0,q=y,h>q&&(l=!0,m=x)),z!==f&&(b.style.overflowX=f?"scroll":"hidden"),u!==l&&(b.style.overflowY=l?"scroll":"hidden"),g=z!==f||u!==l);l=m;this._wrapMode?this._metrics.wrapWidth&&(l=this._metrics.wrapWidth):l=Math.max(this._maxLineWidth,
l);f=l;if((!e.isIE||9<=e.isIE)&&this._maxLineWidth>m)l+=n.right+n.left;k.style.width=l+"px";this._clipScrollDiv&&(this._clipScrollDiv.style.width=l+"px");k=this._getScroll(!1)}this._vScrollDiv&&(l=q-8,y=Math.max(15,Math.ceil(Math.min(1,l/(h+n.top+n.bottom))*l)),this._vScrollDiv.style.left=p+m-8+"px",this._vScrollDiv.style.top=Math.floor(Math.max(0,k.y*l/h))+"px",this._vScrollDiv.style.height=y+"px");!this._wrapMode&&this._hScrollDiv&&(l=m-8,y=Math.max(15,Math.ceil(Math.min(1,l/(this._maxLineWidth+
n.left+n.right))*l)),this._hScrollDiv.style.left=p+Math.floor(Math.max(0,Math.floor(k.x*l/this._maxLineWidth)))+"px",this._hScrollDiv.style.top=q-9+"px",this._hScrollDiv.style.width=y+"px");z=k.x;y=this._clipDiv;l=this._overlayDiv;if(v=this._marginDiv)v.style.left=-z+p+this._metrics.marginWidth+n.left+"px",v.style.bottom=("scroll"===b.style.overflowX?s:0)+"px";y?(y.scrollLeft=z,y.scrollTop=0,b=p+n.left,s=n.top,a=m,p=q,z=0,v=-d,0===k.x&&(b-=n.left,a+=n.left,z=n.left),k.x+m===f&&(a+=n.right),0===k.y&&
(s-=n.top,p+=n.top,v+=n.top),k.y+q===h&&(p+=n.bottom),y.style.left=b+"px",y.style.top=s+"px",y.style.right=P-a-b+"px",y.style.bottom=K-p-s+"px",c.style.left=z+"px",c.style.top=v+"px",c.style.width=f+"px",c.style.height=q+d+"px",l&&(l.style.left=c.style.left,l.style.top=c.style.top,l.style.width=c.style.width,l.style.height=c.style.height)):(b=z,s=d,P=z+m,K=d+q,0===b&&(b-=n.left),0===s&&(s-=n.top),P===f&&(P+=n.right),k.y+q===h&&(K+=n.bottom),c.style.clip="rect("+s+"px,"+P+"px,"+K+"px,"+b+"px)",c.style.left=
-z+p+n.left+"px",c.style.width=(this._wrapMode||e.isWebkit?f:m+z)+"px",a||(c.style.top=-d+n.top+"px",c.style.height=q+d+"px"),l&&(l.style.clip=c.style.clip,l.style.left=c.style.left,l.style.width=c.style.width,a||(l.style.top=c.style.top,l.style.height=c.style.height)));this._updateDOMSelection();g&&(c=this._ensureCaretVisible,this._ensureCaretVisible=!1,c&&this._showCaret(),this._queueUpdate())}}},_updateOverflow:function(){var a=this._viewDiv;this._wrapMode?(a.style.overflowX="hidden",a.style.overflowY=
"scroll"):a.style.overflow="hidden"},_updateRuler:function(a,c,b,k){if(a)for(var n=this._parent.ownerDocument,p=this._getLineHeight(),h=this._getViewPadding(),a=a.firstChild;a;){var g=a._ruler,f=p,l=g.getOverview();"page"===l&&(f+=this._topIndexY);a.style.top=-f+"px";a.style.height=k+f+"px";a.rulerChanged&&d(g.getRulerStyle(),a);var s,m=a.firstChild;m?(s=m,m=m.nextSibling):(s=e.createElement(n,"div"),s.style.visibility="hidden",a.appendChild(s));var u;if(a.rulerChanged&&s){f=-1;if(u=g.getWidestAnnotation())d(u.style,
s),u.html&&(s.innerHTML=u.html);s.lineIndex=f;s.style.height=p+h.top+"px"}var v;if("page"===l){for(g=g.getAnnotations(c,b+1);m;)f=m.lineIndex,u=m.nextSibling,(!(c<=f&&f<=b)||m.lineChanged)&&a.removeChild(m),m=u;m=a.firstChild.nextSibling;v=n.createDocumentFragment();for(f=c;f<=b;f++)if(!m||m.lineIndex>f){s=e.createElement(n,"div");if(u=g[f])d(u.style,s),u.html&&(s.innerHTML=u.html),s.annotation=u;s.lineIndex=f;s.style.height=this._getLineHeight(f)+"px";v.appendChild(s)}else v.firstChild&&(a.insertBefore(v,
m),v=n.createDocumentFragment()),m&&(m=m.nextSibling);v.firstChild&&a.insertBefore(v,m)}else{u=this._getClientHeight();f=this._model.getLineCount();m=u+h.top+h.bottom-2*this._metrics.scrollWidth;l=p*f<m?p:m/f;if(a.rulerChanged){for(u=a.childNodes.length;1<u;)a.removeChild(a.lastChild),u--;g=g.getAnnotations(0,f);v=n.createDocumentFragment();for(var w in g)f=w>>>0,0>f||(s=e.createElement(n,"div"),u=g[w],d(u.style,s),s.style.position="absolute",s.style.top=this._metrics.scrollWidth+p+Math.floor(f*l)+
"px",u.html&&(s.innerHTML=u.html),s.annotation=u,s.lineIndex=f,v.appendChild(s));a.appendChild(v)}else if(a._oldTrackHeight!==m)for(s=a.firstChild?a.firstChild.nextSibling:null;s;)s.style.top=this._metrics.scrollWidth+p+Math.floor(s.lineIndex*l)+"px",s=s.nextSibling;a._oldTrackHeight=m}a.rulerChanged=!1;a=a.nextSibling}},_updateStyleSheet:function(){var a="";e.isWebkit&&0<this._metrics.scrollWidth&&(a+="\n.textview ::-webkit-scrollbar-corner {background: #eeeeee;}");e.isFirefox&&(e.isMac&&this._highlightRGB&&
"Highlight"!==this._highlightRGB)&&(a+="\n.textview ::-moz-selection {background: "+this._highlightRGB+";}");if(a){var c=document.getElementById("_textviewStyle");if(c)c.removeChild(c.firstChild),c.appendChild(document.createTextNode(a));else{c=e.createElement(document,"style");c.id="_textviewStyle";var b=document.getElementsByTagName("head")[0]||document.documentElement;c.appendChild(document.createTextNode(a));b.insertBefore(c,b.firstChild)}}},_updateStyle:function(a){!a&&e.isIE&&(this._rootDiv.style.lineHeight=
"normal");var c=this._metrics=this._calculateMetrics();this._rootDiv.style.lineHeight=e.isIE?c.lineHeight-(c.lineTrim.top+c.lineTrim.bottom)+"px":"normal";this._updateStyleSheet();a||(this.redraw(),this._resetLineWidth())}};b.EventTarget.addMixin(y.prototype);return{TextView:y}});
define("orion/editor/projectionTextModel",["orion/editor/textModel","orion/editor/eventTarget"],function(f,m){function q(b){this._model=b;this._projections=[];var f=this;this._listener={onChanged:function(b){f._onChanged(b)},onChanging:function(b){f._onChanging(b)}};b.addEventListener("postChanged",this._listener.onChanged);b.addEventListener("preChanging",this._listener.onChanging)}q.prototype={destroy:function(){this._model&&(this._model.removeEventListener("postChanged",this._listener.onChanged),
this._model.removeEventListener("preChanging",this._listener.onChanging),this._model=null)},addProjection:function(b){if(b){var l=this._model,g=this._projections;b._lineIndex=l.getLineAtOffset(b.start);b._lineCount=l.getLineAtOffset(b.end)-b._lineIndex;var e=b.text;e||(e="");b._model="string"===typeof e?new f.TextModel(e,l.getLineDelimiter()):e;var l=this.mapOffset(b.start,!0),e=b.end-b.start,d=b._lineCount,h=b._model.getCharCount(),c=b._model.getLineCount()-1,a={type:"Changing",text:b._model.getText(),
start:l,removedCharCount:e,addedCharCount:h,removedLineCount:d,addedLineCount:c};this.onChanging(a);a=this._binarySearch(g,b.start);g.splice(a,0,b);this.onChanged({type:"Changed",start:l,removedCharCount:e,addedCharCount:h,removedLineCount:d,addedLineCount:c})}},getProjections:function(){return this._projections.slice(0)},getBaseModel:function(){return this._model},mapOffset:function(b,f){var g=this._projections,e=0,d,h;if(f){for(d=0;d<g.length;d++){h=g[d];if(h.start>b)break;if(h.end>b)return-1;e+=
h._model.getCharCount()-(h.end-h.start)}return b+e}for(d=0;d<g.length;d++){h=g[d];if(h.start>b-e)break;var c=h._model.getCharCount();if(h.start+c>b-e)return-1;e+=c-(h.end-h.start)}return b-e},removeProjection:function(b){var f,g=0;for(f=0;f<this._projections.length;f++){var e=this._projections[f];if(e===b){b=e;break}g+=e._model.getCharCount()-(e.end-e.start)}if(f<this._projections.length){var e=this._model,g=b.start+g,d=b.end-b.start,h=b._lineCount,c=b._model.getCharCount(),a=b._model.getLineCount()-
1,b={type:"Changing",text:e.getText(b.start,b.end),start:g,removedCharCount:c,addedCharCount:d,removedLineCount:a,addedLineCount:h};this.onChanging(b);this._projections.splice(f,1);this.onChanged({type:"Changed",start:g,removedCharCount:c,addedCharCount:d,removedLineCount:a,addedLineCount:h})}},_binarySearch:function(b,f){for(var g=b.length,e=-1,d;1<g-e;)d=Math.floor((g+e)/2),f<=b[d].start?g=d:e=d;return g},getCharCount:function(){for(var b=this._model.getCharCount(),f=this._projections,g=0;g<f.length;g++)var e=
f[g],b=b+(e._model.getCharCount()-(e.end-e.start));return b},getLine:function(b,f){if(0>b)return null;var g=this._model,e=this._projections,d=0,h=[],c=0,a,k,n;for(a=0;a<e.length;a++){n=e[a];if(n._lineIndex>=b-d)break;k=n._model.getLineCount()-1;if(n._lineIndex+k>=b-d){c=b-(n._lineIndex+d);if(c<k)return n._model.getLine(c,f);h.push(n._model.getLine(k))}c=n.end;d+=k-n._lineCount}for(c=Math.max(c,g.getLineStart(b-d));a<e.length;a++){n=e[a];if(n._lineIndex>b-d)break;h.push(g.getText(c,n.start));k=n._model.getLineCount()-
1;if(n._lineIndex+k>b-d)return h.push(n._model.getLine(0,f)),h.join("");h.push(n._model.getText());c=n.end;d+=k-n._lineCount}e=g.getLineEnd(b-d,f);c<e&&h.push(g.getText(c,e));return h.join("")},getLineAtOffset:function(b){for(var f=this._model,g=this._projections,e=0,d=0,h=0;h<g.length;h++){var c=g[h];if(c.start>b-e)break;var a=c._model.getCharCount();if(c.start+a>b-e){g=b-(c.start+e);d+=c._model.getLineAtOffset(g);e+=g;break}d+=c._model.getLineCount()-1-c._lineCount;e+=a-(c.end-c.start)}return f.getLineAtOffset(b-
e)+d},getLineCount:function(){for(var b=this._projections,f=this._model.getLineCount(),g=0;g<b.length;g++)var e=b[g],f=f+(e._model.getLineCount()-1-e._lineCount);return f},getLineDelimiter:function(){return this._model.getLineDelimiter()},getLineEnd:function(b,f){if(0>b)return-1;for(var g=this._model,e=this._projections,d=0,h=0,c=0;c<e.length;c++){var a=e[c];if(a._lineIndex>b-d)break;var k=a._model.getLineCount()-1;if(a._lineIndex+k>b-d)return a._model.getLineEnd(b-(a._lineIndex+d),f)+a.start+h;h+=
a._model.getCharCount()-(a.end-a.start);d+=k-a._lineCount}return g.getLineEnd(b-d,f)+h},getLineStart:function(b){if(0>b)return-1;for(var f=this._model,g=this._projections,e=0,d=0,h=0;h<g.length;h++){var c=g[h];if(c._lineIndex>=b-e)break;var a=c._model.getLineCount()-1;if(c._lineIndex+a>=b-e)return c._model.getLineStart(b-(c._lineIndex+e))+c.start+d;d+=c._model.getCharCount()-(c.end-c.start);e+=a-c._lineCount}return f.getLineStart(b-e)+d},getText:function(b,f){void 0===b&&(b=0);var g=this._model,e=
this._projections,d=0,h=[],c,a,k;for(c=0;c<e.length;c++){a=e[c];if(a.start>b-d)break;k=a._model.getCharCount();if(a.start+k>b-d){if(void 0!==f&&a.start+k>f-d)return a._model.getText(b-(a.start+d),f-(a.start+d));h.push(a._model.getText(b-(a.start+d)));b=a.end+d+k-(a.end-a.start)}d+=k-(a.end-a.start)}var n=b-d;if(void 0!==f){for(;c<e.length;c++){a=e[c];if(a.start>f-d)break;h.push(g.getText(n,a.start));k=a._model.getCharCount();if(a.start+k>f-d)return h.push(a._model.getText(0,f-(a.start+d))),h.join("");
h.push(a._model.getText());n=a.end;d+=k-(a.end-a.start)}h.push(g.getText(n,f-d))}else{for(;c<e.length;c++)a=e[c],h.push(g.getText(n,a.start)),h.push(a._model.getText()),n=a.end;h.push(g.getText(n))}return h.join("")},_onChanged:function(){var b=this._change,f=b.baseStart,g=b.baseEnd,e,d,h=this._projections;for(e=0;e<h.length&&!(d=h[e],d.end>f);e++);var c=e;for(e=0;e<h.length&&!(d=h[e],d.start>=g);e++);var a=e,k=this._model,f=b.baseText.length-(g-f);for(e=a;e<h.length;e++)d=h[e],d.start+=f,d.end+=
f,d._lineIndex=k.getLineAtOffset(d.start);d=h.splice(c,a-c);for(e=0;e<d.length;e++)d[e].annotation&&d[e].annotation._expand();this.onChanged({type:"Changed",start:b.start,removedCharCount:b.removedCharCount,addedCharCount:b.addedCharCount,removedLineCount:b.removedLineCount,addedLineCount:b.addedLineCount});this._change=void 0},_onChanging:function(b){var f=!!this._change,g=this._change||{},e=b.start,d=e+b.removedCharCount;g.baseStart=e;g.baseEnd=d;g.baseText=b.text;g.addedLineCount=b.addedLineCount;
if(!f){this._change=g;g.text=b.text;var h=this._projections,c,a,k,b=function(b){for(c=a=0;a<h.length;a++){k=h[a];if(k.start>b)break;if(k.end>b)return-1;c+=k._model.getCharCount()-(k.end-k.start)}return b+c};g.start=b(e);-1===g.start&&(g.text=this._model.getText(k.start,e)+g.text,g.addedLineCount+=this._model.getLineAtOffset(e)-this._model.getLineAtOffset(k.start),g.start=k.start+c);g.end=b(d);-1===g.end&&(g.text+=this._model.getText(d,k.end),g.addedLineCount+=this._model.getLineAtOffset(k.end)-this._model.getLineAtOffset(d),
g.end=k.start+c)}g.addedCharCount=g.text.length;g.removedCharCount=g.end-g.start;g.removedLineCount=this.getLineAtOffset(g.end)-this.getLineAtOffset(g.start);this.onChanging({type:"Changing",text:g.text,start:g.start,removedCharCount:g.removedCharCount,addedCharCount:g.addedCharCount,removedLineCount:g.removedLineCount,addedLineCount:g.addedLineCount})},onChanging:function(b){return this.dispatchEvent(b)},onChanged:function(b){return this.dispatchEvent(b)},setLineDelimiter:function(b){this._model.setLineDelimiter(b)},
setText:function(b,f,g){function e(b){for(h=c=0;c<d.length;c++){a=d[c];if(a.start>b-h)break;var k=a._model.getCharCount();if(a.start+k>b-h)return-1;h+=k-(a.end-a.start)}return b-h}this._change={text:b||"",start:f||0,end:void 0===g?this.getCharCount():g};var d=this._projections,h,c,a,k,n,b=e(this._change.start);-1===b&&(k={projection:a,start:this._change.start-(a.start+h)},b=a.end);f=e(this._change.end);-1===f&&(n={projection:a,end:this._change.end-(a.start+h)},f=a.start);k&&n&&k.projection===n.projection?
a._model.setText(this._change.text,k.start,n.end):(this._model.setText(this._change.text,b,f),k&&(a=k.projection,a._model.setText("",k.start)),n&&(a=n.projection,a._model.setText("",0,n.end),a.start=a.end,a._lineCount=0));this._change=void 0}};m.EventTarget.addMixin(q.prototype);return{ProjectionTextModel:q}});
define("orion/editor/tooltip","i18n!orion/editor/nls/messages orion/editor/textView orion/editor/textModel orion/editor/projectionTextModel orion/editor/util orion/util".split(" "),function(f,m,q,b,l,g){function e(b){this._view=b;this._fadeDelay=500;this._hideDelay=200;this._showDelay=500;this._autoHideDelay=5E3;this._create(b.getOptions("parent").ownerDocument)}e.getTooltip=function(b){b._tooltip||(b._tooltip=new e(b));return b._tooltip};e.prototype={_create:function(b){if(!this._tooltipDiv){var e=
this._tooltipDiv=g.createElement(b,"div");e.tabIndex=0;e.className="textviewTooltip";e.setAttribute("aria-live","assertive");e.setAttribute("aria-atomic","true");var c=this._tooltipContents=g.createElement(b,"div");e.appendChild(c);b.body.appendChild(e);var a=this;l.addEventListener(e,"mouseover",function(){if(a._hideDelay){var c=a._getWindow();a._delayedHideTimeout&&(c.clearTimeout(a._delayedHideTimeout),a._delayedHideTimeout=null);a._hideTimeout&&(c.clearTimeout(a._hideTimeout),a._hideTimeout=null);
a._nextTarget=null}},!1);l.addEventListener(e,"mouseout",function(c){c=c.relatedTarget||c.toElement;!(c===e||a._hasFocus())&&(!c||!l.contains(e,c))&&a._hide()},!1);l.addEventListener(e,"keydown",function(c){27===c.keyCode&&a._hide()},!1);l.addEventListener(b,"mousedown",this._mouseDownHandler=function(c){a.isVisible()&&(l.contains(e,c.target||c.srcElement)||a._hide())},!0);this._view.addEventListener("Destroy",function(){a.destroy()});this._hide()}},_getWindow:function(){var b=this._tooltipDiv.ownerDocument;
return b.defaultView||b.parentWindow},destroy:function(){if(this._tooltipDiv){this._hide();var b=this._tooltipDiv.parentNode;b&&b.removeChild(this._tooltipDiv);l.removeEventListener(this._tooltipDiv.ownerDocument,"mousedown",this._mouseDownHandler,!0);this._tooltipDiv=null}},_hasFocus:function(){var b=this._tooltipDiv;return!b?!1:l.contains(b,b.ownerDocument.activeElement)},hide:function(b){void 0===b&&(b=this._hideDelay);var e=this._getWindow();this._delayedHideTimeout&&(e.clearTimeout(this._delayedHideTimeout),
this._delayedHideTimeout=null);var c=this;b?c._delayedHideTimeout=e.setTimeout(function(){c._delayedHideTimeout=null;c._hide();c.setTarget(c._nextTarget,0)},b):(c._hide(),c.setTarget(c._nextTarget,0))},_hide:function(){var b=this._tooltipDiv;b&&(this._hasFocus()&&this._view.focus(),this._contentsView&&(this._contentsView.destroy(),this._contentsView=null),this._tooltipContents&&(this._tooltipContents.innerHTML=""),b.style.visibility="hidden",b=this._getWindow(),this._showTimeout&&(b.clearTimeout(this._showTimeout),
this._showTimeout=null),this._delayedHideTimeout&&(b.clearTimeout(this._delayedHideTimeout),this._delayedHideTimeout=null),this._hideTimeout&&(b.clearTimeout(this._hideTimeout),this._hideTimeout=null),this._fadeTimeout&&(b.clearInterval(this._fadeTimeout),this._fadeTimeout=null))},isVisible:function(){return this._tooltipDiv&&"visible"===this._tooltipDiv.style.visibility},setTarget:function(b,e,c){if(this.isVisible())this._hasFocus()||(this._nextTarget=b,this.hide(c));else if(this._target=b){var a=
this,b=a._getWindow();a._showTimeout&&(b.clearTimeout(a._showTimeout),a._showTimeout=null);0===e?a.show(!0):a._showTimeout=b.setTimeout(function(){a._showTimeout=null;a.show(!0)},e?e:a._showDelay)}},show:function(d){if(this._target){var e=this._target.getTooltipInfo();if(e){var c=this._tooltipDiv,a=this._tooltipContents;c.style.left=c.style.right=c.style.width=c.style.height=a.style.width=a.style.height="auto";var k=e.contents;k instanceof Array&&(k=this._getAnnotationContents(k));if("string"===typeof k)a.innerHTML=
k;else if(this._isNode(k))a.appendChild(k);else if(k instanceof b.ProjectionTextModel){var n=this._view,p=n.getOptions();p.wrapMode=!1;p.parent=a;var f=p.themeClass;f?((f=f.replace("tooltipTheme",""))&&(f=" "+f),f="tooltipTheme"+f):f="tooltipTheme";p.themeClass=f;p=this._contentsView=new m.TextView(p);p.addEventListener("LineStyle",function(a){n.onLineStyle(a)});p.setModel(k);k=p.computeSize();a.style.width=k.width+"px";a.style.height=k.height+"px";p.resize()}else return;a=c.ownerDocument.documentElement;
"right"===e.anchor?(k=a.clientWidth-e.x,c.style.right=k+"px"):(k=parseInt(this._getNodeStyle(c,"padding-left","0"),10),k+=parseInt(this._getNodeStyle(c,"border-left-width","0"),10),k=e.x-k,c.style.left=k+"px");c.style.maxWidth=a.clientWidth-k-10+"px";k=parseInt(this._getNodeStyle(c,"padding-top","0"),10);k+=parseInt(this._getNodeStyle(c,"border-top-width","0"),10);k=e.y-k;c.style.top=k+"px";c.style.maxHeight=a.clientHeight-k-10+"px";c.style.opacity="1";c.style.visibility="visible";if(d){var g=this,
l=this._getWindow();g._hideTimeout=l.setTimeout(function(){g._hideTimeout=null;var a=parseFloat(g._getNodeStyle(c,"opacity","1"));g._fadeTimeout=l.setInterval(function(){"visible"===c.style.visibility&&0<a?(a-=0.1,c.style.opacity=a):g._hide()},g._fadeDelay/10)},g._autoHideDelay)}}}},_getAnnotationContents:function(d){function e(a){var c=a.title,b=g.createElement(p,"div");b.className="tooltipRow";a.html&&(b.innerHTML=a.html,b.lastChild&&l.addEventListener(b.lastChild,"click",function(){var c=a.start,
b=a.end;s.getBaseModel&&(c=s.mapOffset(c,!0),b=s.mapOffset(b,!0));m.setSelection(c,b,1/3,function(){n._hide()})},!1),b.appendChild(p.createTextNode("\u00a0")));if(!c)var d=a.end,c=w.getLineStart(w.getLineAtOffset(a.start)),d=w.getLineEnd(w.getLineAtOffset(d),!0),c=w.getText(c,d);"function"===typeof c&&(c=a.title());"string"===typeof c&&(d=g.createElement(p,"span"),d.appendChild(p.createTextNode(c)),c=d);b.appendChild(c);return b}for(var c,a=[],k=0;k<d.length;k++)c=d[k],""!==c.title&&!c.groupAnnotation&&
a.push(c);d=a;if(0===d.length)return null;var n=this,p=this._tooltipDiv.ownerDocument,m=this._view,s=m.getModel(),w=s.getBaseModel?s.getBaseModel():s;if(1===d.length){c=d[0];if(void 0!==c.title)return c=e(c),c.firstChild&&((d=c.firstChild.className)&&(d+=" "),c.firstChild.className=d+"single"),c;d=new b.ProjectionTextModel(w);a=w.getLineStart(w.getLineAtOffset(c.start));k=w.getCharCount();c.end!==k&&d.addProjection({start:c.end,end:k});0<a&&d.addProjection({start:0,end:a});return d}a=g.createElement(p,
"div");c=g.createElement(p,"em");c.appendChild(p.createTextNode(f.multipleAnnotations));a.appendChild(c);for(k=0;k<d.length;k++)c=d[k],(c=e(c))&&a.appendChild(c);return a},_getNodeStyle:function(b,e,c){var a;if(b&&(a=b.style[e],!a))if(b.currentStyle){for(a=0;-1!==(a=e.indexOf("-",a));)e=e.substring(0,a)+e.substring(a+1,a+2).toUpperCase()+e.substring(a+2);a=b.currentStyle[e]}else a=(b=b.ownerDocument.defaultView.getComputedStyle(b,null))?b.getPropertyValue(e):null;return a||c},_isNode:function(b){return"object"===
typeof Node?b instanceof Node:b&&"object"===typeof b&&"number"===typeof b.nodeType&&"string"===typeof b.nodeName}};return{Tooltip:e}});
define("orion/editor/annotations",["i18n!orion/editor/nls/messages","orion/editor/eventTarget"],function(f,m){function q(c,a,b){this.start=c;this.end=a;this._projectionModel=b;this.html=this._expandedHTML;this.style=this._expandedStyle;this.expanded=!0}function b(){}function l(c,a){var d=c.lastIndexOf("."),d=c.substring(d+1),e={title:f[d],style:{styleClass:"annotation "+d},html:"<div class='annotationHTML "+d+"'></div>",overviewStyle:{styleClass:"annotationOverview "+d}};a?e.lineStyle={styleClass:"annotationLine "+
d}:e.rangeStyle={styleClass:"annotationRange "+d};b.registerType(c,e)}function g(){}function e(c){this._annotations=[];var a=this;this._listener={onChanged:function(c){a._onChanged(c)}};this.setTextModel(c)}function d(c,a){this._view=c;this._annotationModel=a;var b=this;this._listener={onDestroy:function(a){b._onDestroy(a)},onLineStyle:function(a){b._onLineStyle(a)},onChanged:function(a){b._onAnnotationModelChanged(a)}};c.addEventListener("Destroy",this._listener.onDestroy);c.addEventListener("postLineStyle",
this._listener.onLineStyle);a.addEventListener("Changed",this._listener.onChanged)}q.prototype={_expandedHTML:"<div class='annotationHTML expanded'></div>",_expandedStyle:{styleClass:"annotation expanded"},_collapsedHTML:"<div class='annotationHTML collapsed'></div>",_collapsedStyle:{styleClass:"annotation collapsed"},_collapse:function(){if(!this.expanded)return!1;this.expanded=!1;this.html=this._collapsedHTML;this.style=this._collapsedStyle;this._annotationModel&&this._annotationModel.modifyAnnotation(this);
return!0},_expand:function(){if(this.expanded)return!1;this.expanded=!0;this.html=this._expandedHTML;this.style=this._expandedStyle;this._annotationModel&&this._annotationModel.modifyAnnotation(this);return!0},collapse:function(){if(this._collapse()){var c=this._projectionModel,a=c.getBaseModel();this._projection={annotation:this,start:a.getLineStart(a.getLineAtOffset(this.start)+1),end:a.getLineEnd(a.getLineAtOffset(this.end),!0)};c.addProjection(this._projection)}},expand:function(){this._expand()&&
this._projectionModel.removeProjection(this._projection)}};b.ANNOTATION_ERROR="orion.annotation.error";b.ANNOTATION_WARNING="orion.annotation.warning";b.ANNOTATION_TASK="orion.annotation.task";b.ANNOTATION_BREAKPOINT="orion.annotation.breakpoint";b.ANNOTATION_BOOKMARK="orion.annotation.bookmark";b.ANNOTATION_FOLDING="orion.annotation.folding";b.ANNOTATION_CURRENT_BRACKET="orion.annotation.currentBracket";b.ANNOTATION_MATCHING_BRACKET="orion.annotation.matchingBracket";b.ANNOTATION_CURRENT_LINE="orion.annotation.currentLine";
b.ANNOTATION_CURRENT_SEARCH="orion.annotation.currentSearch";b.ANNOTATION_MATCHING_SEARCH="orion.annotation.matchingSearch";b.ANNOTATION_READ_OCCURRENCE="orion.annotation.readOccurrence";b.ANNOTATION_WRITE_OCCURRENCE="orion.annotation.writeOccurrence";b.ANNOTATION_SELECTED_LINKED_GROUP="orion.annotation.selectedLinkedGroup";b.ANNOTATION_CURRENT_LINKED_GROUP="orion.annotation.currentLinkedGroup";b.ANNOTATION_LINKED_GROUP="orion.annotation.linkedGroup";b.ANNOTATION_BLAME="orion.annotation.blame";b.ANNOTATION_CURRENT_BLAME=
"orion.annotation.currentBlame";var h={};b.registerType=function(c,a){var b=a;"function"!==typeof b&&(b=function(a,c,b){this.start=a;this.end=c;void 0!==b&&(this.title=b)},b.prototype=a);b.prototype.type=c;h[c]=b;return c};b.createAnnotation=function(c,a,b,d){return new (this.getType(c))(a,b,d)};b.getType=function(c){return h[c]};l(b.ANNOTATION_ERROR);l(b.ANNOTATION_WARNING);l(b.ANNOTATION_TASK);l(b.ANNOTATION_BREAKPOINT);l(b.ANNOTATION_BOOKMARK);l(b.ANNOTATION_CURRENT_BRACKET);l(b.ANNOTATION_MATCHING_BRACKET);
l(b.ANNOTATION_CURRENT_SEARCH);l(b.ANNOTATION_MATCHING_SEARCH);l(b.ANNOTATION_READ_OCCURRENCE);l(b.ANNOTATION_WRITE_OCCURRENCE);l(b.ANNOTATION_SELECTED_LINKED_GROUP);l(b.ANNOTATION_CURRENT_LINKED_GROUP);l(b.ANNOTATION_LINKED_GROUP);l(b.ANNOTATION_CURRENT_LINE,!0);l(b.ANNOTATION_BLAME,!0);l(b.ANNOTATION_CURRENT_BLAME,!0);b.registerType(b.ANNOTATION_FOLDING,q);g.addMixin=function(c){var a=g.prototype,b;for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b])};g.prototype={addAnnotationType:function(c){this._annotationTypes||
(this._annotationTypes=[]);this._annotationTypes.push(c)},getAnnotationTypePriority:function(c){if(this._annotationTypes)for(var a=0;a<this._annotationTypes.length;a++)if(this._annotationTypes[a]===c)return a+1;return 0},getAnnotationsByType:function(c,a,b){c=c.getAnnotations(a,b);for(b=[];c.hasNext();)a=c.next(),0!==this.getAnnotationTypePriority(a.type)&&b.push(a);var d=this;b.sort(function(a,c){return d.getAnnotationTypePriority(a.type)-d.getAnnotationTypePriority(c.type)});return b},isAnnotationTypeVisible:function(c){return 0!==
this.getAnnotationTypePriority(c)},removeAnnotationType:function(c){if(this._annotationTypes)for(var a=0;a<this._annotationTypes.length;a++)if(this._annotationTypes[a]===c){this._annotationTypes.splice(a,1);break}}};e.prototype={addAnnotation:function(c){if(c){var a=this._annotations,b=this._binarySearch(a,c.start);a.splice(b,0,c);c._annotationModel=this;this.onChanged({type:"Changed",added:[c],removed:[],changed:[]})}},getTextModel:function(){return this._model},getAnnotations:function(c,a){var b=
this._annotations,d,e=0,h;h=void 0===c&&void 0===a?function(){return e<b.length?b[e++]:null}:function(){for(;e<b.length;){var d=b[e++];if(c===d.start||(c>d.start?c<d.end:d.start<a))return d;if(d.start>=a)break}return null};d=h();return{next:function(){var a=d;a&&(d=h());return a},hasNext:function(){return null!==d}}},modifyAnnotation:function(c){if(c&&!(0>this._getAnnotationIndex(c)))this.onChanged({type:"Changed",added:[],removed:[],changed:[c]})},onChanged:function(c){return this.dispatchEvent(c)},
removeAnnotations:function(c){var a=this._annotations,b,d;if(c){b=[];for(d=a.length-1;0<=d;d--){var e=a[d];e.type===c&&(a.splice(d,1),b.splice(0,0,e),e._annotationModel=null)}}else b=a;this.onChanged({type:"Changed",removed:b,added:[],changed:[]})},removeAnnotation:function(c){if(c){var a=this._getAnnotationIndex(c);0>a||(c._annotationModel=null,c={type:"Changed",removed:this._annotations.splice(a,1),added:[],changed:[]},this.onChanged(c))}},replaceAnnotations:function(c,a){var b=this._annotations,
d,e,h,f=[];if(c)for(d=c.length-1;0<=d;d--)h=c[d],e=this._getAnnotationIndex(h),0>e||(h._annotationModel=null,b.splice(e,1),f.splice(0,0,h));a||(a=[]);for(d=0;d<a.length;d++)h=a[d],e=this._binarySearch(b,h.start),h._annotationModel=this,b.splice(e,0,h);this.onChanged({type:"Changed",removed:f,added:a,changed:[]})},setTextModel:function(c){this._model&&this._model.removeEventListener("Changed",this._listener.onChanged);(this._model=c)&&this._model.addEventListener("Changed",this._listener.onChanged)},
_binarySearch:function(c,a){for(var b=c.length,d=-1,e;1<b-d;)e=Math.floor((b+d)/2),a<=c[e].start?b=e:d=e;return b},_getAnnotationIndex:function(c){for(var a=this._annotations,b=this._binarySearch(a,c.start);b<a.length&&a[b].start===c.start;){if(a[b]===c)return b;b++}return-1},_onChanged:function(c){var a=c.start,b=c.addedCharCount,d=c.removedCharCount,e=this._annotations,h=a+d;if(0<e.length){c={type:"Changed",added:[],removed:[],changed:[],textModelChangedEvent:c};b-=d;for(d=0;d<e.length;d++){var f=
e[d];f.start>=h?(f._oldStart=f.start,f._oldEnd=f.end,f.start+=b,f.end+=b,c.changed.push(f)):f.end<=a||(f.start<a&&h<f.end?(f._oldStart=f.start,f._oldEnd=f.end,f.end+=b,c.changed.push(f)):(e.splice(d,1),c.removed.push(f),f._annotationModel=null,f.expand&&f.expand(),d--))}if(0<c.added.length||0<c.removed.length||0<c.changed.length)this.onChanged(c)}}};m.EventTarget.addMixin(e.prototype);d.prototype={destroy:function(){var c=this._view;c&&(c.removeEventListener("Destroy",this._listener.onDestroy),c.removeEventListener("LineStyle",
this._listener.onLineStyle),this.view=null);(c=this._annotationModel)&&c.removeEventListener("Changed",this._listener.onChanged)},_mergeStyle:function(c,a){if(a){c||(c={});c.styleClass=c.styleClass&&a.styleClass&&c.styleClass!==a.styleClass?c.styleClass+(" "+a.styleClass):a.styleClass;var b;a.tagName&&!c.tagName&&(c.tagName=a.tagName);if(a.style)for(b in c.style||(c.style={}),a.style)c.style[b]||(c.style[b]=a.style[b]);if(a.attributes)for(b in c.attributes||(c.attributes={}),a.attributes)c.attributes[b]||
(c.attributes[b]=a.attributes[b])}return c},_mergeStyleRanges:function(c,a){c||(c=[]);var b,d;for(d=0;d<c.length&&a;d++){var e=c[d];if(a.end<=e.start)break;if(!(a.start>=e.end)){b=this._mergeStyle({},e.style);b=this._mergeStyle(b,a.style);var h=[];h.push(d,1);a.start<e.start&&h.push({start:a.start,end:e.start,style:a.style});a.start>e.start&&h.push({start:e.start,end:a.start,style:e.style});h.push({start:Math.max(e.start,a.start),end:Math.min(e.end,a.end),style:b});a.end<e.end&&h.push({start:a.end,
end:e.end,style:e.style});a=a.end>e.end?{start:e.end,end:a.end,style:a.style}:null;Array.prototype.splice.apply(c,h)}}a&&(b=this._mergeStyle({},a.style),c.splice(d,0,{start:a.start,end:a.end,style:b}));return c},_onAnnotationModelChanged:function(c){function a(a,c){h.getBaseModel&&(a=h.mapOffset(a,!0),c=h.mapOffset(c,!0));-1!==a&&-1!==c&&d.redrawRange(a,c)}function b(c,d){for(var k=0;k<c.length;k++)if(e.isAnnotationTypeVisible(c[k].type)){var n=c[k];a(n.start,n.end);d&&(void 0!==n._oldStart&&n._oldEnd)&&
a(n._oldStart,n._oldEnd)}}var d=this._view;if(d){var e=this,h=d.getModel();b(c.added);b(c.removed);b(c.changed,!0)}},_onDestroy:function(){this.destroy()},_onLineStyle:function(c){var a=this._annotationModel,b=c.textView.getModel(),d=a.getTextModel(),e=c.lineStart,h=c.lineStart+c.lineText.length;d!==b&&(e=b.mapOffset(e),h=b.mapOffset(h));for(a=a.getAnnotations(e,h);a.hasNext();)if(e=a.next(),this.isAnnotationTypeVisible(e.type)){if(e.rangeStyle){var h=e.start,f=e.end;d!==b&&(h=b.mapOffset(h,!0),f=
b.mapOffset(f,!0));c.ranges=this._mergeStyleRanges(c.ranges,{start:h,end:f,style:e.rangeStyle})}e.lineStyle&&(c.style=this._mergeStyle({},c.style),c.style=this._mergeStyle(c.style,e.lineStyle))}}};g.addMixin(d.prototype);return{FoldingAnnotation:q,AnnotationType:b,AnnotationTypeList:g,AnnotationModel:e,AnnotationStyler:d}});
define("orion/editor/editor","i18n!orion/editor/nls/messages orion/editor/eventTarget orion/editor/tooltip orion/editor/annotations orion/objects orion/util".split(" "),function(f,m,q,b,l,g){function e(c){c=c||{};this._domNode=c.domNode;this._model=c.model;this._undoStack=c.undoStack;this._statusReporter=c.statusReporter;this._title=null;var a=this;this._listener={onChanged:function(c){a.onChanged(c)}};this._model&&this._model.addEventListener("Changed",this._listener.onChanged);this.checkDirty()}
function d(c){c=c||{};e.call(this,c);this._textViewFactory=c.textViewFactory;this._undoStackFactory=c.undoStackFactory;this._textDNDFactory=c.textDNDFactory;this._annotationFactory=c.annotationFactory;this._foldingRulerFactory=c.foldingRulerFactory;this._lineNumberRulerFactory=c.lineNumberRulerFactory;this._contentAssistFactory=c.contentAssistFactory;this._keyBindingFactory=c.keyBindingFactory;this._contentAssist=this._foldingRuler=this._overviewRuler=this._lineNumberRuler=this._annotationRuler=this._annotationModel=
this._annotationStyler=null}var h=b.AnnotationType;e.prototype={destroy:function(){this.uninstall();this._statusReporter=this._domNode=null;this._model&&this._model.removeEventListener("Changed",this._listener.onChanged)},checkDirty:function(){this.setDirty(this._undoStack&&!this._undoStack.isClean())},focus:function(){},getModel:function(){return this._model},getText:function(c,a){return this.getModel().getText(c,a)},getTitle:function(){return this._title},getUndoStack:function(){return this._undoStack},
install:function(){this.installed=!0},isDirty:function(){return this._dirty},markClean:function(){this.getUndoStack().markClean();this.setDirty(!1)},onDirtyChanged:function(c){return this.dispatchEvent(c)},onInputChanged:function(c){return this.dispatchEvent(c)},onChanged:function(){this.checkDirty()},reportStatus:function(c,a,b){this._statusReporter&&this._statusReporter(c,a,b)},resize:function(){},setDirty:function(c){this._dirty!==c&&(this._dirty=c,this.onDirtyChanged({type:"DirtyChanged"}))},
_setModelText:function(c){this._model&&this._model.setText(c)},setInput:function(c,a,b,d){this._title=c;d||(a?this.reportStatus(a,"error"):null!==b&&(void 0!==b&&"string"===typeof b)&&this._setModelText(b),this._undoStack&&this._undoStack.reset());this.checkDirty();this.onInputChanged({type:"InputChanged",title:c,message:a,contents:b,contentsSaved:d})},setText:function(c,a,b){this.getModel().setText(c,a,b)},uninstall:function(){this.installed=!1}};m.EventTarget.addMixin(e.prototype);d.prototype=new e;
l.mixin(d.prototype,{destroy:function(){e.prototype.destroy.call(this);this._textViewFactory=this._undoStackFactory=this._textDNDFactory=this._annotationFactory=this._foldingRulerFactory=this._lineNumberRulerFactory=this._contentAssistFactory=this._keyBindingFactory=null},getAnnotationModel:function(){return this._annotationModel},getAnnotationRuler:function(){return this._annotationRuler},getAnnotationStyler:function(){return this._annotationStyler},getContentAssist:function(){return this._contentAssist},
getFoldingRuler:function(){return this._foldingRuler},getLineNumberRuler:function(){return this._lineNumberRuler},getModel:function(){if(!this._textView)return null;var c=this._textView.getModel();c.getBaseModel&&(c=c.getBaseModel());return c},getOverviewRuler:function(){return this._overviewRuler},getTextView:function(){return this._textView},getKeyModes:function(){return this._textView.getKeyModes()},getSourceCodeActions:function(){return this._sourceCodeActions},getLinkedMode:function(){return this._linkedMode},
getTextActions:function(){return this._textActions},focus:function(){this._textView&&this._textView.focus()},resize:function(){this._textView&&this._textView.resize()},setAnnotationRulerVisible:function(c,a){if(this._annotationRulerVisible!==c||a)if(this._annotationRulerVisible=c,this._annotationRuler){var b=this._textView;c?b.addRuler(this._annotationRuler,0):b.removeRuler(this._annotationRuler)}},setFoldingRulerVisible:function(c,a){if(this._foldingRulerVisible!==c||a)if(this._foldingRulerVisible=
c,this._foldingRuler){var b=this._textView;b.getModel().getBaseModel&&(c?b.addRuler(this._foldingRuler):b.removeRuler(this._foldingRuler))}},setLineNumberRulerVisible:function(c,a){if(this._lineNumberRulerVisible!==c||a)if(this._lineNumberRulerVisible=c,this._lineNumberRuler){var b=this._textView;c?b.addRuler(this._lineNumberRuler,!this._annotationRulerVisible?0:1):b.removeRuler(this._lineNumberRuler)}},setOverviewRulerVisible:function(c,a){if(this._overviewRulerVisible!==c||a)if(this._overviewRulerVisible=
c,this._overviewRuler){var b=this._textView;c?b.addRuler(this._overviewRuler):b.removeRuler(this._overviewRuler)}},mapOffset:function(c,a){var b=this._textView.getModel();b.getBaseModel&&(c=b.mapOffset(c,a));return c},getLineAtOffset:function(c){return this.getModel().getLineAtOffset(this.mapOffset(c))},getLineStart:function(c){return this.getModel().getLineStart(c)},getCaretOffset:function(){return this.mapOffset(this._textView.getCaretOffset())},getSelection:function(){var c=this._textView,a=c.getSelection(),
c=c.getModel();c.getBaseModel&&(a.start=c.mapOffset(a.start),a.end=c.mapOffset(a.end));return a},_expandOffset:function(c){var a=this._textView.getModel(),b=this._annotationModel;if(b&&a.getBaseModel)for(c=b.getAnnotations(c,c+1);c.hasNext();)a=c.next(),a.type===h.ANNOTATION_FOLDING&&a.expand&&a.expand()},setCaretOffset:function(c,a,b){var d=this._textView,e=d.getModel();e.getBaseModel&&(this._expandOffset(c),c=e.mapOffset(c,!0));d.setCaretOffset(c,a,b)},setText:function(c,a,b){var d=this._textView,
e=d.getModel();e.getBaseModel&&(void 0!==a&&(this._expandOffset(a),a=e.mapOffset(a,!0)),void 0!==b&&(this._expandOffset(b),b=e.mapOffset(b,!0)));d.setText(c,a,b)},setSelection:function(c,a,b,d){var e=this._textView,h=e.getModel();h.getBaseModel&&(this._expandOffset(c),this._expandOffset(a),c=h.mapOffset(c,!0),a=h.mapOffset(a,!0));e.setSelection(c,a,b,d)},moveSelection:function(c,a,b,d){var e=this._textView;this.setSelection(c,a||c,1/3,function(){(void 0===d||d)&&e.focus();b&&b()})},_getTooltipInfo:function(c,
a){var b=this._textView,d=this.getAnnotationModel();if(!d)return null;var e=this._annotationStyler;if(!e)return null;var h=b.getOffsetAtLocation(c,a);if(-1===h)return null;h=this.mapOffset(h);e=e.getAnnotationsByType(d,h,h+1);d=[];for(h=0;h<e.length;h++)e[h].rangeStyle&&d.push(e[h]);if(0===d.length)return null;b=b.convert({x:c,y:a},"document","page");return{contents:d,anchor:"left",x:b.x+10,y:b.y+20}},_highlightCurrentLine:function(c,a){var b=this._annotationModel;if(b){var d=this._textView;if(!d.getOptions("singleMode")){var e=
d.getModel(),f=a?e.getLineAtOffset(a.start):-1,g=e.getLineAtOffset(c.start),d=c.start===c.end,l=!a||a.start===a.end,m=e.getLineStart(g),q=e.getLineEnd(g);e.getBaseModel&&(m=e.mapOffset(m),q=e.mapOffset(q));e=this._currentLineAnnotation;if(!(f===g&&l&&d&&e&&e.start===m&&e.end===q)){var f=e?[e]:null,v;d&&(e=h.createAnnotation(h.ANNOTATION_CURRENT_LINE,m,q),v=[e]);this._currentLineAnnotation=e;b.replaceAnnotations(f,v)}}}},installTextView:function(){this.install()},install:function(){if(!this._textView){this._textView=
this._textViewFactory();this._undoStackFactory&&(this._undoStack=this._undoStackFactory.createUndoStack(this),this.checkDirty());this._textDNDFactory&&(this._textDND=this._textDNDFactory.createTextDND(this,this._undoStack));this._contentAssistFactory&&(this._contentAssist=this._contentAssistFactory.createContentAssistMode(this).getContentAssist());var c=this,a=this._textView,b=this;this._listener={onModelChanged:function(){b.checkDirty()},onMouseOver:function(a){b._listener.onMouseMove(a)},onMouseMove:function(c){var d=
q.Tooltip.getTooltip(a);d&&!(b._listener.lastMouseX===c.event.clientX&&b._listener.lastMouseY===c.event.clientY)&&(b._listener.lastMouseX=c.event.clientX,b._listener.lastMouseY=c.event.clientY,d.setTarget({x:c.x,y:c.y,getTooltipInfo:function(){return b._getTooltipInfo(this.x,this.y)}}))},onMouseOut:function(c){var d=q.Tooltip.getTooltip(a);d&&!(b._listener.lastMouseX===c.event.clientX&&b._listener.lastMouseY===c.event.clientY)&&(b._listener.lastMouseX=c.event.clientX,b._listener.lastMouseY=c.event.clientY,
d.setTarget(null))},onScroll:function(){var c=q.Tooltip.getTooltip(a);c&&c.setTarget(null,0,0)},onSelection:function(a){b._updateCursorStatus();b._highlightCurrentLine(a.newValue,a.oldValue)}};a.addEventListener("ModelChanged",this._listener.onModelChanged);a.addEventListener("Selection",this._listener.onSelection);a.addEventListener("MouseOver",this._listener.onMouseOver);a.addEventListener("MouseOut",this._listener.onMouseOut);a.addEventListener("MouseMove",this._listener.onMouseMove);a.addEventListener("Scroll",
this._listener.onScroll);if(this._keyBindingFactory){var d;if(d="function"===typeof this._keyBindingFactory?this._keyBindingFactory(this,this.getKeyModes(),this._undoStack,this._contentAssist):this._keyBindingFactory.createKeyBindings(c,this._undoStack,this._contentAssist))this._textActions=d.textActions,this._linkedMode=d.linkedMode,this._sourceCodeActions=d.sourceCodeActions}d=function(a){if(void 0!==a&&-1!==a){for(var b=this.getView().getModel(),d=this.getAnnotationModel(),e=c.mapOffset(b.getLineStart(a)),
a=c.mapOffset(b.getLineEnd(a)),b=d.getAnnotations(e,a),k=null;b.hasNext();){var n=b.next();if(n.type===h.ANNOTATION_BOOKMARK){k=n;break}}k?d.removeAnnotation(k):(k=h.createAnnotation(h.ANNOTATION_BOOKMARK,e,a),k.title=void 0,d.addAnnotation(k))}};if(this._annotationFactory){var f=a.getModel();f.getBaseModel&&(f=f.getBaseModel());if(this._annotationModel=this._annotationFactory.createAnnotationModel(f))if(f=this._annotationStyler=this._annotationFactory.createAnnotationStyler(a,this._annotationModel))f.addAnnotationType(h.ANNOTATION_CURRENT_SEARCH),
f.addAnnotationType(h.ANNOTATION_MATCHING_SEARCH),f.addAnnotationType(h.ANNOTATION_ERROR),f.addAnnotationType(h.ANNOTATION_WARNING),f.addAnnotationType(h.ANNOTATION_MATCHING_BRACKET),f.addAnnotationType(h.ANNOTATION_CURRENT_BRACKET),f.addAnnotationType(h.ANNOTATION_CURRENT_LINE),f.addAnnotationType(h.ANNOTATION_READ_OCCURRENCE),f.addAnnotationType(h.ANNOTATION_WRITE_OCCURRENCE),f.addAnnotationType(h.ANNOTATION_SELECTED_LINKED_GROUP),f.addAnnotationType(h.ANNOTATION_CURRENT_LINKED_GROUP),f.addAnnotationType(h.ANNOTATION_LINKED_GROUP),
f.addAnnotationType("orion.annotation.highlightError");var f=this._annotationFactory.createAnnotationRulers(this._annotationModel),g=this._annotationRuler=f.annotationRuler;g&&(g.onDblClick=d,g.setMultiAnnotationOverlay({html:"<div class='annotationHTML overlay'></div>"}),g.addAnnotationType(h.ANNOTATION_ERROR),g.addAnnotationType(h.ANNOTATION_WARNING),g.addAnnotationType(h.ANNOTATION_TASK),g.addAnnotationType(h.ANNOTATION_BOOKMARK));this.setAnnotationRulerVisible(this._annotationRulerVisible||void 0===
this._annotationRulerVisible,!0);if(g=this._overviewRuler=f.overviewRuler)g.addAnnotationType(h.ANNOTATION_CURRENT_SEARCH),g.addAnnotationType(h.ANNOTATION_MATCHING_SEARCH),g.addAnnotationType(h.ANNOTATION_READ_OCCURRENCE),g.addAnnotationType(h.ANNOTATION_WRITE_OCCURRENCE),g.addAnnotationType(h.ANNOTATION_CURRENT_BLAME),g.addAnnotationType(h.ANNOTATION_ERROR),g.addAnnotationType(h.ANNOTATION_WARNING),g.addAnnotationType(h.ANNOTATION_TASK),g.addAnnotationType(h.ANNOTATION_BOOKMARK),g.addAnnotationType(h.ANNOTATION_MATCHING_BRACKET),
g.addAnnotationType(h.ANNOTATION_CURRENT_BRACKET),g.addAnnotationType(h.ANNOTATION_CURRENT_LINE);this.setOverviewRulerVisible(this._overviewRulerVisible||void 0===this._overviewRulerVisible,!0)}this._lineNumberRulerFactory&&(this._lineNumberRuler=this._lineNumberRulerFactory.createLineNumberRuler(this._annotationModel),this._lineNumberRuler.addAnnotationType(h.ANNOTATION_CURRENT_BLAME),this._lineNumberRuler.addAnnotationType(h.ANNOTATION_BLAME),this._lineNumberRuler.onDblClick=d,this.setLineNumberRulerVisible(this._lineNumberRulerVisible||
void 0===this._lineNumberRulerVisible,!0));this._foldingRulerFactory&&(this._foldingRuler=this._foldingRulerFactory.createFoldingRuler(this._annotationModel),this._foldingRuler.addAnnotationType(h.ANNOTATION_FOLDING),this.setFoldingRulerVisible(this._foldingRulerVisible||void 0===this._foldingRulerVisible,!0));this.dispatchEvent({type:"TextViewInstalled",textView:a});e.prototype.install.call(this)}},uninstallTextView:function(){this.uninstall()},uninstall:function(){var c=this._textView;c&&(c.destroy(),
this._textView=this._undoStack=this._textDND=this._contentAssist=this._listener=this._annotationModel=this._annotationStyler=this._annotationRuler=this._overviewRuler=this._lineNumberRuler=this._foldingRuler=this._currentLineAnnotation=this._title=null,this._dirty=!1,this._foldingRulerVisible=this._overviewRulerVisible=this._lineNumberRulerVisible=this._annotationRulerVisible=void 0,this.dispatchEvent({type:"TextViewUninstalled",textView:c}),e.prototype.uninstall.call(this))},_updateCursorStatus:function(){for(var c=
this.getModel(),a=this.getCaretOffset(),b=c.getLineAtOffset(a),c=c.getLineStart(b),a=a-c,c=this.getKeyModes(),d=0;d<c.length;d++){var e=c[d];if(e.isActive()&&e.isStatusActive&&e.isStatusActive())return}this.reportStatus(g.formatMessage(f.lineColumn,b+1,a+1))},showAnnotations:function(c,a,b,d){var e=this._annotationModel;if(e){for(var f=[],g=[],l=e.getTextModel(),m=e.getAnnotations(),q;m.hasNext();)q=m.next(),-1!==a.indexOf(q.type)&&q.creatorID===this&&f.push(q);if(c)for(a=0;a<c.length;a++)if(q=c[a]){if(b)q=
b(q);else{var v;"number"===typeof q.line?(v=l.getLineStart(q.line-1),m=v+q.start-1,v=v+q.end-1):(m=q.start,v=q.end);var z=d(q);if(!z)continue;q=h.createAnnotation(z,m,v,q.description)}q.creatorID=this;g.push(q)}e.replaceAnnotations(f,g)}},showProblems:function(c){this.showAnnotations(c,[h.ANNOTATION_ERROR,h.ANNOTATION_WARNING,h.ANNOTATION_TASK],null,function(a){switch(a.severity){case "error":return h.ANNOTATION_ERROR;case "warning":return h.ANNOTATION_WARNING;case "task":return h.ANNOTATION_TASK}return null})},
showOccurrences:function(c){this.showAnnotations(c,[h.ANNOTATION_READ_OCCURRENCE,h.ANNOTATION_WRITE_OCCURRENCE],null,function(a){return a.readAccess?h.ANNOTATION_READ_OCCURRENCE:h.ANNOTATION_WRITE_OCCURRENCE})},showBlame:function(c){var a=this._blameRGB,d=this.getTextView().getOptions("parent").ownerDocument;if(!a){var e=g.createElement(d,"div");e.className="annotation blame";d.body.appendChild(e);var p=(d.defaultView||d.parentWindow).getComputedStyle(e).getPropertyValue("background-color");e.parentNode.removeChild(e);
var e=p.indexOf("("),m=p.indexOf(")"),p=p.substring(e+1,m);this._blameRGB=a=p.split(",").slice(0,3)}var s=function(){var a=b.AnnotationType.createAnnotation(this.groupType,this.start,this.end,this.title);a.style=l.mixin({},a.style);a.style.style=l.mixin({},a.style.style);a.style.style.backgroundColor="";this.groupAnnotation=a;a.blame=this.blame;a.html=this.html;a.creatorID=this.creatorID;return a},q=function(){var a=g.createElement(d,"div");a.className="tooltipTitle";var c=this.blame.Message.indexOf("\n");
-1===c&&(c=this.blame.Message.length);var b=g.createElement(d,"a");b.href=this.blame.CommitLink;b.appendChild(d.createTextNode(this.blame.Message.substring(0,c)));a.appendChild(b);a.appendChild(g.createElement(d,"br"));a.appendChild(d.createTextNode(g.formatMessage(f.committerOnTime,this.blame.AuthorName,this.blame.Time)));return a},y=this.getModel();this.showAnnotations(c,[h.ANNOTATION_BLAME,h.ANNOTATION_CURRENT_BLAME],function(c){var d=y.getLineStart(c.Start-1),e=y.getLineEnd(c.End-1,!0),d=b.AnnotationType.createAnnotation(h.ANNOTATION_BLAME,
d,e,q),e=a.slice(0);e.push(c.Shade);d.style=l.mixin({},d.style);d.style.style=l.mixin({},d.style.style);d.style.style.backgroundColor="rgba("+e.join()+")";d.groupId=c.Name;d.groupType=h.ANNOTATION_CURRENT_BLAME;d.createGroupAnnotation=s;d.html='<img class="annotationHTML blame" src="'+c.AuthorImage+'"/>';d.blame=c;return d})},showSelection:function(c,a,b,d,e){"number"===typeof c?("number"!==typeof a&&(a=c),this.moveSelection(c,a)):"number"===typeof b&&(c=this.getModel().getLineStart(b-1),"number"===
typeof d&&(c+=d),"number"!==typeof e&&(e=0),this.moveSelection(c,c+e))},_setModelText:function(c){this._textView&&(this._textView.setText(c),this._textView.getModel().setLineDelimiter("auto"),this._highlightCurrentLine(this._textView.getSelection()))},setInput:function(c,a,b,d,h){e.prototype.setInput.call(this,c,a,b,d);this._textView&&(!d&&!h)&&this._textView.focus()},onGotoLine:function(c,a,b,d){if(this._textView){var e=this.getModel(),c=Math.max(0,Math.min(c,e.getLineCount()-1)),h=e.getLineStart(c),
f=0;void 0===b&&(b=0);"string"===typeof a?(c=e.getLine(c).indexOf(a),-1!==c&&(f=c,b=f+a.length)):(f=a,a=e.getLineEnd(c)-h,f=Math.min(f,a),b=Math.min(b,a));this.moveSelection(h+f,h+b,d)}}});return{BaseEditor:e,Editor:d}});
define("orion/selection",["orion/EventTarget","orion/Deferred"],function(f){function m(m,b){b||(b="orion.page.selection");this._serviceRegistry=m;f.attach(this);this._serviceRegistration=m.registerService(b,this);this._selections=null}m.prototype={getSelection:function(f){var b=this._getSingleSelection();"function"===typeof f&&f(b);return b},getSelections:function(f){var b=Array.isArray(this._selections)?this._selections.slice():[];"function"===typeof f&&f(b);return b},_getSingleSelection:function(){return this._selections&&
0<this._selections.length?this._selections[0]:null},setSelections:function(f){var b=this._selections;this._selections=Array.isArray(f)?0<f.length?f.slice():null:f?[f]:null;b!==this._selections&&this.dispatchEvent({type:"selectionChanged",selection:this._getSingleSelection(),selections:this._selections})}};m.prototype.constructor=m;return{Selection:m}});
define("orion/commandRegistry","orion/commands orion/explorers/navigationUtils orion/PageUtil orion/uiUtils orion/webui/littlelib orion/webui/dropdown orion/webui/tooltip text!orion/webui/checkedmenuitem.html text!orion/webui/dropdowntriggerbutton.html text!orion/webui/submenutriggerbutton.html".split(" "),function(f,m,q,b,l,g,e,d,h,c){function a(a){this._commandList={};this._contributionsByScopeId={};this._activeBindings={};this._urlBindings={};this._pendingBindings={};this._init(a);this._parameterCollector=
null}function k(a,c){this.token=a;this.parameterName=c}function n(a,c,b){this.event=a;this.handler=c;this.capture=b||!1}function p(a,c,b,d,e,k){this.name=a;this.type=c;this.label=b;this.value=d;this.lines=e||1;this.eventListeners=Array.isArray(k)?k:k?[k]:[]}function u(a,c,b){this._storeParameters(a);this._hasOptionalParameters=c&&c.hasOptionalParameters;this._options=c;this.optionsRequested=!1;this.getParameters=b;this.clientCollect=c&&c.clientCollect}a.prototype={_init:function(a){this._selectionService=
a.selection;var c=this;f.setKeyBindingProvider(function(){return c._activeBindings})},processURL:function(a){for(var c in this._urlBindings)if(this._urlBindings[c]&&this._urlBindings[c].urlBinding&&this._urlBindings[c].command){var b=this._urlBindings[c].urlBinding.match(a);if(b){var d=this._urlBindings[c],e=d.command,k=d.invocation;if(k&&k.parameters&&e.callback){k.parameters.setValue(b.parameterName,b.parameterValue);var h=this;window.setTimeout(function(){h._invoke(k)},0);break}}}},findCommand:function(a){return this._commandList[a]},
runCommand:function(a,c,b,d){c?(a=this._commandList[a])&&(a.visibleWhen?a.visibleWhen(c):1)&&a.callback&&this._invoke(new f.CommandInvocation(b,c,null,a,this),d):(c=this._urlBindings[a])&&c.command&&c.command.callback&&this._invoke(c.invocation,d)},getSelectionService:function(){return this._selectionService},setParameterCollector:function(a){this._parameterCollector=a},openParameterCollector:function(a,c,b){this._parameterCollector&&(this._parameterCollector.close(),this._parameterCollector.open(a,
c,b))},confirm:function(a,c,b,d,e,k){var h=!1;if(this._parameterCollector&&!e){var n=this;this._parameterCollector.close();if(this._parameterCollector.open(a,function(a,e){var k=document.createElement("span");k.classList.add("parameterPrompt");k.textContent=c;a.appendChild(k);k=document.createElement("button");k.addEventListener("click",function(){h=!0;n._parameterCollector.close()},!1);e.appendChild(k);k.appendChild(document.createTextNode(b));k.className="dismissButton";var f=document.createElement("button");
f.addEventListener("click",function(){h=!1;n._parameterCollector.close()},!1);e.appendChild(f);f.appendChild(document.createTextNode(d));f.className="dismissButton";return k},function(){k(h)}))return}h=window.confirm(c);k(h)},closeParameterCollector:function(){this._parameterCollector&&this._parameterCollector.close()},collectsParameters:function(){return this._parameterCollector},_invoke:function(a,c){return this._collectAndInvoke(a.makeCopy(c),!1)},_collectAndInvoke:function(a,c){if(a)if(this._parameterCollector&&
a.parameters&&a.parameters.hasParameters()&&(c||a.parameters.shouldCollectParameters())){var b=!1;a.parameters.updateParameters(a);if(a.parameters.shouldCollectParameters()&&(b=this._parameterCollector.collectParameters(a),!b)){var d=new e.Tooltip({node:a.domNode,afterHiding:function(){this.destroy()},trigger:"click",position:["below","right","above","left"]}),b=d.contentContainer();b.classList.add("parameterPopup");var k=window.document.activeElement,h=this._parameterCollector.getFillFunction(a,
function(){k&&k.focus();d.destroy()})(b);d.show();window.setTimeout(function(){h.focus();h.select()},0);b=!0}b||a.command.callback.call(a.handler||window,a)}else a.command.callback.call(a.handler||window,a);else window.console.log("Client attempted to invoke command without an available (rendered) command invocation")},collectParameters:function(a){this._collectAndInvoke(a,!0)},showKeyBindings:function(a){function c(a){return function(){f.executeBinding(a)}}var d={},e,k,h=[],n;for(n in this._activeBindings)(k=
this._activeBindings[n])&&(k.keyBinding&&k.command&&(k.command.name||k.command.tooltip))&&h.push(k);h.sort(function(a,c){return(a.command.name||a.command.tooltip).localeCompare(c.command.name||c.command.tooltip)});for(n=0;n<h.length;n++)k=h[n],k.keyBinding.scopeName?(d[k.keyBinding.scopeName]||(d[k.keyBinding.scopeName]=[]),d[k.keyBinding.scopeName].push(k)):(e=b.getUserKeyString(k.keyBinding),a.createItem(e,k.command.name||k.command.tooltip,c(k)));for(var g in d)d[g].length&&0<d[g].length&&(a.createHeader(g),
d[g].forEach(function(d){e=b.getUserKeyString(d.keyBinding);a.createItem(e,d.command.name||d.command.tooltip,c(d))}))},addCommand:function(a){this._commandList[a.id]=a;var c=this._pendingBindings[a.id];if(c){var b=this;c.forEach(function(c){b._addBinding(a,c.type,c.binding,c.bindingOnly)});delete this._pendingBindings[a.id]}},addCommandGroup:function(a,c,b,d,e,k,h,n,f,g){this._contributionsByScopeId[a]||(this._contributionsByScopeId[a]={});a=this._contributionsByScopeId[a];e&&(a=this._createEntryForPath(a,
e));a[c]?(d&&(a[c].title=d),b&&(a[c].position=b),h&&(a[c].imageClass=h),n&&(a[c].tooltip=n),f&&(a[c].selectionClass=f),!0===g?a[c].pretendDefaultActionId=!0:a[c].defaultActionId=g,a[c].emptyGroupMessage=k):(a[c]={title:d,position:b,emptyGroupMessage:k,imageClass:h,tooltip:n,selectionClass:f,defaultActionId:!0===g?null:g,pretendDefaultActionId:!0===g,children:{}},a.sortedContributions=null)},_createEntryForPath:function(a,c){c&&c.split("/").forEach(function(c){1<c.length&&(a[c]||(a[c]={position:0,
children:{}},a.sortedContributions=null),a=a[c].children)});return a},registerSelectionService:function(a,c){this._contributionsByScopeId[a]||(this._contributionsByScopeId[a]={});this._contributionsByScopeId[a].localSelectionService=c},registerCommandContribution:function(a,c,b,d,e,k,h){this._contributionsByScopeId[a]||(this._contributionsByScopeId[a]={});a=this._contributionsByScopeId[a];d&&(a=this._createEntryForPath(a,d));a[c]={position:b};k&&((b=this._commandList[c])?this._addBinding(b,"key",
k,e):this._addPendingBinding(c,"key",k,e));h&&((b=this._commandList[c])?this._addBinding(b,"url",h,e):this._addPendingBinding(c,"url",h,e));a.sortedContributions=null},unregisterCommandContribution:function(a,c,b){if(this._contributionsByScopeId[a]){delete this._commandList[c];delete this._activeBindings[c];delete this._urlBindings[c];delete this._pendingBindings[c];var d=this._contributionsByScopeId[a];b&&b.split("/").forEach(function(a){1<a.length&&d[a]&&(d=d[a].children)});delete d[c];d.sortedContributions=
null}},_addBinding:function(a,c,b,d){if(!a.id)throw Error("No command id: "+a);"key"===c?this._activeBindings[a.id]={command:a,keyBinding:b,bindingOnly:d}:"url"===c&&(this._urlBindings[a.id]={command:a,urlBinding:b,bindingOnly:d})},_addPendingBinding:function(a,c,b,d){this._pendingBindings[a]=this._pendingBindings[a]||[];this._pendingBindings[a].push({type:c,binding:b,bindingOnly:d})},_checkForTrailingSeparator:function(a,c,b){var d;if("tool"===c||"button"===c)if((d=0<a.childNodes.length?a.childNodes[a.childNodes.length-
1]:null)&&d.classList.contains("commandSeparator"))return b?(a.removeChild(d),!1):!0;if("menu"===c&&(a=l.$$array("li > *",a),0<a.length&&a[a.length-1].classList.contains("dropdownSeparator")))if(d=a[a.length-1],b)d.parentNode.parentNode.removeChild(d.parentNode);else return!0;return!1},renderCommands:function(a,c,b,d,e,k,h){if("string"!==typeof a)throw"a scope id for rendering must be specified";c=l.node(c);if(!c)throw"no parent";var n=this._contributionsByScopeId[a];if(!b&&n){var b=n.localSelectionService||
this._selectionService,f=this;b&&b.getSelections(function(b){f.renderCommands(a,c,b,d,e,k)})}else n&&(this._render(n,c,b,d,e||"button",k,h),this._checkForTrailingSeparator(c,e,!0))},destroy:function(a){a=l.node(a);if(!a)throw"no parent";for(;a.hasChildNodes();){var c=a.firstChild;c.commandTooltip&&c.commandTooltip.destroy();c.emptyGroupTooltip&&c.emptyGroupTooltip.destroy();this.destroy(c);a.removeChild(c)}},_render:function(a,c,d,k,h,n,g){var p=a.sortedContributions;if(!p){var p=[],l=!1,q;for(q in a)if(Object.prototype.hasOwnProperty.call(a,
q)){var u=a[q];u&&"number"===typeof u.position&&(u.id=q,p.push(u),l=!0)}l&&(p.sort(function(a,c){return a.position-c.position}),a.sortedContributions=p)}var H=0,B=this;p.forEach(function(a){var p;a.imageClass||(a.imageClass=null);if(a.children&&0<Object.getOwnPropertyNames(a.children).length){var l=a.children;if("tool"===h||"button"===h)if(a.title){var s;a.defaultActionId&&((l=B._commandList[a.defaultActionId])&&(l.visibleWhen?l.visibleWhen(d):1)?(s=new f.CommandInvocation(k,d,n,l,B),s.domParent=
c):a.pretendDefaultActionId=!0);l=B._createDropdownMenu(c,a.title,null,null,a.imageClass,a.tooltip,a.selectionClass,null,s,a.pretendDefaultActionId);g&&m.generateNavGrid(g,l.menuButton);l&&(B._render(a.children,l.menu,d,k,"menu",n,g),B._checkForTrailingSeparator(l.menu,"menu",!0),0===l.menu.childNodes.length?a.emptyGroupMessage?l.menuButton.emptyGroupTooltip||(l.menuButton.emptyGroupTooltip=new e.Tooltip({node:l.menuButton,text:a.emptyGroupMessage,trigger:"click",position:["below","right","above",
"left"]})):(g&&m.removeNavGrid(g,l.menuButton),a=function(a){a&&a.parentNode&&a.parentNode.removeChild(a)},a(l.menu),a(l.menuButton),a(l.destroyButton)):l.menuButton.style.visibility="visible")}else{var q;0<c.childNodes.length&&!B._checkForTrailingSeparator(c,h)&&(q=B.generateSeparatorImage(c));B._render(l,c,d,k,h,n,g);0<c.childNodes.length&&c.childNodes[c.childNodes.length-1]!==q&&(q=B.generateSeparatorImage(c))}else if(a.title){if(a=B._createDropdownMenu(c,a.title,!0,null,null,a.imageClass))B._render(l,
a.menu,d,k,"menu",n,g),B._checkForTrailingSeparator(a.menu,"menu",!0),0===a.menu.childNodes.length&&a.destroyButton&&c.removeChild(a.destroyButton)}else 0<c.childNodes.length&&B._generateMenuSeparator(c),B._render(l,c,d,k,h,n,g),B._generateMenuSeparator(c)}else{var u=B._commandList[a.id],l=u?!0:!1;s=a=null;u&&(p=new f.CommandInvocation(k,d,n,u,B),p.domParent=c,q=l&&(u.visibleWhen?u.visibleWhen(d):!0),B._activeBindings[u.id]&&B._activeBindings[u.id].keyBinding&&(a=B._activeBindings[u.id],a.invocation=
q?p:null,a.bindingOnly&&(l=!1)),B._urlBindings[u.id]&&B._urlBindings[u.id].urlBinding&&(s=B._urlBindings[u.id],s.invocation=q?p:null,s.bindingOnly&&(l=!1)),l=l&&q);l&&(u.choiceCallback?("tool"===h||"button"===h?(a=c,l=!1,"ul"===c.nodeName.toLowerCase()&&(a=document.createElement("li"),c.appendChild(a))):(a=c,l=!0),B._createDropdownMenu(a,u.name,l,function(a){u.populateChoicesMenu(a,d,k,n,B)}.bind(u),u.imageClass,u.tooltip||u.title,u.selectionClass,u.positioningNode)):(p.handler=p.handler||this,p.domParent=
c,l=function(){B._invoke(p)},"menu"===h?(s=null,a&&a.keyBinding&&(s=b.getUserKeyString(a.keyBinding)),a=f.createCommandMenuItem(c,u,p,null,l,s)):(a=h+u.id+H,a=f.createCommandItem(c,u,p,a,null,"tool"===h,l)),m.generateNavGrid(g,a),p.domNode=a,H++))}})},_createDropdownMenu:function(a,b,d,k,h,n,p,m,q,u){a=l.node(a);if(!a||!l.contains(document.body,a))return null;var C,H,B=a;if(d)n=document.createRange(),n.selectNode(a),n=n.createContextualFragment(c),l.processTextNodes(n,{ButtonText:b}),a.appendChild(n),
H=a.lastChild,h=H.lastChild,b=h.previousSibling,b.dropdown=new g.Dropdown({dropdown:h,populate:k,parentDropdown:a.dropdown}),h.dropdown=b.dropdown;else{"ul"===a.nodeName.toLowerCase()&&(B=document.createElement("li"),a.appendChild(B),H=B);a=null;h&&(a="dropdownButtonWithIcon",n=n||b);var n=h?n||b:n,J=f.createDropdownMenu(B,b,k,a,h,!1,p,m,q||u);C=J.dropdownArrow;b=J.menuButton;if(C){q&&(q.domNode=J.menuButton);var M=this;b.onclick=function(a){var c=l.bounds(C);a.clientX>=c.left&&J.dropdown?J.dropdown.toggle(a):
M._invoke(q)};J.dropdown&&(b.onkeydown=function(a){l.KEY.DOWN===a.keyCode&&(J.dropdown.toggle(a),l.stop(a))})}var h=J.menu,I;(k=q&&q.command&&(q.command.tooltip||q.command.name))?I=q.command.tooltip||q.command.name:k&&(I=n);I&&(b.commandTooltip=new e.Tooltip({node:b,text:I,position:["above","below","right","left"]}))}return{menuButton:b,menu:h,dropdown:b.dropdown,destroyButton:H,dropdownArrow:C}},_generateMenuSeparator:function(a){if(!this._checkForTrailingSeparator(a,"menu")){var c=document.createElement("li");
c.classList.add("dropdownSeparator");var b=document.createElement("span");b.classList.add("dropdownSeparator");c.appendChild(b);a.appendChild(c)}},generateSeparatorImage:function(a){var c;c="ul"===a.nodeName.toLowerCase()?document.createElement("li"):document.createElement("span");a.appendChild(c);c.classList.add("core-sprite-sep");c.classList.add("imageSprite");c.classList.add("commandSeparator");return c}};a.prototype.constructor=a;k.prototype={match:function(a){a=q.matchResourceParameters(a);return"undefined"!==
typeof a[this.token]?(this.parameterValue=a[this.token],this):null}};k.prototype.constructor=k;n.prototype.constructor=n;p.prototype={optionsRequested:function(){return this.optionsRequested}};p.prototype.constructor=p;u.prototype={_storeParameters:function(a){this.parameterTable=null;if(a){var c=this.parameterTable={};a.forEach(function(a){c[a.name]=a})}},updateParameters:function(a){"function"===typeof this.getParameters&&this._storeParameters(this.getParameters(a))},hasParameters:function(){return null!==
this.parameterTable},shouldCollectParameters:function(){return!this.clientCollect&&this.hasParameters()},parameterNamed:function(a){return this.parameterTable[a]},valueFor:function(a){return(a=this.parameterTable[a])?a.value:null},setValue:function(a,c){var b=this.parameterTable[a];b&&(b.value=c)},forEach:function(a){for(var c in this.parameterTable)this.parameterTable[c].type&&this.parameterTable[c].name&&a(this.parameterTable[c])},makeCopy:function(){var a=[];this.forEach(function(c){c=new p(c.name,
c.type,c.label,c.value,c.lines,c.eventListeners);a.push(c)});var c=new u(a,this._options,this.getParameters);c.clientCollect=this.clientCollect;return c},hasOptionalParameters:function(){return this._hasOptionalParameters}};u.prototype.constructor=u;return{CommandRegistry:a,URLBinding:k,ParametersDescription:u,CommandParameter:p,CommandEventListener:n}});define("text!orion/banner/slideout.html",[],function(){return'<div id="slideContainer" class="slideParameters slideContainer">\r\n\t<span id="pageCommandParameters" class="layoutLeft parameters"></span>\r\n\t<span id="pageCommandDismiss" class="layoutRight parametersDismiss"></span>\r\n</div>'});
define("orion/commonHTMLFragments",["require","orion/webui/littlelib","text!orion/banner/slideout.html"],function(f,m,q){return{slideoutHTMLFragment:function(b){var f=document.createElement("div");f.innerHTML=q;var g=m.$("#slideContainer",f);g.id=b+g.id;g=m.$("#pageCommandParameters",f);g.id=b+g.id;g=m.$("#pageCommandDismiss",f);g.id=b+g.id;return f.innerHTML}}});
define("orion/section","orion/webui/littlelib orion/selection orion/commandRegistry orion/commonHTMLFragments orion/objects orion/selection".split(" "),function(f,m,q,b,l,g){function e(d,c){var a=this;this._expandImageClass="core-sprite-openarrow";this._collapseImageClass="core-sprite-closedarrow";this._twistieSpriteClass="modelDecorationSprite";if(!c.id)throw Error("Missing required argument: id");this.id=c.id;if(!c.title)throw Error("Missing required argument: title");var e=c.useAuxStyle?["sectionWrapper",
"sectionWrapperAux","toolComposite"]:["sectionWrapper","toolComposite"];this.domNode=document.createElement("div");d.appendChild(this.domNode);for(var n=0;n<e.length;n++)this.domNode.classList.add(e[n]);this.domNode.id=c.id;c.canHide&&(this.twistie=document.createElement("span"),this.twistie.classList.add("modelDecorationSprite"),this.twistie.classList.add("layoutLeft"),this.twistie.classList.add("sectionTitleTwistie"),this.domNode.style.cursor="pointer",this.domNode.appendChild(this.twistie),this.domNode.tabIndex=
0,this.domNode.addEventListener("click",function(c){(c.target===a.titleNode||c.target===a.twistie)&&a._changeExpandedState()},!1),this.domNode.addEventListener("keydown",function(c){c.keyCode===f.KEY.ENTER&&(c.target===a.domNode||c.target===a.titleNode||c.target===a.twistie)&&a._changeExpandedState()},!1));if(c.iconClass){var g=document.createElement("span");g.classList.add("sectionIcon");this.domNode.appendChild(g);e=Array.isArray(c.iconClass)?c.iconClass:[c.iconClass];e.forEach(function(a){g.classList.add(a)})}c.headerClass&&
(e=Array.isArray(c.headerClass)?c.headerClass:[c.headerClass],e.forEach(function(a){this.domNode.classList.add(a)}.bind(this)));this.titleNode=document.createElement("div");this.titleNode.id=c.id+"Title";this.titleNode.classList.add("sectionAnchor");this.titleNode.classList.add("sectionTitle");this.titleNode.classList.add("layoutLeft");this.domNode.appendChild(this.titleNode);this.titleNode.textContent=c.title;"function"===typeof c.getItemCount&&(e=document.createElement("div"),e.classList.add("layoutLeft"),
e.classList.add("sectionItemCount"),this.domNode.appendChild(e),e.textContent=c.getItemCount(this));this._progressNode=document.createElement("div");this._progressNode.id=c.id+"Progress";this._progressNode.classList.add("sectionProgress");this._progressNode.classList.add("sectionTitle");this._progressNode.classList.add("layoutLeft");this._progressNode.style.visibility="hidden";this._progressNode.textContent="...";this.domNode.appendChild(this._progressNode);e=document.createElement("div");e.id=c.id+
"FilterSearchBox";this.domNode.appendChild(e);this._toolActionsNode=document.createElement("div");this._toolActionsNode.id=c.id+"ToolActionsArea";this._toolActionsNode.classList.add("layoutRight");this._toolActionsNode.classList.add("sectionActions");this.domNode.appendChild(this._toolActionsNode);this.actionsNode=document.createElement("ul");this.actionsNode.id=c.id+"ActionArea";this.actionsNode.classList.add("layoutRight");this.actionsNode.classList.add("commandList");this.actionsNode.classList.add("sectionActions");
this.domNode.appendChild(this.actionsNode);this.selectionNode=document.createElement("ul");this.selectionNode.id=c.id+"SelectionArea";this.selectionNode.classList.add("layoutRight");this.selectionNode.classList.add("commandList");this.selectionNode.classList.add("sectionActions");this.domNode.appendChild(this.selectionNode);c.slideout&&(e=b.slideoutHTMLFragment(c.id),n=document.createRange(),n.selectNode(this.domNode),e=n.createContextualFragment(e),this.domNode.appendChild(e));this._contentParent=
document.createElement("div");this._contentParent.id=this.id+"Content";this._contentParent.role="region";this._contentParent.classList.add("sectionTable");this._contentParent.setAttribute("aria-labelledby",this.titleNode.id);d.appendChild(this._contentParent);c.content&&this.setContent(c.content);this.hidden=c.hidden;"function"===typeof c.onExpandCollapse&&(this._onExpandCollapse=c.onExpandCollapse);this._preferenceService=c.preferenceService;this._contentParent.style.display="none";this.domNode.classList.add("sectionWrapperClosed");
if(this._preferenceService){var l=this;this._preferenceService.getPreferences("/window/views").then(function(a){a=a.get(l.id);void 0!==a&&(l.hidden=!a);l.hidden||(l._contentParent.style.display="block",l.domNode.classList.remove("sectionWrapperClosed"));l._updateExpandedState(!l.hidden,!1)})}else this.hidden||(this._contentParent.style.display="block",this.domNode.classList.remove("sectionWrapperClosed")),this._updateExpandedState(!this.hidden,!1);this._commandService=c.commandService;this._lastMonitor=
0;this._loading={}}function d(b){this._section=b;this._id=++b._lastMonitor}e.prototype={setTitle:function(b){this.titleNode.textContent=b},getHeaderElement:function(){return this.domNode},getTitleElement:function(){return this.titleNode},getActionElement:function(){return this._toolActionsNode},setContent:function(b){"string"===typeof b?this._contentParent.innerHTML=b:(this._contentParent.innerHTML="",this._contentParent.appendChild(b))},getContentElement:function(){return this._contentParent},embedExplorer:function(b,
c,a){this._contentParent.innerHTML="";b.parent||(b.parent=c);this._contentParent.appendChild(b.parent);b.section=this;l.mixin(b,{createActionSections:function(){this.actionsSections&&this.actionsSections.forEach(function(a){if(!f.node(a)){var c=document.createElement("ul");c.id=a;c.classList.add("commandList");c.classList.add("layoutRight");this.section.actionsNode.appendChild(c)}}.bind(this))},getCommandsVisible:function(){return"hidden"!==this.section.actionsNode.style.visibility},setCommandsVisible:function(a){this.section.actionsNode.style.visibility=
a?"":"hidden";var c=a?null:"cursorOnly";this.renderer.selectionPolicy=c;var b=this.getNavHandler();b&&b.setSelectionPolicy(c);a?this.updateCommands():this.actionsSections&&this.actionsSections.forEach(function(a){f.node(a)&&this.commandRegistry.destroy(a)}.bind(this))},destroy:function(){Object.getPrototypeOf(this).destroy.call(this);var a=this;this.actionsSections&&(this.actionsSections.forEach(function(c){delete a[c]}),delete this.actionsSections)},updateCommands:function(a){this.section.actionsNode&&
this.getCommandsVisible()&&(this.createActionSections(),Object.getPrototypeOf(this).updateCommands.call(this,a))},loaded:function(){var c=this;!this.selection&&!a&&(this.serviceRegistry||this.registry?(this.selection=new g.Selection(this.serviceRegistry||this.registry,this.parent.id+"Selection"),this.selection.addEventListener("selectionChanged",function(a){c.updateCommands(a.selections)})):window.console.error("Could not create a Selection for the explorer because of lack of serviceRegistry"));var b=
this.registerCommands();!b||!b.then?c.updateCommands():b.then(function(){c.updateCommands()})}});b.renderer&&(b.renderer.section=this,l.mixin(b.renderer,{getCellHeaderElement:function(a){(a=Object.getPrototypeOf(this).getCellHeaderElement.call(this,a))&&this.section.setTitle(a.innerHTML);return null}}))},createProgressMonitor:function(){return new d(this)},_setMonitorMessage:function(b,c){this._progressNode.style.visibility="visible";this._loading[b]=c;var a="",d;for(d in this._loading)""!==a&&(a+=
"\n"),a+=this._loading[d];this._progressNode.title=a},_monitorDone:function(b){delete this._loading[b];var b="",c;for(c in this._loading)""!==b&&(b+="\n"),b+=this._loading[c];this._progressNode.title=b;""===b&&(this._progressNode.style.visibility="hidden")},_changeExpandedState:function(){this.hidden?(this._contentParent.style.display="block",this.domNode.classList.remove("sectionWrapperClosed"),this.hidden=!1):(this._contentParent.style.display="none",this.domNode.classList.add("sectionWrapperClosed"),
this.hidden=!0);this._updateExpandedState(!this.hidden,!0)},_updateExpandedState:function(b,c){var a=this.twistie,d=this.id;a&&(a.classList.add(b?this._expandImageClass:this._collapseImageClass),a.classList.remove(b?this._collapseImageClass:this._expandImageClass));this._preferenceService&&c&&this._preferenceService.getPreferences("/window/views").then(function(a){a.put(d,b)});this._onExpandCollapse&&this._onExpandCollapse(b,this)}};e.prototype.constructor=e;d.prototype={begin:function(b){this.status=
b;this._section._setMonitorMessage(this.id,b)},worked:function(b){this.status=b;this._section._setMonitorMessage(this.id,b)},done:function(b){this.status=b;this._section._monitorDone(this.id)}};d.prototype.constructor=d;return{Section:e}});
define("orion/markdownView","marked/marked orion/editor/editor orion/objects orion/webui/littlelib orion/URITemplate orion/PageUtil orion/section orion/URL-shim".split(" "),function(f,m,q,b,l,g,e){function d(a){var c=f.InlineLexer.prototype.outputLink,b=g.matchResourceParameters().resource,d=new URL(b,window.location.href),e=f.InlineLexer.prototype,n=-1===b.indexOf(":");e.outputLink=function(a,b){if(-1===b.href.indexOf(":"))try{var e;"filesystem:"===d.protocol?e={href:"filesystem:"+(new URL(b.href,
d.pathname)).href}:(e=new URL(b.href,d),n&&(e.protocol="",e.host=""));b.href="!"!==a[0][0]?k.expand({resource:e.href}):e.href}catch(f){console.log(f)}return c.call(this,a,b)};a=f(a,{sanitize:!0});f.InlineLexer.prototype.outputLink=c;return a}function h(a){this.fileClient=a.fileClient;this.progress=a.progress;this.canHide=a.canHide;this._node=null}function c(a){this.id="orion.markdownViewer";n.apply(this,arguments)}function a(a){this._parent=a.parent;this.serviceRegistry=a.serviceRegistry;this.contentTypeRegistry=
a.contentTypeRegistry;this.commandRegistry=a.commandRegistry;this.progress=a.progressService;this.model=a.model;this.undoStack=a.undoStack}var k=new l("#{,resource,params*}");h.prototype={display:function(a,c){a.classList.add("orionMarkdown");a.innerHTML=d(c)},displayContents:function(a,c){var d=c.Location||c;b.empty(a);var e=document.createElement("div");(this.progress?this.progress.progress(this.fileClient.read(d),"Reading file "+(c.Name||d)):this.fileClient.read(d)).then(function(a){this.display.bind(this)(e,
a)}.bind(this));a.appendChild(e)},displayInFrame:function(a,c,b,d,k){a=new e.Section(a,{id:"markdownSection",title:c.Name||k||"readme",headerClass:b,canHide:this.canHide});d&&(b=a.getTitleElement())&&b.classList.add(d);this.displayContents.call(this,a.getContentElement(),c)}};var n=m.BaseEditor;c.prototype=Object.create(n.prototype);q.mixin(c.prototype,{install:function(){var a=this._rootDiv=document.createElement("div");a.style.width="100%";a.style.height="100%";var c=this._contentDiv=document.createElement("div");
c.classList.add("orionMarkdown");a.appendChild(c);b.node(this._domNode).appendChild(a);this._contentDiv.innerHTML=d(this.getModel().getText());n.prototype.install.call(this)},setInput:function(a,c,b,e){n.prototype.setInput.call(this,a,c,b,e);!c&&!e&&(this._contentDiv.innerHTML=d(b))},uninstall:function(){b.empty(this._domNode);n.prototype.uninstall.call(this)}});a.prototype={create:function(){this.editor=new c({domNode:this._parent,model:this.model,undoStack:this.undoStack});this.editor.install()},
destroy:function(){this.editor&&this.editor.destroy();this.editor=null}};return{MarkdownEditorView:a,MarkdownView:h}});
define("orion/widgets/browse/browseView","i18n!orion/edit/nls/messages orion/explorers/explorer-table orion/explorers/navigatorRenderer orion/markdownView orion/PageUtil orion/URITemplate orion/webui/littlelib orion/objects orion/Deferred orion/webui/dropdown orion/section".split(" "),function(f,m,q,b,l,g,e,d,h,c,a){function k(){s.apply(this,arguments)}function n(a){a.setFocus=!1;a.cachePrefix=null;a.rendererFactory=function(c){return new k({checkbox:!1,treeTableClass:"sectionTreeTable",cachePrefix:"FolderNavigator"},
c,a.commandRegistry,a.contentTypeRegistry)};u.apply(this,arguments);this.commandsId=".folderNav";this.fileClient=a.fileClient;this.commandRegistry=a.commandRegistry;this.contentTypeRegistry=a.contentTypeRegistry;this.readonly=a.readonly;this.folderViewer=a.fodlerViewer;this.breadCrumbMaker=a.breadCrumbMaker;this.clickHandler=a.clickHandler;this.treeRoot={};this.parent=e.node(a.parentId);this.toolbarId=this.parent.id+"Tool";this.newActionsScope=this.parent.id+"NewScope";this.selectionActionsScope=
this.parent.id+"SelectionScope";this.actionsSections=[this.newActionsScope,this.selectionActionsScope]}function p(a){this._parent=a.parent;this._metadata=a.metadata;this.fileClient=a.fileService;this.progress=a.progressService;this.commandRegistry=a.commandRegistry;this.contentTypeRegistry=a.contentTypeRegistry;this.preferences=a.preferences;this.readonly=!0;this.editorView=a.editorView;this._maxEditorLines=a.maxEditorLines;this.imageView=a.imageView;this.messageView=a.messageView;this.breadCrumbInHeader=
a.breadCrumbInHeader;this.isMarkdownView=a.isMarkdownView;this.repoURLHandler=a.repoURLHandler;this.breadCrumbMaker=a.breadCrumbMaker;this.branchSelector=a.branchSelector;this.componentSelector=a.componentSelector;this.clickHandler=a.clickHandler;this._init()}var u=m.FileExplorer,s=q.NavigatorRenderer,w=new g("#{,resource,params*}");k.prototype=Object.create(s.prototype);d.mixin(k.prototype,{showFolderImage:!0,createFolderNode:function(a){var c=q.NavigatorRenderer.prototype.createFolderNode.call(this,
a);this.showFolderLinks&&"A"===c.tagName&&(c.href=w.expand({resource:a.Location}));c.classList.add("folderNavFolder");c.classList.add("navlink");c.classList.add("targetSelector");c.classList.remove("navlinkonpage");this.explorer.readonly&&this.explorer.clickHandler&&(c.href="javascript:void(0)",c.addEventListener("click",function(){this.explorer.clickHandler(a.Location)}.bind(this),!1));return c},updateFileNode:function(a,c,b){q.NavigatorRenderer.prototype.updateFileNode.call(this,a,c,b);this.explorer.readonly&&
"A"===c.tagName&&(this.explorer.clickHandler?(c.href="javascript:void(0)",c.addEventListener("click",function(){this.explorer.clickHandler(a.Location)}.bind(this),!1)):c.href=w.expand({resource:a.Location}))},getCellHeaderElement:function(a){if(this.explorer.breadCrumbMaker)return null;if(0===a){a=document.createElement("th");a.colSpan=1;var c=this.explorer.treeRoot;a.appendChild(document.createTextNode(c.Parents?c.Name:this.explorer.fileClient.fileServiceName(c.Location)));return a}return null},
emptyCallback:function(a){this.explorer.readonly?this.explorer.folderViewer.updateMessageContents("This folder is empty.",["emptyViewTable"],null,!0):q.NavigatorRenderer.prototype.emptyCallback.call(this,a)},getExpandImage:function(){return null}});n.prototype=Object.create(u.prototype);d.mixin(n.prototype,{loadRoot:function(a){a?this.load(a,"Loading "+a.Name).then(this.loaded.bind(this)):this.loadResourceList(l.matchResourceParameters().resource+"?depth=1",!1).then(this.loaded.bind(this))},loaded:function(){},
registerCommands:function(){return(new h).resolve()},updateCommands:function(){},setCommandsVisible:function(a,c){a.actionsNode.style.visibility=c?"":"hidden";var b=c?null:"cursorOnly";this.renderer.selectionPolicy=b;var d=this.getNavHandler();d&&d.setSelectionPolicy(b);c?this.updateCommands():this.actionsSections&&this.actionsSections.forEach(function(a){e.node(a)&&this.commandRegistry.destroy(a)}.bind(this))}});p.prototype={_init:function(){this.markdownView=new b.MarkdownView({fileClient:this.fileClient,
canHide:!this.readonly,progress:this.progress})},_isCommandsVisible:function(){return!this.readonly},displayWorkspaceView:function(){this._node||(this._node=document.createElement("div"),this._node.classList.add("browse_inner_container"));this._parent.appendChild(this._node)},displayBrowseView:function(b){var b=b&&b.Children,d;if(b)for(var k=0;k<b.length;k++){var f=b[k];!f.Directory&&(f.Name&&"readme.md"===f.Name.toLowerCase())&&(d=f)}var h;this._node||(this._node=document.createElement("div"),this._node.classList.add("browse_inner_container"));
this._parent.appendChild(this._node);(function(b){b.forEach(function(b){if("folderNav"===b){b=document.createElement("div");b.id="folderNavNode";this._foldersSection=new a.Section(this._node,{id:"folderNavSection",headerClass:["sectionTreeTableHeader"],title:"Browse",canHide:!this.readonly});this.sectionContents=document.createElement("div");this.sectionContents.classList.add("browseSectionWrapper");this._foldersSection.setContent(this.sectionContents);if(!this.messageView&&this.repoURLHandler){var k=
this._foldersSection.getActionElement();if(k){e.empty(k);var f=document.createElement("div"),g=document.createElement("div");f.classList.add("layoutLeft");g.classList.add("layoutRight");k.appendChild(f);k.appendChild(g);this.actionNode=g;k=document.createRange();k.selectNode(f);k=k.createContextualFragment(this.repoURLHandler.RepoURLTriggerTemplate);f.appendChild(k);this.repoURLDropdown=new c.Dropdown({triggerNode:e.node("orion.browse.repoURLTrigger"),dropdown:e.node("orion.browse.repoURLDropdown")});
this.repoURLDropdown.getItems=function(){e.node("orion.browse.repoURLInput").value=this.repoURLHandler.promptValue;return[e.node("orion.browse.repoURLInput")]}.bind(this);this.repoURLDropdown._positionDropdown=function(){this._dropdownNode.style.left="";this._dropdownNode.style.top="";this._dropdownNode.style.left=this._triggerNode.offsetLeft+this._triggerNode.offsetWidth-this._dropdownNode.offsetWidth+"px";e.node("orion.browse.repoURLInput").select()}.bind(this.repoURLDropdown)}}else this.messageView||
(this.actionNode=this._foldersSection.getActionElement());!this.messageView&&this.commandRegistry&&this.commandRegistry.renderCommands("orion.browse.sectionActions",this.actionNode,{},"button");if(f=this._foldersSection.getTitleElement())e.empty(f),this.branchSelector&&(f.appendChild(this.branchSelector.parentNode),this.branchSelector.refresh()),this.componentSelector&&(f.appendChild(this.componentSelector.parentNode),this.componentSelector.refresh());this.breadCrumbMaker&&(k=document.createElement("div"),
g=document.createElement("div"),k.appendChild(g),this.breadCrumbInHeader?(k.classList.add("breadCrumbContainerInHeader"),f.appendChild(k),this.breadCrumbMaker(g,this._foldersSection.getHeaderElement().offsetWidth-150-50)):(k.classList.add("breadCrumbContainer"),this.sectionContents.appendChild(k),this.breadCrumbMaker(g,this._foldersSection.getHeaderElement().offsetWidth-5)));if(this.messageView)"string"===typeof this.messageView.message&&this.updateMessageContents(this.messageView.message,this.messageView.classes?
this.messageView.classes:["messageViewTable"],this.messageView.tdClass);else if(this.editorView){this.sectionContents.appendChild(this.editorView.getParent());this.editorView.getParent().style.height="30px";this.editorView.create();var p=this.editorView.editor.getTextView();p.getModel().addEventListener("Changed",this._editorViewModelChangedListener=function(){var a=p.getModel().getLineCount();this._maxEditorLines&&(0<this._maxEditorLines&&a>this._maxEditorLines)&&(a=this._maxEditorLines);a=p.getLineHeight()*
a+20;this.editorView.getParent().style.height=a+"px"}.bind(this));this.editor=this.editorView.editor}else this.isMarkdownView?(h=document.createElement("div"),this.markdownView.displayContents(h,this._metadata),this.sectionContents.appendChild(h)):this.imageView?this.imageView.image&&this.updateImage(this.imageView.image):(this.folderNavExplorer=new n({parentId:b,fodlerViewer:this,readonly:this.readonly,breadCrumbMaker:this.breadCrumbMaker,clickHandler:this.clickHandler,fileClient:this.fileClient,
commandRegistry:this.commandRegistry,contentTypeRegistry:this.contentTypeRegistry}),this.sectionContents.appendChild(this.folderNavExplorer.parent),this.folderNavExplorer.setCommandsVisible(this._foldersSection,this._isCommandsVisible()),this.folderNavExplorer.loadRoot(this._metadata))}else"readme"===b&&d&&(h=document.createElement("div"),this.markdownView.displayInFrame(h,d,["sectionTreeTableHeader","readmeHeader"],"readmeTitle"),this._node.appendChild(h))}.bind(this))}).apply(this,[["folderNav",
"readme"]])},updateImage:function(a){var c=document.createElement("table");c.classList.add("imageViewTable");var b=document.createElement("tr"),d=document.createElement("td"),e=document.createElement("div");e.appendChild(a);d.appendChild(e);b.appendChild(d);c.appendChild(b);this.sectionContents.appendChild(c)},updateMessageContents:function(a,c,b,d){var k=document.createElement("table");c&&c.forEach(function(a){k.classList.add(a)});var c=document.createElement("tr"),f=document.createElement("td");
b&&f.classList.add(b);b=document.createElement("div");b.appendChild(document.createTextNode(a));f.appendChild(b);c.appendChild(f);k.appendChild(c);d||e.empty(this.sectionContents);this.sectionContents.appendChild(k)},create:function(){this._metadata&&this._metadata.Projects&&this.displayWorkspaceView();this.editorView||this.imageView||this.isMarkdownView||this.messageView?this.displayBrowseView(this._metadata):this._metadata.Children?this.displayBrowseView(this._metadata):this._metadata.ChildrenLocation&&
this.progress.progress(this.fileClient.fetchChildren(this._metadata.ChildrenLocation),"Fetching children of "+this._metadata.Name).then(function(a){this._metadata.Children=a;this.displayBrowseView(this._metadata)}.bind(this))},destroy:function(){this.editorView&&(this.editorView.editor.getTextView().getModel().removeEventListener("Changed",this._editorViewModelChangedListener),this.editorView.destroy(),this.editor=null);this.folderNavExplorer&&this.folderNavExplorer.destroy();this.repoURLDropdown&&
this.repoURLDropdown.destroy();this.folderNavExplorer=null;this._node&&this._node.parentNode&&this._node.parentNode.removeChild(this._node);this._node=null}};return{BrowseView:p}});
define("orion/editor/find","i18n!orion/editor/nls/messages orion/keyBinding orion/editor/keyModes orion/editor/annotations orion/regex orion/objects orion/util".split(" "),function(f,m,q,b,l,g,e){function d(a){var c=a.getTextView();q.KeyMode.call(this,c);this.editor=a;this._active=!1;this._success=!0;this._ignoreSelection=!1;this._prefix="";c.setAction("incrementalFindCancel",function(){this.setActive(!1);return!0}.bind(this));c.setAction("incrementalFindBackspace",function(){return this._backspace()}.bind(this));
var b=this;this._listener={onVerify:function(a){var c=b.editor,d=c.getModel(),e=c.mapOffset(a.start),c=c.mapOffset(a.end),d=d.getText(e,c);if((d=b._prefix.match(RegExp("^"+l.escape(d),"i")))&&0<d.length)b._prefix+=a.text,b._success=!0,b._status(),b.find(b._forward,!0),a.text=null},onSelection:function(){b._ignoreSelection||b.setActive(!1)}}}function h(a,c,b){if(a){this._editor=a;this._undoStack=c;this._showAll=!0;this._visible=!1;this._wrap=this._caseInsensitive=!0;this._wholeWord=!1;this._incremental=
!0;this._regex=!1;this._findAfterReplace=!0;this._reverse=this._hideAfterFind=!1;this._timer=this._end=this._start=void 0;this._lastString="";var d=this;this._listeners={onEditorFocus:function(a){d._removeCurrentAnnotation(a)}};this.setOptions(b)}}var c={};d.prototype=new q.KeyMode;g.mixin(d.prototype,{createKeyBindings:function(){var a=m.KeyBinding,c=[];c.push({actionID:"incrementalFindBackspace",keyBinding:new a(8)});c.push({actionID:"incrementalFindCancel",keyBinding:new a(13)});c.push({actionID:"incrementalFindCancel",
keyBinding:new a(27)});c.push({actionID:"incrementalFindReverse",keyBinding:new a(38)});c.push({actionID:"incrementalFind",keyBinding:new a(40)});c.push({actionID:"incrementalFindReverse",keyBinding:new a("k",!0,!0)});c.push({actionID:"incrementalFind",keyBinding:new a("k",!0)});return c},find:function(a,c){this._forward=a;if(!this.isActive())return this.setActive(!0),!1;var b=this._prefix;if(0===b.length)return!1;var d=this.editor,e=d.getModel(),e=a?this._success?c?this._start:d.getCaretOffset()+
1:0:this._success?c?this._start:d.getCaretOffset():e.getCharCount()-1;(b=d.getModel().find({string:b,start:e,reverse:!a,caseInsensitive:b.toLowerCase()===b}).next())?(c||(this._start=e),this._ignoreSelection=this._success=!0,d.moveSelection(a?b.start:b.end,a?b.end:b.start),this._ignoreSelection=!1):this._success=!1;this._status();return!0},isActive:function(){return this._active},isStatusActive:function(){return this.isActive()},setActive:function(a){this._active!==a&&(this._active=a,this._prefix=
"",this._success=!0,a=this.editor.getTextView(),this._start=this.editor.getCaretOffset(),this.editor.setCaretOffset(this._start),this._active?(a.addEventListener("Verify",this._listener.onVerify),a.addEventListener("Selection",this._listener.onSelection),a.addKeyMode(this)):(a.removeEventListener("Verify",this._listener.onVerify),a.removeEventListener("Selection",this._listener.onSelection),a.removeKeyMode(this)),this._status())},_backspace:function(){var a=this._prefix,a=this._prefix=a.substring(0,
a.length-1);return 0===a.length?(this._ignoreSelection=this._success=!0,this.editor.setCaretOffset(this.editor.getSelection().start),this._ignoreSelection=!1,this._status(),!0):this.find(this._forward,!0)},_status:function(){if(this.isActive()){var a;a=this._forward?this._success?f.incrementalFindStr:f.incrementalFindStrNotFound:this._success?f.incrementalFindReverseStr:f.incrementalFindReverseStrNotFound;a=e.formatMessage(a,this._prefix);this.editor.reportStatus(a,this._success?"":"error")}else this.editor.reportStatus("")}});
c.IncrementalFind=d;h.prototype={find:function(a,c,b){this.setOptions({reverse:!a});var d=this.getFindString(),e;c&&(d=c.findString||d,e=c.count);a=this.getOptions();this.setOptions(c);c=b?this._startOffset:this.getStartOffset();if((e=this._doFind(d,c,e))&&!b)this._startOffset=e.start;this.setOptions(a);this._hideAfterFind&&this.hide();return e},getStartOffset:function(){return void 0!==this._start?this._start:this._reverse?this._editor.getSelection().start-1:this._editor.getCaretOffset()},getFindString:function(){var a=
this._editor.getSelection(),a=this._editor.getText(a.start,a.end);this._regex&&(a=l.escape(a));return a||this._lastString},getOptions:function(){return{showAll:this._showAll,caseInsensitive:this._caseInsensitive,wrap:this._wrap,wholeWord:this._wholeWord,incremental:this._incremental,regex:this._regex,findAfterReplace:this._findAfterReplace,hideAfterFind:this._hideAfterFind,reverse:this._reverse,findCallback:this._findCallback,start:this._start,end:this._end}},getReplaceString:function(){return""},
hide:function(){this._visible=!1;this._savedOptions&&(this.setOptions(this._savedOptions.pop()),0===this._savedOptions.length&&(this._savedOptions=null));this._removeAllAnnotations();var a=this._editor.getTextView();a&&(a.removeEventListener("Focus",this._listeners.onEditorFocus),a.focus())},_processReplaceString:function(a){var c=a;if(this._regex){for(var c="",b=!1,d=this._editor.getModel().getLineDelimiter(),e=0;e<a.length;e++){var f=a.substring(e,e+1);if(b){switch(f){case "R":c+=d;break;case "r":c+=
"\r";break;case "n":c+="\n";break;case "t":c+="\t";break;case "\\":c+="\\";break;default:c+="\\"+f}b=!1}else"\\"===f?b=!0:c+=f}b&&(c+="\\")}return c},isVisible:function(){return this._visible},replace:function(){var a=this.getFindString();if(a){var c=this._editor,b=this._processReplaceString(this.getReplaceString()),d=c.getSelection().start;if(c=c.getModel().find({string:a,start:d,reverse:!1,wrap:this._wrap,regex:this._regex,wholeWord:this._wholeWord,caseInsensitive:this._caseInsensitive}).next())this.startUndo(),
this._doReplace(c.start,c.end,a,b),this.endUndo()}this._findAfterReplace&&a&&this._doFind(a,this.getStartOffset())},replaceAll:function(){var a=this.getFindString();if(a){this._replacingAll=!0;var c=this._editor,b=c.getTextView();c.reportStatus(f.replaceAll);var d=this._processReplaceString(this.getReplaceString()),h=this;window.setTimeout(function(){for(var g=0,l=0;;){var m=h._doFind(a,g,null,!0);if(!m)break;l++;1===l&&(b.setRedraw(!1),h.startUndo());h._doReplace(m.start,m.end,a,d);g=h.getStartOffset()}0<
l&&(h.endUndo(),b.setRedraw(!0));0<g?c.reportStatus(e.formatMessage(f.replacedMatches,l)):c.reportStatus(f.nothingReplaced,"error");h._replacingAll=!1},100)}},setOptions:function(a){if(a){if((!0===a.showAll||!1===a.showAll)&&this._showAll!==a.showAll)if(this._showAll=a.showAll,this.isVisible())if(this._showAll)this._markAllOccurrences();else{var c=this._editor.getAnnotationModel();c&&c.removeAnnotations(b.AnnotationType.ANNOTATION_MATCHING_SEARCH)}if(!0===a.caseInsensitive||!1===a.caseInsensitive)this._caseInsensitive=
a.caseInsensitive;if(!0===a.wrap||!1===a.wrap)this._wrap=a.wrap;if(!0===a.wholeWord||!1===a.wholeWord)this._wholeWord=a.wholeWord;if(!0===a.incremental||!1===a.incremental)this._incremental=a.incremental;if(!0===a.regex||!1===a.regex)this._regex=a.regex;if(!0===a.findAfterReplace||!1===a.findAfterReplace)this._findAfterReplace=a.findAfterReplace;if(!0===a.hideAfterFind||!1===a.hideAfterFind)this._hideAfterFind=a.hideAfterFind;if(!0===a.reverse||!1===a.reverse)this._reverse=a.reverse;a.hasOwnProperty("findCallback")&&
(this._findCallback=a.findCallback);a.hasOwnProperty("start")&&(this._start=a.start);a.hasOwnProperty("end")&&(this._end=a.end)}},show:function(a){this._visible=!0;a&&(this._savedOptions||(this._savedOptions=[]),this._savedOptions.push(this.getOptions()),this.setOptions(a));this._startOffset=this._editor.getSelection().start;this._editor.getTextView().addEventListener("Focus",this._listeners.onEditorFocus);var c=this;window.setTimeout(function(){c._incremental&&c.find(!0,null,!0)},0)},startUndo:function(){this._undoStack&&
this._undoStack.startCompoundChange()},endUndo:function(){this._undoStack&&this._undoStack.endCompoundChange()},_find:function(a,c,b){return this._editor.getModel().find({string:a,start:c,end:this._end,reverse:this._reverse,wrap:b?!1:this._wrap,regex:this._regex,wholeWord:this._wholeWord,caseInsensitive:this._caseInsensitive})},_doFind:function(a,c,d,e){var d=d||1,h=this._editor;if(!a)return this._removeAllAnnotations(),null;this._lastString=a;var g,l;if(this._regex)try{l=this._find(a,c,e)}catch(m){h.reportStatus(m.message,
"error");return}else l=this._find(a,c,e);for(a=0;a<d&&l.hasNext();a++)g=l.next();if(!this._replacingAll){g?this._editor.reportStatus(""):this._editor.reportStatus(f.notFound,"error");if(this.isVisible()){d=b.AnnotationType.ANNOTATION_CURRENT_SEARCH;if(l=h.getAnnotationModel())l.removeAnnotations(d),g&&l.addAnnotation(b.AnnotationType.createAnnotation(d,g.start,g.end));if(this._showAll){this._timer&&window.clearTimeout(this._timer);var q=this;this._timer=window.setTimeout(function(){q._markAllOccurrences();
q._timer=null},500)}}this._findCallback?this._findCallback(g):g&&h.moveSelection(g.start,g.end,null,!1)}return g},_doReplace:function(a,c,b,d){var e=this._editor;if(this._regex&&(d=e.getText(a,c).replace(RegExp(b,this._caseInsensitive?"i":""),d),!d))return;e.setText(d,a,c);e.setSelection(a,a+d.length,!0)},_markAllOccurrences:function(){var a=this._editor.getAnnotationModel();if(a){for(var c=b.AnnotationType.ANNOTATION_MATCHING_SEARCH,d=a.getAnnotations(),e=[],f;d.hasNext();){var h=d.next();h.type===
c&&e.push(h)}if(this.isVisible()){d=this.getFindString();d=this._editor.getModel().find({string:d,regex:this._regex,wholeWord:this._wholeWord,caseInsensitive:this._caseInsensitive});for(f=[];d.hasNext();)h=d.next(),f.push(b.AnnotationType.createAnnotation(c,h.start,h.end))}a.replaceAnnotations(e,f)}},_removeAllAnnotations:function(){var a=this._editor.getAnnotationModel();a&&(a.removeAnnotations(b.AnnotationType.ANNOTATION_CURRENT_SEARCH),a.removeAnnotations(b.AnnotationType.ANNOTATION_MATCHING_SEARCH))},
_removeCurrentAnnotation:function(){var a=this._editor.getAnnotationModel();a&&a.removeAnnotations(b.AnnotationType.ANNOTATION_CURRENT_SEARCH)}};c.Find=h;return c});
define("orion/editor/actions","i18n!orion/editor/nls/messages orion/keyBinding orion/editor/annotations orion/editor/tooltip orion/editor/find orion/util".split(" "),function(f,m,q,b,l,g){function e(a,c,b){this.editor=a;this.undoStack=c;this._incrementalFind=new l.IncrementalFind(a);this._find=b?b:new l.Find(a,c);this._lastEditLocation=null;this.init()}function d(a,c,b,d){this.editor=a;this.undoStack=c;this.contentAssist=b;this.linkedMode=d;this.contentAssist&&this.contentAssist.addEventListener("ProposalApplied",
this.contentAssistProposalApplied.bind(this));this.init()}var h=q.AnnotationType,c={};e.prototype={init:function(){var a=this.editor.getTextView();this._lastEditListener={onModelChanged:function(a){this.editor.isDirty()&&(this._lastEditLocation=a.start+a.addedCharCount)}.bind(this)};a.addEventListener("ModelChanged",this._lastEditListener.onModelChanged);a.setAction("undo",function(a){if(this.undoStack){var c=1;a&&a.count&&(c=a.count);for(;0<c;)this.undoStack.undo(),--c;return!0}return!1}.bind(this),
{name:f.undo});a.setAction("redo",function(a){if(this.undoStack){var c=1;a&&a.count&&(c=a.count);for(;0<c;)this.undoStack.redo(),--c;return!0}return!1}.bind(this),{name:f.redo});a.setKeyBinding(new m.KeyBinding("f",!0),"find");a.setAction("find",function(){if(this._find){var a=this.editor.getSelection();(a=prompt(f.find,this.editor.getText(a.start,a.end)))&&this._find.find(!0,{findString:a})}}.bind(this),{name:f.find});a.setKeyBinding(new m.KeyBinding("k",!0),"findNext");a.setAction("findNext",function(a){return this._find?
(this._find.find(!0,a),!0):!1}.bind(this),{name:f.findNext});a.setKeyBinding(new m.KeyBinding("k",!0,!0),"findPrevious");a.setAction("findPrevious",function(a){return this._find?(this._find.find(!1,a),!0):!1}.bind(this),{name:f.findPrevious});a.setKeyBinding(new m.KeyBinding("j",!0),"incrementalFind");a.setAction("incrementalFind",function(){this._incrementalFind&&this._incrementalFind.find(!0);return!0}.bind(this),{name:f.incrementalFind});a.setKeyBinding(new m.KeyBinding("j",!0,!0),"incrementalFindReverse");
a.setAction("incrementalFindReverse",function(){this._incrementalFind&&this._incrementalFind.find(!1);return!0}.bind(this),{name:f.incrementalFindReverse});a.setAction("tab",function(){return this.indentLines()}.bind(this));a.setAction("shiftTab",function(){return this.unindentLines()}.bind(this),{name:f.unindentLines});a.setKeyBinding(new m.KeyBinding(38,!1,!1,!0),"moveLinesUp");a.setAction("moveLinesUp",function(){return this.moveLinesUp()}.bind(this),{name:f.moveLinesUp});a.setKeyBinding(new m.KeyBinding(40,
!1,!1,!0),"moveLinesDown");a.setAction("moveLinesDown",function(){return this.moveLinesDown()}.bind(this),{name:f.moveLinesDown});a.setKeyBinding(new m.KeyBinding(38,!0,!1,!0),"copyLinesUp");a.setAction("copyLinesUp",function(){return this.copyLinesUp()}.bind(this),{name:f.copyLinesUp});a.setKeyBinding(new m.KeyBinding(40,!0,!1,!0),"copyLinesDown");a.setAction("copyLinesDown",function(){return this.copyLinesDown()}.bind(this),{name:f.copyLinesDown});a.setKeyBinding(new m.KeyBinding("d",!0,!1,!1),
"deleteLines");a.setAction("deleteLines",function(a){return this.deleteLines(a)}.bind(this),{name:f.deleteLines});a.setKeyBinding(new m.KeyBinding("l",!g.isMac,!1,!1,g.isMac),"gotoLine");a.setAction("gotoLine",function(){return this.gotoLine()}.bind(this),{name:f.gotoLine});a.setKeyBinding(new m.KeyBinding(190,!0),"nextAnnotation");a.setAction("nextAnnotation",function(){return this.nextAnnotation(!0)}.bind(this),{name:f.nextAnnotation});a.setKeyBinding(new m.KeyBinding(188,!0),"previousAnnotation");
a.setAction("previousAnnotation",function(){return this.nextAnnotation(!1)}.bind(this),{name:f.prevAnnotation});a.setKeyBinding(new m.KeyBinding("e",!0,!1,!0,!1),"expand");a.setAction("expand",function(){return this.expandAnnotation(!0)}.bind(this),{name:f.expand});a.setKeyBinding(new m.KeyBinding("c",!0,!1,!0,!1),"collapse");a.setAction("collapse",function(){return this.expandAnnotation(!1)}.bind(this),{name:f.collapse});a.setKeyBinding(new m.KeyBinding("e",!0,!0,!0,!1),"expandAll");a.setAction("expandAll",
function(){return this.expandAnnotations(!0)}.bind(this),{name:f.expandAll});a.setKeyBinding(new m.KeyBinding("c",!0,!0,!0,!1),"collapseAll");a.setAction("collapseAll",function(){return this.expandAnnotations(!1)}.bind(this),{name:f.collapseAll});a.setKeyBinding(new m.KeyBinding("q",!g.isMac,!1,!1,g.isMac),"lastEdit");a.setAction("lastEdit",function(){return this.gotoLastEdit()}.bind(this),{name:f.lastEdit})},copyLinesDown:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;
var c=a.getModel(),b=a.getSelection(),d=c.getLineAtOffset(b.start),b=c.getLineAtOffset(b.end>b.start?b.end-1:b.end),e=c.getLineStart(d),d=c.getLineEnd(b,!0),f=c.getLineCount(),h="",e=c.getText(e,d);b===f-1&&(e=(h=c.getLineDelimiter())+e);a.setText(e,d,d);a.setSelection(d+h.length,d+e.length);return!0},copyLinesUp:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var c=a.getModel(),b=a.getSelection(),d=c.getLineAtOffset(b.start),b=c.getLineAtOffset(b.end>b.start?b.end-
1:b.end),d=c.getLineStart(d),e=c.getLineEnd(b,!0),f=c.getLineCount(),h="",e=c.getText(d,e);b===f-1&&(e+=h=c.getLineDelimiter());a.setText(e,d,d);a.setSelection(d,d+e.length-h.length);return!0},deleteLines:function(a){var c=this.editor;if(c.getTextView().getOptions("readonly"))return!1;var b=1;a&&a.count&&(b=a.count);var d=c.getSelection(),e=c.getModel(),f=e.getLineAtOffset(d.start),a=e.getLineStart(f),b=d.start!==d.end||1===b?e.getLineAtOffset(d.end>d.start?d.end-1:d.end):Math.min(f+b-1,e.getLineCount()-
1),b=e.getLineEnd(b,!0);c.setText("",a,b);return!0},expandAnnotation:function(a){var c=this.editor,b=c.getAnnotationModel();if(!b)return!0;var d=c.getModel(),e=c.getCaretOffset(),f=d.getLineAtOffset(e),e=d.getLineStart(f),f=d.getLineEnd(f,!0);d.getBaseModel&&(e=d.mapOffset(e),f=d.mapOffset(f),d.getBaseModel());for(var h,b=b.getAnnotations(e,f);!h&&b.hasNext();)d=b.next(),d.type===q.AnnotationType.ANNOTATION_FOLDING&&(h=d);h&&a!==h.expanded&&(a?h.expand():(c.setCaretOffset(h.start),h.collapse()));
return!0},expandAnnotations:function(a){var c=this.editor,b=c.getTextView(),d=c.getAnnotationModel();if(!d)return!0;c.getModel();d=d.getAnnotations();for(b.setRedraw(!1);d.hasNext();)c=d.next(),c.type===q.AnnotationType.ANNOTATION_FOLDING&&a!==c.expanded&&(a?c.expand():c.collapse());b.setRedraw(!0);return!0},indentLines:function(){var a=this.editor,c=a.getTextView();if(c.getOptions("readonly"))return!1;if(c.getOptions("tabMode")){var b=a.getModel(),d=a.getSelection(),e=b.getLineAtOffset(d.start),
f=b.getLineAtOffset(d.end>d.start?d.end-1:d.end);if(e!==f){var h=[];h.push("");for(var g=e;g<=f;g++)h.push(b.getLine(g,!0));g=b.getLineStart(e);b=b.getLineEnd(f,!0);c=c.getOptions("tabSize","expandTab");c=c.expandTab?Array(c.tabSize+1).join(" "):"\t";a.setText(h.join(c),g,b);a.setSelection(g===d.start?d.start:d.start+c.length,d.end+(f-e+1)*c.length);return!0}return!1}},gotoLastEdit:function(){"number"===typeof this._lastEditLocation&&this.editor.showSelection(this._lastEditLocation);return!0},gotoLine:function(){var a=
this.editor,c=a.getModel().getLineAtOffset(a.getCaretOffset());if(c=prompt(f.gotoLinePrompty,c+1))c=parseInt(c,10),a.onGotoLine(c-1,0);return!0},moveLinesDown:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var c=a.getModel(),b=a.getSelection(),d=c.getLineAtOffset(b.start),e=c.getLineAtOffset(b.end>b.start?b.end-1:b.end),f=c.getLineCount();if(e===f-1)return!0;var d=c.getLineStart(d),b=c.getLineEnd(e,!0),h=c.getLineEnd(e+1,!0)-(b-d),g=0;e!==f-2?c=c.getText(d,b):(e=c.getLineEnd(e),
c=c.getText(e,b)+c.getText(d,e),g+=b-e);this.startUndo();a.setText("",d,b);a.setText(c,h,h);a.setSelection(h+g,h+g+c.length);this.endUndo();return!0},moveLinesUp:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var c=a.getModel(),b=a.getSelection(),d=c.getLineAtOffset(b.start);if(0===d)return!0;var e=c.getLineAtOffset(b.end>b.start?b.end-1:b.end),f=c.getLineCount(),b=c.getLineStart(d-1),h=c.getLineStart(d),g=c.getLineEnd(e,!0),l=c.getText(h,g),m=0;e===f-1&&(e=c.getLineEnd(d-
1),d=c.getLineEnd(d-1,!0),l+=c.getText(e,d),h=e,m=d-e);this.startUndo();a.setText("",h,g);a.setText(l,b,b);a.setSelection(b,b+l.length-m);this.endUndo();return!0},nextAnnotation:function(a){function c(a){return!!a.lineStyle||a.type===h.ANNOTATION_MATCHING_BRACKET||a.type===h.ANNOTATION_CURRENT_BRACKET||!f.isAnnotationTypeVisible(a.type)}var d=this.editor,e=d.getAnnotationModel();if(!e)return!0;var f=d.getOverviewRuler()||d.getAnnotationStyler();if(!f)return!0;for(var g=d.getModel(),l=d.getCaretOffset(),
m=e.getAnnotations(a?l:0,a?g.getCharCount():l),q=null;m.hasNext();){var v=m.next();if(a){if(v.start<=l)continue}else if(v.start>=l)continue;if(!c(v)&&(q=v,a))break}if(q){for(var z=[q],m=e.getAnnotations(q.start,q.start);m.hasNext();)v=m.next(),v!==q&&!c(v)&&z.push(v);var r=d.getTextView(),t=g.getLineAtOffset(q.start),A=b.Tooltip.getTooltip(r);if(!A)return d.moveSelection(q.start),!0;d.moveSelection(q.start,q.start,function(){A.setTarget({getTooltipInfo:function(){var a=r.convert({x:r.getLocationAtOffset(q.start).x,
y:r.getLocationAtOffset(g.getLineStart(t)).y},"document","page");return{contents:z,x:a.x,y:a.y+Math.floor(1.33*r.getLineHeight(t))}}},0)})}return!0},unindentLines:function(){var a=this.editor,c=a.getTextView();if(c.getOptions("readonly"))return!1;if(c.getOptions("tabMode")){for(var b=a.getModel(),d=a.getSelection(),e=b.getLineAtOffset(d.start),f=b.getLineAtOffset(d.end>d.start?d.end-1:d.end),h=c.getOptions("tabSize"),g=Array(h+1).join(" "),l=[],m=c=0,q=e;q<=f;q++){var r=b.getLine(q,!0);if(b.getLineStart(q)!==
b.getLineEnd(q))if(0===r.indexOf("\t"))r=r.substring(1),c++;else if(0===r.indexOf(g))r=r.substring(h),c+=h;else return!0;q===e&&(m=c);l.push(r)}e=b.getLineStart(e);h=b.getLineEnd(f,!0);b=b.getLineStart(f);a.setText(l.join(""),e,h);f=e===d.start?d.start:d.start-m;d=Math.max(f,d.end-c+(d.end===b+1&&d.start!==d.end?1:0));a.setSelection(f,d);return!0}},startUndo:function(){this.undoStack&&this.undoStack.startCompoundChange()},endUndo:function(){this.undoStack&&this.undoStack.endCompoundChange()}};c.TextActions=
e;d.prototype={init:function(){var a=this.editor.getTextView();a.setAction("lineStart",function(){return this.lineStart()}.bind(this));a.setAction("enter",function(){return this.autoIndent()}.bind(this));a.setKeyBinding(new m.KeyBinding("t",!0,!1,!0),"trimTrailingWhitespaces");a.setAction("trimTrailingWhitespaces",function(){return this.trimTrailingWhitespaces()}.bind(this),{name:f.trimTrailingWhitespaces});a.setKeyBinding(new m.KeyBinding(191,!0),"toggleLineComment");a.setAction("toggleLineComment",
function(){return this.toggleLineComment()}.bind(this),{name:f.toggleLineComment});a.setKeyBinding(new m.KeyBinding(191,!0,!g.isMac,!1,g.isMac),"addBlockComment");a.setAction("addBlockComment",function(){return this.addBlockComment()}.bind(this),{name:f.addBlockComment});a.setKeyBinding(new m.KeyBinding(220,!0,!g.isMac,!1,g.isMac),"removeBlockComment");a.setAction("removeBlockComment",function(){return this.removeBlockComment()}.bind(this),{name:f.removeBlockComment});a.setKeyBinding(new m.KeyBinding("[",
!1,!1,!1,!1,"keypress"),"autoPairSquareBracket");a.setAction("autoPairSquareBracket",function(){return this.autoPairBrackets("[","]")}.bind(this));a.setKeyBinding(new m.KeyBinding("]",!1,!1,!1,!1,"keypress"),"skipClosingSquareBracket");a.setAction("skipClosingSquareBracket",function(){return this.skipClosingBracket("]")}.bind(this));a.setKeyBinding(new m.KeyBinding("<",!1,!1,!1,!1,"keypress"),"autoPairAngleBracket");a.setAction("autoPairAngleBracket",function(){return this.autoPairBrackets("<",">")}.bind(this));
a.setKeyBinding(new m.KeyBinding(">",!1,!1,!1,!1,"keypress"),"skipClosingAngleBracket");a.setAction("skipClosingAngleBracket",function(){return this.skipClosingBracket(">")}.bind(this));a.setKeyBinding(new m.KeyBinding("(",!1,!1,!1,!1,"keypress"),"autoPairParentheses");a.setAction("autoPairParentheses",function(){return this.autoPairBrackets("(",")")}.bind(this));a.setKeyBinding(new m.KeyBinding(")",!1,!1,!1,!1,"keypress"),"skipClosingParenthesis");a.setAction("skipClosingParenthesis",function(){return this.skipClosingBracket(")")}.bind(this));
a.setKeyBinding(new m.KeyBinding("{",!1,!1,!1,!1,"keypress"),"autoPairBraces");a.setAction("autoPairBraces",function(){return this.autoPairBrackets("{","}")}.bind(this));a.setKeyBinding(new m.KeyBinding("}",!1,!1,!1,!1,"keypress"),"skipClosingBrace");a.setAction("skipClosingBrace",function(){return this.skipClosingBracket("}")}.bind(this));a.setKeyBinding(new m.KeyBinding("'",!1,!1,!1,!1,"keypress"),"autoPairSingleQuotation");a.setAction("autoPairSingleQuotation",function(){return this.autoPairQuotations("'")}.bind(this));
a.setKeyBinding(new m.KeyBinding('"',!1,!1,!1,!1,"keypress"),"autoPairDblQuotation");a.setAction("autoPairDblQuotation",function(){return this.autoPairQuotations('"')}.bind(this));a.setAction("deletePrevious",function(){return this.deletePrevious()}.bind(this))},autoIndent:function(){var a=this.editor,c=a.getTextView();if(c.getOptions("readonly"))return!1;var b=a.getSelection();if(b.start===b.end){for(var d=a.getModel(),e=d.getLineAtOffset(b.start),f=d.getLine(e,!1),h=d.getLineStart(e),g=0,l=b.start-
h,m;g<l&&(32===(m=f.charCodeAt(g))||9===m);)g++;var h=f.substring(0,g),c=c.getOptions("tabSize","expandTab"),q=c.expandTab?Array(c.tabSize+1).join(" "):"\t",c=d.getLineDelimiter(),r=/^[\s]*\/\*[\*]*[\s]*$/,t=/^[\s]*\*/,A=/\*\/[\s]*$/,D=f.substring(0,l),C=f.substring(l),H;if(this.smartIndentation&&123===f.charCodeAt(H=D.trimRight().length-1))return d=l-H-1,C=C.length-C.trimLeft().length,f=125===f.charCodeAt(l+C)?c+h+q+c+h:c+h+q,a.setText(f,b.start-d,b.end+C),a.setCaretOffset(b.start+c.length+h.length+
q.length-d),!0;if(this.autoCompleteComments&&!A.test(D)&&(r.test(D)||t.test(D))){if(g=r.exec(D)){f=c+h+" * ";f=A.test(C)?f+C.substring(0,C.length-2).trim():f+C.trim();if(d.getLineCount()===e+1||!t.test(d.getLine(e+1)))f+=c+h+" */";a.setText(f,b.start,b.end+C.length);a.setCaretOffset(b.start+c.length+h.length+3);return!0}if(g=t.exec(D))for(e-=1;0<=e;e--){g=d.getLine(e,!1);if(r.test(g))return A.test(C)||47===f.charCodeAt(l)?(f=c+h+"*"+C,h=b.start+c.length+h.length+1):(f=c+h+"* "+C,h=b.start+c.length+
h.length+2),a.setText(f,b.start,b.end+C.length),a.setCaretOffset(h),!0;if(!t.test(g))break}}else{if(A.test(D)&&32===h.charCodeAt(h.length-1))return f=c+h.substring(0,h.length-1),a.setText(f,b.start,b.end),a.setCaretOffset(b.start+f.length),!0;if(0<g){for(g=l;g<f.length&&(32===(m=f.charCodeAt(g++))||9===m);)b.end++;a.setText(d.getLineDelimiter()+h,b.start,b.end);return!0}}}return!1},addBlockComment:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var c=a.getModel(),b=
a.getSelection(),d=this._findEnclosingComment(c,b.start,b.end);if(void 0!==d.commentStart&&void 0!==d.commentEnd)return!0;c=c.getText(b.start,b.end);if(0===c.length)return!0;var d=c.length,c=c.replace(/\/\*|\*\//g,""),e=c.length;a.setText("/*"+c+"*/",b.start,b.end);a.setSelection(b.start+2,b.end+2+(e-d));return!0},autoPairBrackets:function(a,c){if("["===a&&!this.autoPairSquareBrackets||"{"===a&&!this.autoPairBraces||"("===a&&!this.autoPairParentheses||"<"===a&&!this.autoPairAngleBrackets)return!1;
var b=this.editor;if(b.getTextView().getOptions("readonly"))return!1;var d=b.getSelection(),e=b.getModel(),f=b.getCaretOffset()===e.getCharCount()?"":e.getText(d.start,d.start+1).trim(),h=/^$|[)}\]>]/;return d.start===d.end&&h.test(f)?(b.setText(a+c,d.start,d.start),b.setCaretOffset(d.start+1),!0):d.start!==d.end?(e=e.getText(d.start,d.end),b.setText(a+e+c,d.start,d.end),b.setSelection(d.start+1,d.end+1),!0):!1},autoPairQuotations:function(a){if(!this.autoPairQuotation)return!1;var c=this.editor;
if(c.getTextView().getOptions("readonly"))return!1;var b=c.getSelection(),d=c.getModel(),e=c.getCaretOffset(),f=0===e?"":d.getText(b.start-1,b.start).trim(),h=e===d.getCharCount()?"":d.getText(b.start,b.start+1).trim(),e=/^"$|^'$/,g=/\w/,l=/^$|[)}\]>]/;if(b.start!==b.end){d=d.getText(b.start,b.end);if(e.test(d))return!1;c.setText(a+d+a,b.start,b.end);c.setSelection(b.start+1,b.end+1)}else{if(h!==a){if(f===a||e.test(h)||g.test(f)||!l.test(h))return!1;c.setText(a+a,b.start,b.start)}c.setCaretOffset(b.start+
1)}return!0},contentAssistProposalApplied:function(a){a=a.data.proposal;if(a.positions&&0<a.positions.length&&this.linkedMode){for(var c=[],b=0;b<a.positions.length;++b)c[b]={positions:[{offset:a.positions[b].offset,length:a.positions[b].length}]};this.linkedMode.enterLinkedMode({groups:c,escapePosition:a.escapePosition})}else a.groups&&0<a.groups.length&&this.linkedMode?this.linkedMode.enterLinkedMode({groups:a.groups,escapePosition:a.escapePosition}):a.escapePosition&&this.editor.getTextView().setCaretOffset(a.escapePosition);
return!0},deletePrevious:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var c=a.getSelection();if(c.start!==c.end)return!1;var b=a.getModel(),d=a.getCaretOffset(),e=0===d?"":b.getText(c.start-1,c.start),b=d===b.getCharCount()?"":b.getText(c.start,c.start+1);("("===e&&")"===b||"["===e&&"]"===b||"{"===e&&"}"===b||"<"===e&&">"===b||'"'===e&&'"'===b||"'"===e&&"'"===b)&&a.setText("",c.start,c.start+1);return!1},_findEnclosingComment:function(a,c,b){var d=a.getLineAtOffset(c),
e=a.getLineAtOffset(b),f,h,g,l,m,q;for(f=d;0<=f&&!(h=a.getLine(f),g=f===d?c-a.getLineStart(d):h.length,l=h.lastIndexOf("/*",g),h=h.lastIndexOf("*/",g),h>l);f--)if(-1!==l){m=a.getLineStart(f)+l;break}for(f=e;f<a.getLineCount()&&!(h=a.getLine(f),g=f===e?b-a.getLineStart(e):0,l=h.indexOf("/*",g),h=h.indexOf("*/",g),-1!==l&&l<h);f++)if(-1!==h){q=a.getLineStart(f)+h;break}return{commentStart:m,commentEnd:q}},lineStart:function(){for(var a=this.editor,c=a.getModel(),b=a.getCaretOffset(),d=c.getLineAtOffset(b),
e=c.getLineStart(d),c=c.getLine(d),d=0;d<c.length;d++){var f=c.charCodeAt(d);if(!(32===f||9===f))break}d+=e;return b!==d?(a.setSelection(d,d),!0):!1},removeBlockComment:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var c=a.getModel(),b=a.getSelection(),d=c.getText(b.start,b.end),e,f,h;for(h=0;h<d.length;h++)if("/*"===d.substring(h,h+2)){e=b.start+h;break}for(;h<d.length;h++)if("*/"===d.substring(h,h+2)){f=b.start+h;break}if(void 0!==e&&void 0!==f)a.setText(c.getText(e+
2,f),e,f+2),a.setSelection(e,f);else{d=this._findEnclosingComment(c,b.start,b.end);if(void 0===d.commentStart||void 0===d.commentEnd)return!0;c=c.getText(d.commentStart+2,d.commentEnd);a.setText(c,d.commentStart,d.commentEnd+2);a.setSelection(b.start-2,b.end-2)}return!0},toggleLineComment:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;for(var c=a.getModel(),b=a.getSelection(),d=c.getLineAtOffset(b.start),e=c.getLineAtOffset(b.end>b.start?b.end-1:b.end),f=!0,h=[],g,
l,m=d;m<=e;m++)if(g=c.getLine(m,!0),h.push(g),!f||-1===(l=g.indexOf("//")))f=!1;else if(0!==l){var q;for(q=0;q<l&&!(f=g.charCodeAt(q),!(32===f||9===f));q++);f=q===l}m=c.getLineStart(d);q=c.getLineEnd(e,!0);if(f){for(f=0;f<h.length;f++)g=h[f],l=g.indexOf("//"),h[f]=g.substring(0,l)+g.substring(l+2);h=h.join("");g=c.getLineStart(e);c=m===b.start?b.start:b.start-2;b=b.end-2*(e-d+1)+(b.end===g+1?2:0)}else h.splice(0,0,""),h=h.join("//"),c=m===b.start?b.start:b.start+2,b=b.end+2*(e-d+1);a.setText(h,m,
q);a.setSelection(c,b);return!0},trimTrailingWhitespaces:function(){var a=this.editor,c=a.getModel(),b=a.getSelection();a.getTextView().setRedraw(!1);a.getUndoStack().startCompoundChange();for(var d=/(\s+$)/,e=c.getLineCount(),f=0;f<e;f++){var h=c.getLine(f),g=d.exec(h);if(g){var l=c.getLineStart(f),h=g[0].length,g=l+g.index;c.setText("",g,g+h);b.start>g&&(b.start=Math.max(g,b.start-h));b.start!==b.end&&b.end>g&&(b.end=Math.max(g,b.end-h))}}a.getUndoStack().endCompoundChange();a.getTextView().setRedraw(!0);
a.setSelection(b.start,b.end,!1)},startUndo:function(){this.undoStack&&this.undoStack.startCompoundChange()},skipClosingBracket:function(a){var c=this.editor;if(c.getTextView().getOptions("readonly"))return!1;var b=c.getSelection(),d=c.getModel();return(c.getCaretOffset()===d.getCharCount()?"":d.getText(b.start,b.start+1))===a?(c.setCaretOffset(b.start+1),!0):!1},endUndo:function(){this.undoStack&&this.undoStack.endCompoundChange()},setAutoPairParentheses:function(a){this.autoPairParentheses=a},setAutoPairBraces:function(a){this.autoPairBraces=
a},setAutoPairSquareBrackets:function(a){this.autoPairSquareBrackets=a},setAutoPairAngleBrackets:function(a){this.autoPairAngleBrackets=a},setAutoPairQuotations:function(a){this.autoPairQuotation=a},setAutoCompleteComments:function(a){this.autoCompleteComments=a},setSmartIndentation:function(a){this.smartIndentation=a}};c.SourceCodeActions=d;String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/g,"")});String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/g,
"")});return c});
define("orion/editor/undoStack",[],function(){function f(b,f,g,e,d){this.model=b;this.offset=f;this.text=g;this.previousText=e;this.type=d}function m(b){this.owner=b;this.changes=[]}function q(b,f){this.size=void 0!==f?f:100;this.reset();var g=this;this._listener={onChanging:function(b){g._onChanging(b)},onDestroy:function(b){g._onDestroy(b)}};if(b.getModel){var e=b.getModel();e.getBaseModel&&(e=e.getBaseModel());this.model=e;this.setView(b)}else this.shared=!0,this.model=b;this.model.addEventListener("Changing",this._listener.onChanging)}
f.prototype={getRedoChanges:function(){return[{start:this.offset,end:this.offset+this.previousText.length,text:this.text}]},getUndoChanges:function(){return[{start:this.offset,end:this.offset+this.text.length,text:this.previousText}]},undo:function(b,f){this._doUndoRedo(this.offset,this.previousText,this.text,b,f);return!0},redo:function(b,f){this._doUndoRedo(this.offset,this.text,this.previousText,b,f);return!0},merge:function(b,f,g,e,d){if(e===this.type){if(1===e&&b===this.offset+this.text.length)return this.text+=
f,!0;if(-1===e&&d===this.offset)return this.offset=b,this.previousText=g+this.previousText,!0;if(-1===e&&b===this.offset)return this.previousText+=g,!0}return!1},_doUndoRedo:function(b,f,g,e,d){this.model.setText(f,b,b+g.length);d&&e&&(g=e.getModel(),g!==this.model&&(b=g.mapOffset(b,!0)),e.setSelection(b,b+f.length))}};m.prototype={getRedoChanges:function(){for(var b=[],f=0;f<this.changes.length;f++)b=b.concat(this.changes[f].getRedoChanges());return b},getUndoChanges:function(){for(var b=[],f=this.changes.length-
1;0<=f;f--)b=b.concat(this.changes[f].getUndoChanges());return b},add:function(b){this.changes.push(b)},end:function(b){b&&(this.endSelection=b.getSelection(),this.endCaret=b.getCaretOffset());(b=this.owner)&&b.end&&b.end()},undo:function(b,f){1<this.changes.length&&b&&b.setRedraw(!1);for(var g=this.changes.length-1;0<=g;g--)this.changes[g].undo(b,!1);1<this.changes.length&&b&&b.setRedraw(!0);if(f&&b){var g=this.startSelection.start,e=this.startSelection.end;b.setSelection(this.startCaret?g:e,this.startCaret?
e:g)}(g=this.owner)&&g.undo&&g.undo();return 0<this.changes.length},redo:function(b,f){1<this.changes.length&&b&&b.setRedraw(!1);for(var g=0;g<this.changes.length;g++)this.changes[g].redo(b,!1);(1<this.changes.length,b)&&b.setRedraw(!0);if(f&&b){var g=this.endSelection.start,e=this.endSelection.end;b.setSelection(this.endCaret?g:e,this.endCaret?e:g)}(g=this.owner)&&g.redo&&g.redo();return 0<this.changes.length},merge:function(b,f,g,e,d){var h=this.changes.length;return 0<h?this.changes[h-1].merge(b,
f,g,e,d):!1},start:function(b){b&&(this.startSelection=b.getSelection(),this.startCaret=b.getCaretOffset());(b=this.owner)&&b.start&&b.start()}};q.prototype={destroy:function(){this._onDestroy()},add:function(b){this.compoundChange?this.compoundChange.add(b):(this.stack.splice(this.index,this.stack.length-this.index,b),this.index++,this.stack.length>this.size&&(this.stack.shift(),this.index--))},markClean:function(){this._commitUndo();if(this.cleanChange=this.stack[this.index-1])this.cleanChange.type=
2},isClean:function(){return this.cleanChange===this.stack[this.index-1]},canUndo:function(){return 0<this.index},canRedo:function(){return 0<this.stack.length-this.index},endCompoundChange:function(){this.compoundChange&&this.compoundChange.end(this.view);this.compoundChange=void 0},getSize:function(){return{undo:this.index,redo:this.stack.length-this.index}},getRedoChanges:function(){this._commitUndo();for(var b=[],f=this.index;f<this.stack.length;f++)b=b.concat(this.stack[f].getRedoChanges());
return b},getUndoChanges:function(){this._commitUndo();for(var b=[],f=this.index;0<=f;f--)b=b.concat(this.stack[f].getUndoChanges());return b},undo:function(){this._commitUndo();var b;b=!1;this._ignoreUndo=!0;do{if(0>=this.index)break;b=this.stack[--this.index]}while(!(b=b.undo(this.view,!0)));this._ignoreUndo=!1;return b},redo:function(){this._commitUndo();var b;this._ignoreUndo=!0;do{if(this.index>=this.stack.length)break;b=this.stack[this.index++]}while(!b.redo(this.view,!0));this._ignoreUndo=
!1;return!0},reset:function(){this.index=0;this.cleanChange=void 0;this.stack=[];this._ignoreUndo=!1;this._compoundChange=void 0},setView:function(b){this.view!==b&&(this.view&&b.removeEventListener("Destroy",this._listener.onDestroy),(this.view=b)&&b.addEventListener("Destroy",this._listener.onDestroy))},startCompoundChange:function(b){this._commitUndo();b=new m(b);this.add(b);this.compoundChange=b;this.compoundChange.start(this.view);return this.compoundChange},_commitUndo:function(){this.endCompoundChange()},
_onDestroy:function(b){(!b||!this.shared)&&this.model.removeEventListener("Changing",this._listener.onChanging);this.view&&(this.view.removeEventListener("Destroy",this._listener.onDestroy),this.view=null)},_onChanging:function(b){if(!this._ignoreUndo){var l=b.text,g=b.start,e=b.addedCharCount,d=b.removedCharCount,b=g+d,h=0;0===e&&1===d?h=-1:1===e&&0===d&&(h=1);e=this.stack.length;d=this.model.getText(g,b);(!(0<e&&this.index===e)||!this.stack[e-1].merge(g,l,d,h,b))&&this.add(new f(this.model,g,l,
d,h))}}};return{UndoStack:q}});
define("orion/editor/rulers",["i18n!orion/editor/nls/messages","orion/editor/annotations","orion/editor/tooltip","orion/util"],function(f,m,q,b){function l(c,a,b,d){this._location=a||"left";this._overview=b||"page";this._rulerStyle=d;this._view=null;var e=this;this._listener={onTextModelChanged:function(a){e._onTextModelChanged(a)},onAnnotationModelChanged:function(a){e._onAnnotationModelChanged(a)}};this.setAnnotationModel(c)}function g(c,a,b,d,e){l.call(this,c,a,"page",b);this._oddStyle=d||{style:{backgroundColor:"white"}};
this._evenStyle=e||{style:{backgroundColor:"white"}};this._numOfDigits=0;this._firstLine=1}function e(c,a,b){l.call(this,c,a,"page",b)}function d(c,a,b){l.call(this,c,a,"document",b)}function h(c,a,b){e.call(this,c,a,b)}l.prototype={getAnnotations:function(c,a){var b=this._annotationModel;if(!b)return[];var d=this._view.getModel(),e=d.getLineStart(c),f=d.getLineEnd(a-1),h=d;d.getBaseModel&&(h=d.getBaseModel(),e=d.mapOffset(e),f=d.mapOffset(f));for(var g=[],b=this.getAnnotationsByType(b,e,f),e=0;e<
b.length;e++)for(var f=b[e],l=h.getLineAtOffset(f.start),m=h.getLineAtOffset(Math.max(f.start,f.end-1)),q=l;q<=m;q++){var z=q;if(d!==h){z=h.getLineStart(q);z=d.mapOffset(z,!0);if(-1===z)continue;z=d.getLineAtOffset(z)}if(c<=z&&z<a){var r=this._mergeAnnotation(g[z],f,q-l,m-l+1);r&&(g[z]=r)}}if(!this._multiAnnotation&&this._multiAnnotationOverlay)for(var t in g)g[t]._multiple&&(g[t].html+=this._multiAnnotationOverlay.html);return g},getAnnotationModel:function(){return this._annotationModel},getLocation:function(){return this._location},
getOverview:function(){return this._overview},getRulerStyle:function(){return this._rulerStyle},getView:function(){return this._view},getWidestAnnotation:function(){return null},setAnnotationModel:function(c){this._annotationModel&&this._annotationModel.removEventListener("Changed",this._listener.onAnnotationModelChanged);(this._annotationModel=c)&&this._annotationModel.addEventListener("Changed",this._listener.onAnnotationModelChanged)},setMultiAnnotation:function(c){this._multiAnnotation=c},setMultiAnnotationOverlay:function(c){this._multiAnnotationOverlay=
c},setView:function(c){this._onTextModelChanged&&this._view&&this._view.removeEventListener("ModelChanged",this._listener.onTextModelChanged);this._view=c;this._onTextModelChanged&&this._view&&this._view.addEventListener("ModelChanged",this._listener.onTextModelChanged)},onClick:function(c){if(void 0!==c){var a=this._view,b=a.getModel(),d=b,e=b.getLineStart(c),f=e,h=e,g=this._annotationModel;if(g){a=a.getSelection();h=b.getLineEnd(c,!0);e<=a.start&&a.start<h&&(e=a.start);b.getBaseModel&&(e=b.mapOffset(e),
h=b.mapOffset(h),d=b.getBaseModel());for(var l,h=g.getAnnotations(e,h),g=null;!l&&h.hasNext();)a=h.next(),this.isAnnotationTypeVisible(a.type)&&(g=a,a.start<=e||(l=a));g&&void 0!==g.groupId&&(this._currentClickGroup=this._currentClickGroup===g.groupId?null:g.groupId,this._setCurrentGroup(c));l&&d.getLineAtOffset(l.start)===d.getLineAtOffset(e)?(e=l.start,h=l.end):h=e=f;b.getBaseModel&&(e=b.mapOffset(e,!0),h=b.mapOffset(h,!0))}(c=q.Tooltip.getTooltip(this._view))&&c.setTarget(null);this._view.setSelection(h,
e,1/3,function(){})}},onDblClick:function(){},onMouseMove:function(c,a){var b=q.Tooltip.getTooltip(this._view);if(b&&!(b.isVisible()&&this._tooltipLineIndex===c)){this._tooltipLineIndex=c;var d=this;b.setTarget({y:a.clientY,getTooltipInfo:function(){return d._getTooltipInfo(d._tooltipLineIndex,this.y)}})}},onMouseOver:function(c,a){this.onMouseMove(c,a);this._currentClickGroup||this._setCurrentGroup(c)},onMouseOut:function(){this._currentClickGroup||this._setCurrentGroup(-1);var c=q.Tooltip.getTooltip(this._view);
c&&c.setTarget(null)},_getTooltipInfo:function(c,a){if(void 0!==c){var b=this._view,d=b.getModel(),e=this._annotationModel,f=[];if(e){var f=d.getLineStart(c),h=d.getLineEnd(c);d.getBaseModel&&(f=d.mapOffset(f),h=d.mapOffset(h));f=this.getAnnotationsByType(e,f,h)}e=this._getTooltipContents(c,f);if(!e)return null;e={contents:e,anchor:this.getLocation()};f=b.getClientArea();f.y="document"===this.getOverview()?b.convert({y:a},"view","document").y:b.getLocationAtOffset(d.getLineStart(c)).y;b.convert(f,
"document","page");e.x=f.x;e.y=f.y;"right"===e.anchor&&(e.x+=f.width);return e}},_getTooltipContents:function(c,a){return a},_onAnnotationModelChanged:function(c){function a(a){for(var c=0;c<a.length;c++)if(e.isAnnotationTypeVisible(a[c].type)){var f=a[c].start,h=a[c].end;d.getBaseModel&&(f=d.mapOffset(f,!0),h=d.mapOffset(h,!0));-1!==f&&-1!==h&&b.redrawLines(d.getLineAtOffset(f),d.getLineAtOffset(Math.max(f,h-1))+1,e)}}var b=this._view;if(b){var d=b.getModel(),e=this,f=d.getLineCount();c.textModelChangedEvent?
(c=c.textModelChangedEvent.start,d.getBaseModel&&(c=d.mapOffset(c,!0)),c=d.getLineAtOffset(c),b.redrawLines(c,f,e)):(a(c.added),a(c.removed),a(c.changed))}},_mergeAnnotation:function(c,a,b){c||(c={});0===b&&(c.html&&a.html?(a.html!==c.html&&(!c._multiple&&this._multiAnnotation)&&(c.html=this._multiAnnotation.html),c._multiple=!0):c.html=a.html);c.style=this._mergeStyle(c.style,a.style);return c},_mergeStyle:function(c,a){if(a){c||(c={});c.styleClass=c.styleClass&&a.styleClass&&c.styleClass!==a.styleClass?
c.styleClass+(" "+a.styleClass):a.styleClass;var b;if(a.style)for(b in c.style||(c.style={}),a.style)void 0===c.style[b]&&(c.style[b]=a.style[b]);if(a.attributes)for(b in c.attributes||(c.attributes={}),a.attributes)void 0===c.attributes[b]&&(c.attributes[b]=a.attributes[b])}return c},_setCurrentGroup:function(c){var a=this._annotationModel,b=null,d=a.getTextModel(),e,f=this._currentGroupAnnotation;if(-1!==c){var h=d.getLineStart(c),g=d.getLineEnd(c);d.getBaseModel&&(h=d.mapOffset(h),g=d.mapOffset(g));
for(e=a.getAnnotations(h,g);e.hasNext();)if(d=e.next(),this.isAnnotationTypeVisible(d.type)&&d.start<=h&&d.end>=g&&void 0!==d.groupId){b=d;break}if(f&&b&&f.groupId===b.groupId)return}this._currentGroupAnnotation=null;f&&a.removeAnnotations(f.groupType);if(b&&-1!==c){this._currentGroupAnnotation=b;e=a.getAnnotations();for(c=[];e.hasNext();)d=e.next(),delete d.groupAnnotation,d.groupId===b.groupId&&(d=d.createGroupAnnotation(),c.push(d));a.replaceAnnotations(null,c)}}};m.AnnotationTypeList.addMixin(l.prototype);
g.prototype=new l;g.prototype.getAnnotations=function(c,a){for(var b=l.prototype.getAnnotations.call(this,c,a),d=this._view.getModel(),e=c;e<a;e++){var f=e&1?this._oddStyle:this._evenStyle,h=e;d.getBaseModel&&(h=d.getLineStart(h),h=d.getBaseModel().getLineAtOffset(d.mapOffset(h)));b[e]||(b[e]={});b[e].html=this._firstLine+h+"";b[e].style||(b[e].style=f)}return b};g.prototype.getWidestAnnotation=function(){var c=this._view.getModel().getLineCount();return this.getAnnotations(c-1,c)[c-1]};g.prototype.setFirstLine=
function(c){this._firstLine=void 0!==c?c:1};g.prototype._onTextModelChanged=function(c){var a=c.start,c=this._view.getModel(),b=c.getBaseModel?c.getBaseModel().getLineCount():c.getLineCount(),b=(this._firstLine+b-1+"").length;this._numOfDigits!==b&&(this._numOfDigits=b,a=c.getLineAtOffset(a),this._view.redrawLines(a,c.getLineCount(),this))};e.prototype=new l;d.prototype=new l;d.prototype.getRulerStyle=function(){var c={style:{lineHeight:"1px",fontSize:"1px"}};return c=this._mergeStyle(c,this._rulerStyle)};
d.prototype._getTooltipContents=function(c,a){if(0===a.length){var d=this._view.getModel(),e=c;d.getBaseModel&&(e=d.getLineStart(e),e=d.getBaseModel().getLineAtOffset(d.mapOffset(e)));return b.formatMessage(f.line,e+1)}return l.prototype._getTooltipContents.call(this,c,a)};d.prototype._mergeAnnotation=function(c,a,b,d){if(0===b)return c||(c={html:"&nbsp;",style:{style:{height:3*d+"px"}}},c.style=this._mergeStyle(c.style,a.overviewStyle)),c};h.prototype=new e;h.prototype.onClick=function(c){if(void 0!==
c){var a=this._annotationModel;if(a){var b=this._view.getModel(),d=b.getLineStart(c),c=b.getLineEnd(c,!0);b.getBaseModel&&(d=b.mapOffset(d),c=b.mapOffset(c),b=b.getBaseModel());for(var e,a=a.getAnnotations(d,c);!e&&a.hasNext();)c=a.next(),this.isAnnotationTypeVisible(c.type)&&(e=c);e&&b.getLineAtOffset(e.start)===b.getLineAtOffset(d)&&((b=q.Tooltip.getTooltip(this._view))&&b.setTarget(null),e.expanded?e.collapse():e.expand())}}};h.prototype._getTooltipContents=function(c,a){return 1===a.length&&a[0].expanded?
null:e.prototype._getTooltipContents.call(this,c,a)};h.prototype._onAnnotationModelChanged=function(c){function a(a){for(h=0;h<a.length;h++)if(f.isAnnotationTypeVisible(a[h].type)){var c=a[h].start;d.getBaseModel&&(c=d.mapOffset(c,!0));-1!==c&&(l=Math.min(l,d.getLineAtOffset(c)))}}if(c.textModelChangedEvent)e.prototype._onAnnotationModelChanged.call(this,c);else{var b=this._view;if(b){var d=b.getModel(),f=this,h,g=d.getLineCount(),l=g;a(c.added);a(c.removed);a(c.changed);c=b.getRulers();for(h=0;h<
c.length;h++)b.redrawLines(l,g,c[h])}}};return{Ruler:l,AnnotationRuler:e,LineNumberRuler:g,OverviewRuler:d,FoldingRuler:h}});
define("orion/editor/textDND",["orion/util"],function(f){function m(f,b){this._view=f;this._undoStack=b;this._dragSelection=null;this._dropOffset=-1;this._dropText=null;var l=this;this._listener={onDragStart:function(b){l._onDragStart(b)},onDragEnd:function(b){l._onDragEnd(b)},onDragEnter:function(b){l._onDragEnter(b)},onDragOver:function(b){l._onDragOver(b)},onDrop:function(b){l._onDrop(b)},onDestroy:function(b){l._onDestroy(b)}};f.addEventListener("DragStart",this._listener.onDragStart);f.addEventListener("DragEnd",
this._listener.onDragEnd);f.addEventListener("DragEnter",this._listener.onDragEnter);f.addEventListener("DragOver",this._listener.onDragOver);f.addEventListener("Drop",this._listener.onDrop);f.addEventListener("Destroy",this._listener.onDestroy)}m.prototype={destroy:function(){var f=this._view;f&&(f.removeEventListener("DragStart",this._listener.onDragStart),f.removeEventListener("DragEnd",this._listener.onDragEnd),f.removeEventListener("DragEnter",this._listener.onDragEnter),f.removeEventListener("DragOver",
this._listener.onDragOver),f.removeEventListener("Drop",this._listener.onDrop),f.removeEventListener("Destroy",this._listener.onDestroy),this._view=null)},_onDestroy:function(){this.destroy()},_onDragStart:function(f){var b=this._view,l=b.getSelection(),b=b.getModel();b.getBaseModel&&(l.start=b.mapOffset(l.start),l.end=b.mapOffset(l.end),b=b.getBaseModel());if(b=b.getText(l.start,l.end))this._dragSelection=l,f.event.dataTransfer.effectAllowed="copyMove",f.event.dataTransfer.setData("Text",b)},_onDragEnd:function(m){if(this._dragSelection){var b=
this._view,l=m.event.dataTransfer.dropEffect;if(!f.isFirefox&&("none"!==l||this._dropText))l=m.event.dataTransfer.dropEffect=this._dropEffect;this._undoStack&&this._undoStack.startCompoundChange();(m="move"===l)&&b.setText("",this._dragSelection.start,this._dragSelection.end);if(this._dropText){var l=this._dropText,g=this._dropOffset;m&&(g>=this._dragSelection.end?g-=this._dragSelection.end-this._dragSelection.start:g>=this._dragSelection.start&&(g=this._dragSelection.start));b.setText(l,g,g);b.setSelection(g,
g+l.length);this._dropText=null;this._dropOffset=-1}this._undoStack&&this._undoStack.endCompoundChange()}this._dragSelection=null},_onDragEnter:function(f){this._onDragOver(f)},_onDragOver:function(m){var b=m.event.dataTransfer.types,l=!this._view.getOptions("readonly");l&&b&&(l=b.contains?b.contains("text/plain")||b.contains("Text"):-1!==b.indexOf("text/plain")||-1!==b.indexOf("Text"));l?f.isFirefox||(this._dropEffect=m.event.dataTransfer.dropEffect=(f.isMac?m.event.altKey:m.event.ctrlKey)?"copy":
"move"):m.event.dataTransfer.dropEffect="none"},_onDrop:function(m){var b=this._view,l=m.event.dataTransfer.getData("Text");l&&(f.isFirefox||(m.event.dataTransfer.dropEffect=this._dropEffect),m=b.getOffsetAtLocation(m.x,m.y),this._dragSelection?(this._dropOffset=m,this._dropText=l):(b.setText(l,m,m),b.setSelection(m,m+l.length)))}};return{TextDND:m}});
define("orion/editor/templates",[],function(){function f(f,b,l,g){this.prefix=f;this.description=b;this.template=l;this.name=g;this._parse()}function m(f,b){this._keywords=f||[];this._templates=[];this.addTemplates(b||[])}f.prototype={getProposal:function(f,b,l){var f=b-f.length,b={},g,e=void 0!==l.delimiter?l.delimiter:"\n";l.indentation&&(e+=l.indentation);for(var d=void 0!==l.tab?l.tab:"\t",h=0,c=this.variables,a=this.segments,l=[],k=0;k<a.length;k++){var n=a[k],m=c[n];if(void 0!==m)switch(n){case "${tab}":n=
d;break;case "${delimiter}":n=e;break;case "${cursor}":n="";g=h;break;default:var u=b[n];u||(u=b[n]={data:m.data,positions:[]});n=m.substitution;u.data&&u.data.values&&(n=u.data.values[0]);u.positions.push({offset:f+h,length:n.length})}l.push(n);h+=n.length}var e=[],s;for(s in b)b.hasOwnProperty(s)&&e.push(b[s]);l=l.join("");void 0===g&&(g=l.length);return{proposal:l,name:this.name,description:this.description,groups:e,escapePosition:f+g,style:"noemphasis"}},match:function(f){return 0===this.prefix.indexOf(f)},
_parse:function(){var f=this.template,b=[],l={},g,e=0,f=f.replace(/\n/g,"${delimiter}"),f=f.replace(/\t/g,"${tab}");f.replace(/\$\{((?:[^\\}]+|\\.))*\}/g,function(d,h,c){var a=d.substring(2,d.length-1),h=d,k=a,n=null,m=k.indexOf(":");-1!==m&&(k=k.substring(0,m),h="${"+k+"}",n=JSON.parse(a.substring(m+1).replace("\\}","}").trim()));(a=l[h])||(a=l[h]={});a.substitution=k;n&&(a.data=n);(g=f.substring(e,c))&&b.push(g);b.push(h);e=c+d.length;return k});(g=f.substring(e,f.length))&&b.push(g);this.segments=
b;this.variables=l}};m.prototype={addTemplates:function(m){for(var b=this.getTemplates(),l=0;l<m.length;l++)b.push(new f(m[l].prefix,m[l].description,m[l].template,m[l].name))},computeProposals:function(f,b,l){var g=this.getPrefix(f,b,l),e=[];this.isValid(g,f,b,l)&&(e=e.concat(this.getTemplateProposals(g,b,l)),e=e.concat(this.getKeywordProposals(g)));return e},getKeywords:function(){return this._keywords},getKeywordProposals:function(f){var b=[],l=this.getKeywords();if(l){for(var g=0;g<l.length;g++)0===
l[g].indexOf(f)&&b.push({proposal:l[g].substring(f.length),description:l[g],style:"noemphasis_keyword"});0<b.length&&b.splice(0,0,{proposal:"",description:"Keywords",style:"noemphasis_title_keywords",unselectable:!0})}return b},getPrefix:function(f,b,l){return l.prefix},getTemplates:function(){return this._templates},getTemplateProposals:function(f,b,l){for(var g=[],e=this.getTemplates(),d=0;d<e.length;d++){var h=e[d];h.match(f)&&(h=h.getProposal(f,b,l),this.removePrefix(f,h),g.push(h))}0<g.length&&
(g.sort(function(c,a){return c.name<a.name?-1:c.name>a.name?1:0}),g.splice(0,0,{proposal:"",description:"Templates",style:"noemphasis_title",unselectable:!0}));return g},removePrefix:function(f,b){if(!(b.overwrite=b.proposal.substring(0,f.length)!==f))b.proposal=b.proposal.substring(f.length)},isValid:function(){return!0}};return{Template:f,TemplateContentAssist:m}});
define("orion/editor/linkedMode","i18n!orion/editor/nls/messages orion/keyBinding orion/editor/keyModes orion/editor/annotations orion/editor/templates orion/objects orion/util".split(" "),function(f,m,q,b,l,g){function e(b,c,a){var d=b.getTextView();q.KeyMode.call(this,d);this.editor=b;this.undoStack=c;this.contentAssist=a;this.linkedModeModel=null;d.setAction("linkedModeEnter",function(){this.exitLinkedMode(!0);return!0}.bind(this));d.setAction("linkedModeCancel",function(){this.exitLinkedMode(!1);
return!0}.bind(this));d.setAction("linkedModeNextGroup",function(){var a=this.linkedModeModel;this.selectLinkedGroup((a.selectedGroupIndex+1)%a.groups.length);return!0}.bind(this));d.setAction("linkedModePreviousGroup",function(){var a=this.linkedModeModel;this.selectLinkedGroup(0<a.selectedGroupIndex?a.selectedGroupIndex-1:a.groups.length-1);return!0}.bind(this));this.linkedModeListener={onActivating:function(){this._groupContentAssistProvider&&(this.contentAssist.setProviders([this._groupContentAssistProvider]),
this.contentAssist.setProgress(null))}.bind(this),onModelChanged:function(a){if(!this.ignoreVerify){for(var c=this.editor.mapOffset(a.start),b=this.linkedModeModel,d,e;b;)if(d=this._getPositionChanged(b,c,c+a.removedCharCount),e=d.position,void 0===e||e.model!==b)this.exitLinkedMode(!1),b=this.linkedModeModel;else break;if(b){b=0;a=a.addedCharCount-a.removedCharCount;d=d.positions;for(var f,h=0;h<d.length;++h){f=d[h];e=f.position;var k=e.offset<=c&&c<=e.offset+e.length;k&&!f.ansestor?(e.offset+=b,
e.length+=a,b+=a):(e.offset+=b,f.ansestor&&k&&(e.length+=a));f.escape&&(f.model.escapePosition=e.offset)}this._updateAnnotations(d)}}}.bind(this),onVerify:function(a){if(!this.ignoreVerify){for(var c=this.editor,b=c.mapOffset(a.start),d=this.editor.mapOffset(a.end),e=this.linkedModeModel,f,h;e;)if(f=this._getPositionChanged(e,b,d),h=f.position,void 0===h||h.model!==e)this.exitLinkedMode(!1),e=this.linkedModeModel;else break;if(e){var k=this._compoundChange;k?k.owner.model===e&&k.owner.group===h.group||
(this.endUndo(),this.startUndo()):this.startUndo();e.selectedGroupIndex=h.group;var k=0,g=a.text.length-(d-b);f=f.positions;for(var l,b=b-h.position.offset,m=d-h.position.offset,q=0;q<f.length;++q)l=f[q],d=l.position,l.oldOffset=d.offset,l.model===e&&l.group===h.group?(d.offset+=k,d.length+=g,k+=g):(d.offset+=k,l.ansestor&&(d.length+=h.count*g)),l.escape&&(l.model.escapePosition=d.offset);this.ignoreVerify=!0;for(q=f.length-1;0<=q;q--)l=f[q],l.model===e&&l.group===h.group&&c.setText(a.text,l.oldOffset+
b,l.oldOffset+m);this.ignoreVerify=!1;a.text=null;this._updateAnnotations(f)}}}.bind(this)}}var d={};e.prototype=new q.KeyMode;g.mixin(e.prototype,{createKeyBindings:function(){var b=m.KeyBinding,c=[];c.push({actionID:"linkedModeEnter",keyBinding:new b(13)});c.push({actionID:"linkedModeCancel",keyBinding:new b(27)});c.push({actionID:"linkedModeNextGroup",keyBinding:new b(9)});c.push({actionID:"linkedModePreviousGroup",keyBinding:new b(9,!1,!0)});return c},enterLinkedMode:function(b){if(!this.linkedModeModel){var c=
this.editor.getTextView();c.addKeyMode(this);c.addEventListener("Verify",this.linkedModeListener.onVerify);c.addEventListener("ModelChanged",this.linkedModeListener.onModelChanged);this.contentAssist.addEventListener("Activating",this.linkedModeListener.onActivating);this.editor.reportStatus(f.linkedModeEntered,null,!0)}this._sortedPositions=null;this.linkedModeModel&&(b.previousModel=this.linkedModeModel,b.parentGroup=this.linkedModeModel.selectedGroupIndex,this.linkedModeModel.nextModel=b);this.linkedModeModel=
b;this.selectLinkedGroup(0)},exitLinkedMode:function(b){if(this.isActive()){this._compoundChange&&(this.endUndo(),this._compoundChange=null);this._sortedPositions=null;var c=this.linkedModeModel;this.linkedModeModel=c.previousModel;c.parentGroup=c.previousModel=void 0;this.linkedModeModel&&(this.linkedModeModel.nextModel=void 0);if(!this.linkedModeModel){var a=this.editor,d=a.getTextView();d.removeKeyMode(this);d.removeEventListener("Verify",this.linkedModeListener.onVerify);d.removeEventListener("ModelChanged",
this.linkedModeListener.onModelChanged);d=this.contentAssist;d.removeEventListener("Activating",this.linkedModeListener.onActivating);d.offset=void 0;this.editor.reportStatus(f.linkedModeExited,null,!0);b&&a.setCaretOffset(c.escapePosition,!1)}this.selectLinkedGroup(0)}},startUndo:function(){if(this.undoStack){var b=this,c=this.linkedModeModel;this._compoundChange=this.undoStack.startCompoundChange({model:c,group:c.selectedGroupIndex,end:function(){b._compoundChange=null}})}},endUndo:function(){this.undoStack&&
this.undoStack.endCompoundChange()},isActive:function(){return!!this.linkedModeModel},isStatusActive:function(){return!!this.linkedModeModel},selectLinkedGroup:function(b){var c=this.linkedModeModel;if(c){c.selectedGroupIndex=b;var b=c.groups[b],a=b.positions[0],d=this.editor;d.setSelection(a.offset,a.offset+a.length);if(c=this.contentAssist)c.offset=void 0,b.data&&"link"===b.data.type&&b.data.values?((this._groupContentAssistProvider=new l.TemplateContentAssist(b.data.values)).getPrefix=function(){var b=
d.getSelection();return b.start===b.end&&(b=d.getCaretOffset(),a.offset<=b&&b<=a.offset+a.length)?d.getText(a.offset,b):""},c.offset=a.offset,c.deactivate(),c.activate()):this._groupContentAssistProvider&&(this._groupContentAssistProvider=null,c.deactivate())}this._updateAnnotations()},_getModelPositions:function(b,c,a){for(var d=c.groups,e=0;e<d.length;e++)for(var f=d[e].positions,g=0;g<f.length;g++){var l=f[g];a&&(l={offset:l.offset+a,length:l.length});l={index:g,group:e,count:f.length,model:c,
position:l};b.push(l);c.nextModel&&c.nextModel.parentGroup===e&&(l.ansestor=!0,this._getModelPositions(b,c.nextModel,(a||0)+f[g].offset-f[0].offset))}},_getSortedPositions:function(b){var c=this._sortedPositions;if(!c){for(c=[];b.previousModel;)b=b.previousModel;for(this._getModelPositions(c,b);b;)void 0!==b.escapePosition&&c.push({escape:!0,model:b,position:{offset:b.escapePosition,length:0}}),b=b.nextModel;c.sort(function(a,b){return a.position.offset-b.position.offset});this._sortedPositions=c}return c},
_getPositionChanged:function(b,c,a){for(var d,b=this._getSortedPositions(b),e=b.length-1;0<=e;e--){var f=b[e].position;if(f.offset<=c&&a<=f.offset+f.length){d=b[e];break}}return{position:d,positions:b}},_updateAnnotations:function(d){var c=this.editor.getAnnotationModel();if(c){var a=[],e=[];c.getTextModel();for(var f=c.getAnnotations(),g;f.hasNext();)switch(g=f.next(),g.type){case b.AnnotationType.ANNOTATION_LINKED_GROUP:case b.AnnotationType.ANNOTATION_CURRENT_LINKED_GROUP:case b.AnnotationType.ANNOTATION_SELECTED_LINKED_GROUP:a.push(g)}if(f=
this.linkedModeModel)for(var d=d||this._getSortedPositions(f),l=0;l<d.length;l++)if(g=d[l],g.model===f){var m=b.AnnotationType.ANNOTATION_LINKED_GROUP;g.group===f.selectedGroupIndex&&(m=0===g.index?b.AnnotationType.ANNOTATION_SELECTED_LINKED_GROUP:b.AnnotationType.ANNOTATION_CURRENT_LINKED_GROUP);g=g.position;g=b.AnnotationType.createAnnotation(m,g.offset,g.offset+g.length,"");e.push(g)}c.replaceAnnotations(a,e)}}});d.LinkedMode=e;return d});
define("orion/editor/factories","orion/editor/actions orion/editor/undoStack orion/editor/rulers orion/editor/annotations orion/editor/textDND orion/editor/linkedMode".split(" "),function(f,m,q,b,l,g){function e(){}function d(){}function h(){}function c(){}function a(){}function k(){}var n={};e.prototype={createKeyBindings:function(a,b,c,d){var d=new f.TextActions(a,b,d),e=new g.LinkedMode(a,b,c),a=new f.SourceCodeActions(a,b,c,e);return{textActions:d,linkedMode:e,sourceCodeActions:a}}};n.KeyBindingsFactory=
e;d.prototype={createUndoStack:function(a){a=a.getTextView();return new m.UndoStack(a,200)}};n.UndoFactory=d;h.prototype={createLineNumberRuler:function(a){return new q.LineNumberRuler(a,"left",{styleClass:"ruler lines"},{styleClass:"rulerLines odd"},{styleClass:"rulerLines even"})}};n.LineNumberRulerFactory=h;c.prototype={createFoldingRuler:function(a){return new q.FoldingRuler(a,"left",{styleClass:"ruler folding"})}};n.FoldingRulerFactory=c;a.prototype={createAnnotationModel:function(a){return new b.AnnotationModel(a)},
createAnnotationStyler:function(a,c){return new b.AnnotationStyler(a,c)},createAnnotationRulers:function(a){var b=new q.AnnotationRuler(a,"left",{styleClass:"ruler annotations"}),a=new q.OverviewRuler(a,"right",{styleClass:"ruler overview"});return{annotationRuler:b,overviewRuler:a}}};n.AnnotationFactory=a;k.prototype={createTextDND:function(a,b){return new l.TextDND(a.getTextView(),b)}};n.TextDNDFactory=k;return n});
define("orion/editor/editorFeatures",["orion/editor/factories","orion/editor/actions","orion/editor/linkedMode","orion/objects"],function(f,m,q,b){return b.mixin({},f,m,q)});
define("orion/editorPreferences",[],function(){function f(b,f){this._preferences=b;if(this._callback=f)var g=b.listenForChangedSettings(m,function(b){b.key===g&&f()}.bind(this))}var m="/editor/settings",q={autoSave:!1,autoSaveVisible:!0,autoSaveLocalVisible:!0,autoSaveTimeout:1E3,autoSaveTimeoutVisible:!0,themeVisible:!0,themeLocalVisible:!0,fontSizeVisible:!0,fontSizeLocalVisible:!0,autoLoad:!0,autoLoadVisible:!0,saveDiffs:!0,saveDiffsVisible:!0,contentAssistAutoTrigger:!0,contentAssistAutoTriggerVisible:!0,
showOccurrences:!1,showOccurrencesVisible:!0,autoPairParentheses:!0,autoPairParenthesesVisible:!0,autoPairBraces:!0,autoPairBracesVisible:!0,autoPairSquareBrackets:!0,autoPairSquareBracketsVisible:!0,autoPairAngleBrackets:!1,autoPairAngleBracketsVisible:!0,autoPairQuotations:!0,autoPairQuotationsVisible:!0,autoCompleteComments:!0,autoCompleteCommentsVisible:!0,smartIndentation:!0,smartIndentationVisible:!0,trimTrailingWhiteSpace:!1,trimTrailingWhiteSpaceVisible:!0,tabSize:4,tabSizeVisible:!0,expandTab:!1,
expandTabVisible:!0,scrollAnimation:!0,scrollAnimationVisible:!0,scrollAnimationTimeout:300,scrollAnimationTimeoutVisible:!0,annotationRuler:!0,annotationRulerVisible:!0,lineNumberRuler:!0,lineNumberRulerVisible:!0,foldingRuler:!0,foldingRulerVisible:!0,overviewRuler:!0,overviewRulerVisible:!0,showTabs:!1,showTabsVisible:!0,showSpaces:!1,showSpacesVisible:!0,wordWrap:!1,wordWrapVisible:!0,showMargin:!1,showMarginVisible:!0,marginOffset:80,marginOffsetVisible:!0,keyBindings:"Default",keyBindingsVisible:!0,
keyBindingsLocalVisible:!0};f.prototype={_initialize:function(b){var b=b.get("editorSettings")||{},f;for(f in q)b.hasOwnProperty(f)||(b[f]=q[f]);return b},getPrefs:function(b){this._preferences.getPreferences(m).then(function(f){f=this._initialize(f);"string"===typeof f&&(f=JSON.parse(f));b(f)}.bind(this))},setPrefs:function(b,f){this._preferences.getPreferences(m).then(function(g){g.put("editorSettings",b);b=this._initialize(g);f&&f(b);this._callback&&this._callback(b)}.bind(this))}};return{EditorPreferences:f}});
define("orion/widgets/themes/ThemePreferences",[],function(){function f(f,q){this._preferences=f;this._themeData=q;var b=q.getThemeStorageInfo(),l=f.listenForChangedSettings(b.storage,2,function(b){b.key===l&&this.apply()}.bind(this))}f.prototype={_initialize:function(f,q,b){var l=b.get(f.styleset);l||(l=q.getStyles(),b.put(f.styleset,JSON.stringify(l)));(q=b.get("selected"))&&(q=JSON.parse(q));if(!q||void 0===q[f.selectedKey])q=q||{},q[f.selectedKey]=f.defaultTheme,b.put("selected",JSON.stringify(q))},
apply:function(){this.setTheme()},getTheme:function(f){var q=this._themeData,b=q.getThemeStorageInfo();this._preferences.getPreferences(b.storage,2).then(function(l){this._initialize(b,q,l);var g=JSON.parse(l.get("selected")),l=JSON.parse(l.get(b.styleset)),e;if(l)for(var d=0;d<l.length;d++)if(l[d].name===g[b.selectedKey]){e=l[d];break}f({style:e,styles:l})}.bind(this))},setTheme:function(f,q){var b=this._themeData,l=b.getThemeStorageInfo();this._preferences.getPreferences(l.storage,2).then(function(g){this._initialize(l,
b,g);var e=JSON.parse(g.get("selected"));f||(f=e[l.selectedKey]);e[l.selectedKey]=f;g.put("selected",JSON.stringify(e));q?g.put(l.styleset,JSON.stringify(q)):q=JSON.parse(g.get(l.styleset));for(g=0;g<q.length;g++)if(q[g].name===e[l.selectedKey]){b.processSettings(q[g]);break}}.bind(this))},setFontSize:function(f){var q=this._themeData,b=q.getThemeStorageInfo();this._preferences.getPreferences(b.storage,2).then(function(l){this._initialize(b,q,l);var g=JSON.parse(l.get("selected")),e=JSON.parse(l.get(b.styleset)),
d;if(e)for(var h=0;h<e.length;h++)e[h].fontSize=f,e[h].name===g[b.selectedKey]&&(d=e[h]);l.put(b.styleset,JSON.stringify(e));q.processSettings(d)}.bind(this))}};return{ThemePreferences:f}});
define("orion/settings/nls/root/messages",{"Plugin Description":"Plugin Description",Create:"Create","Loading...":"Loading...","Label:":"Label:",Title:"Title",Plugins:"Plugins","User Profile":"User Profile",Git:"Git","Git Settings":"Git Settings",General:"General",Navigation:"Navigation",Links:"Links","Open in same tab":"Open in same tab","Open in new tab":"Open in new tab",Font:"Font",Family:"Family","Sans Serif":"Sans Serif",Serif:"Serif",Size:"Size","8pt":"8pt","9pt":"9pt","10pt":"10pt","12pt":"12pt",
Color:"Color",Background:"Background",Strings:"Strings","String Types":"String Types",blue:"blue",Weight:"Weight",Normal:"Normal",Bold:"Bold",Comments:"Comments","Comment Types":"Comment Types",green:"green",Keywords:"Keywords","Keyword Types":"Keyword Types",darkred:"darkred",Categories:"Categories",Username:"Username","Full Name":"Full Name","Email Address":"Email Address","Email Confirmed":"Email Confirmed",Account:"Account","Current Password":"Current Password","New Password":"New Password","Verify Password":"Verify Password",
Password:"Password",OpenId:"OpenId",AOL:"AOL",Yahoo:"Yahoo",Google:"Google",Unlink:"Unlink",Link:"Link",Unlinked:"Unlinked",Linked:"Linked","Linked Accounts":"Linked Accounts","Git Email Address":"Git Email Address","Git Username":"Git Username","Git Credentials Storage":"Git Credentials Storage",Update:"Update","Update Profile Settings":"Update Profile Settings","Update Git User Settings":"Update Git User Settings","Update Git Credentials":"Update Git Credentials","User profile data successfully updated.":"User profile data successfully updated.",
"Git user data successfully updated.":"Git user data successfully updated.","Git Credentials successfully updated.":"Git Credentials successfully updated.","Edit Plugin JavaScript":"Edit Plugin JavaScript","Install Plugin":"Install Plugin","Plugin Name:":"Plugin Name:","Author Name:":"Author Name:","Licence:":"Licence:","Description:":"Description:","A plugin for Eclipse Orion":"A plugin for Eclipse Orion","Plugin Link":"Plugin Link",Install:"Install","Install a plugin by specifying its URL":"Install a plugin by specifying its URL",
"Plugin URL:":"Plugin URL:",Disable:"Disable",DisableTooltip:"Disable the plugin",Enable:"Enable",EnableTooltip:"Enable the plugin","Reload all":"Reload all","Reload all installed plugins":"Reload all installed plugins","Create a new Orion Plugin":"Create a new Orion Plugin","Find More Orion Plugins":"Find More Orion Plugins","Get Plugins":"Get Plugins",Reload:"Reload","Reload the plugin":"Reload the plugin",Delete:"Delete","Delete this plugin from the configuration":"Delete this plugin from the configuration",
"Type a plugin url here ...":"Type a plugin url here ...","Installed ":"Installed ","Installing ":"Installing ","Already installed":"Already installed"," plugin":" plugin","Reloaded ":"Reloaded ","Uninstalled ":"Uninstalled ","Are you sure you want to uninstall '":"Are you sure you want to uninstall '",Services:"Services",Value:"Value","JavaScript Object":"JavaScript Object","click here, then check javascript console to drill down":"click here, then check javascript console to drill down",Item:"Item",
"Git Config":"Git Config","Clear Git Credentials":"Clear Git Credentials","Enable Storage":"Enable Storage","Please be aware that your credentials will be stored persistently in the browser.":"Please be aware that your credentials will be stored persistently in the browser.","Do you wish to enable the Key Storage?":"Do you wish to enable the Key Storage?",general:"General",validation:"Validation","Deleted git credentials for ${0}":"Deleted git credentials for ${0}",Editor:"Editor",editorSettings:"Settings",
EditorThemes:"Themes",Import:"Import","Import a theme":"Import a theme",Export:"Export","Export a theme":"Export a theme","Theme name:":"Theme name:",yourTheme:"yourTheme",fileManagement:"File Management",typing:"Typing",autoSave:"Auto Save",autoSaveTimeout:"Save interval (ms)",autoLoad:"Auto Load",saveDiffs:"Save file as diffs",trimTrailingWhiteSpace:"Trim Trailing Whitespace on Save",Restore:"Restore Defaults",Default:"Default",keys:"Keys",tabs:"Tabs",tabSize:"Tab Size",expandTab:"Insert spaces for tabs",
smoothScrolling:"Smooth Scrolling",scrollAnimation:"Scrolling Animation",scrollAnimationTimeout:"Scrolling Duration (ms)",keyBindings:"Key Bindings",rulers:"Rulers",annotationRuler:"Show Annotation Ruler",lineNumberRuler:"Show Line Number Ruler",foldingRuler:"Show Folding Ruler",overviewRuler:"Show Overview Ruler",whitespaces:"White Spaces",wrapping:"Wrapping",wordWrap:"Word Wrap",showMargin:"Show Margin",marginOffset:"Margin Column",showTabs:"Show Tabs",showSpaces:"Show Spaces",autoSaveTimeoutInvalid:"Invalid save interval.",
scrollAnimationTimeoutInvalid:"Invalid scrolling duration.",tabSizeInvalid:"Invalid tab size.",localSettingsTooltip:"Toggle whether this setting is shown in the local editor settings drop down.",editorSettingsInfo:"Use the ${0} and ${1} to toggle whether a given setting is shown in the local editor settings drop down ${2}.",autoPairParentheses:"Autopair (Parentheses)",autoPairBraces:"Autopair {Braces}",autoPairSquareBrackets:"Autopair [Square] Brackets",autoPairAngleBrackets:"Autopair <Angle> Brackets",
autoPairQuotations:'Autopair "Strings"',autoCompleteComments:"Autocomplete /** Block Comments */",smartIndentation:"Smart Indentation",sourceControl:"Source Control",showBlame:"Show Blame",languageTools:"Language Tools",showOccurrences:"Show Occurrences",contentAssistAutoTrigger:"Show Content Assist automatically","Editor preferences updated":"Editor preferences updated","Editor defaults restored":"Editor defaults restored",Theme:"Theme","Font Size":"Font Size","New Theme Name:":"New Theme Name:",
"Font Size:":"Font Size:","UI Theme":"UI Theme","Navigation Bar":"Navigation Bar","Navigation Text":"Navigation Text","Search Box":"Search Box","Tool Panel":"Tool Panel","Selection Bar":"Selection Bar",Location:"Location",Content:"Content","Main Panel":"Main Panel",Button:"Button","Button Text":"Button Text","Section Text":"Section Text","Side Panel":"Side Panel","Line Color":"Line Color","Line Numbers":"Line Numbers",Foreground:"Foreground","Current Line":"Current Line","HTML Attribute":"HTML Attribute",
"Overview Ruler":"Overview Ruler","HTML Tag":"HTML Tag","Annotation Ruler":"Annotation Ruler","Show Guide":"Show Guide","Check Guide":"Check Guide",Cancel:"Cancel","Revert Theme":"Revert Theme","Update Theme":"Update Theme","Theme:":"Theme:",clickDiagram:"Click diagram to style.",clickUpdate:"Click Update button to save preview.","CSS Class Name":"CSS Class Name","CSS Attribute":"CSS Attribute","CSS Value":"CSS Value","CSS Text":"CSS Text","COLOR:":"Color:","NEW COLOR:":"New Color:",Ok:"Ok","OR HEX:":"Or Hex: "});
define("orion/settings/nls/messages",["orion/i18n!orion/settings/nls/messages","orion/settings/nls/root/messages"],function(f,m){var q={root:m};Object.keys(f).forEach(function(b){"undefined"===typeof q[b]&&(q[b]=f[b])});return q});
define("orion/widgets/themes/editor/ThemeData",["i18n!orion/settings/nls/messages","orion/editor/textTheme"],function(f,m){function q(){}function b(){this.styles=[];var b=new q;b.name="Eclipse";b.annotationRuler="white";b.background="white";b.comment="green";b.keyword="#7f0055";b.text="darkSlateGray";b.string="blue";b.overviewRuler="white";b.lineNumberOdd="#444";b.lineNumberEven="#444";b.lineNumber="#444";b.currentLine="#EAF2FE";b.tag="darkorange";b.attribute="cadetBlue";b.fontFamily=g;b.fontSize=
e;this.styles.push(b);b=new q;b.name="Prospecto";b.annotationRuler="white";b.background="white";b.comment="#3C802C";b.keyword="#CC4C07";b.text="#333";b.string="#446FBD";b.overviewRuler="white";b.lineNumberOdd="silver";b.lineNumberEven="silver";b.lineNumber="silver";b.currentLine="#EAF2FE";b.tag="#CC4C07";b.attribute="cadetBlue";b.fontFamily=g;b.fontSize=e;this.styles.push(b);b=new q;b.name="Blue";b.annotationRuler="lavender";b.background="aliceBlue";b.comment="indigo";b.keyword="cornFlowerBlue";b.text=
"navy";b.string="cornFlowerBlue";b.overviewRuler="lavender";b.lineNumberOdd="darkSlateGray";b.lineNumberEven="darkSlateGray";b.lineNumber="darkSlateGray";b.currentLine="white";b.tag="cornFlowerBlue";b.attribute="cadetBlue";b.fontFamily=g;b.fontSize=e;this.styles.push(b);b=new q;b.name="Ambience";b.annotationRuler="#3D3D3D";b.background="#202020";b.comment="mediumslateblue";b.keyword="cornFlowerBlue";b.text="darkseagreen";b.string="lightcoral";b.overviewRuler="white";b.lineNumberOdd="black";b.lineNumberEven=
"black";b.lineNumber="black";b.currentLine="lightcyan";b.tag="cornFlowerBlue";b.attribute="cadetBlue";b.fontFamily=g;b.fontSize=e;this.styles.push(b);b=new q;b.name="Tierra";b.annotationRuler="moccasin";b.background="lemonchiffon";b.comment="darkseagreen";b.keyword="darkred";b.text="#555555";b.string="orangered";b.overviewRuler="moccasin";b.lineNumberOdd="chocolate";b.lineNumberEven="chocolate";b.lineNumber="chocolate";b.currentLine="#baa289";b.tag="darkred";b.attribute="cadetBlue";b.fontFamily=g;
b.fontSize=e;this.styles.push(b);b=new q;b.name="Nimbus";b.annotationRuler="#444";b.background="dimgray";b.comment="darkseagreen";b.keyword="darkorange";b.text="white";b.string="cornflowerblue";b.overviewRuler="#444";b.lineNumberOdd="#aaa";b.lineNumberEven="#aaa";b.lineNumber="#aaa";b.currentLine="#aabfbb";b.tag="darkorange";b.attribute="cadetBlue";b.fontFamily=g;b.fontSize=e;this.styles.push(b);b=new q;b.name="Adelante";b.annotationRuler="#E2D2B2";b.background="#F1E7C8";b.comment="#5D774E";b.keyword=
"#AF473B";b.text="dimgray";b.string="#DE5D3B";b.overviewRuler="#E2D2B2";b.lineNumberOdd="#AF473B";b.lineNumberEven="#AF473B";b.lineNumber="#AF473B";b.currentLine="#9e937b";b.tag="#AF473B";b.attribute="cadetBlue";b.fontFamily=g;b.fontSize=e;this.styles.push(b);b=new q;b.name="Raspberry Pi";b.annotationRuler="seashell";b.background="seashell";b.comment="#66B32F";b.keyword="#E73E36";b.text="dimgray";b.string="darkorange";b.overviewRuler="seashell";b.lineNumberOdd="#E73E36";b.lineNumberEven="#E73E36";
b.lineNumber="#E73E36";b.currentLine="#F5B1AE";b.tag="#E73E36";b.attribute="cadetBlue";b.fontFamily=g;b.fontSize=e;this.styles.push(b)}function l(){return this.styles}var g='"Consolas", "Monaco", "Vera Mono", "monospace"',e="10pt";b.prototype.styles=[];b.prototype.getStyles=l;b.prototype.fontSettable=!0;b.prototype.getThemeStorageInfo=function(){return{storage:"/themes",styleset:"editorstyles",defaultTheme:"Prospecto",selectedKey:"editorSelected"}};b.prototype.parseToXML=function(b){try{var e=null;
if(window.DOMParser){var e=(new DOMParser).parseFromString(b,"text/xml"),c=e.getElementsByTagName("parsererror");return!c||!c.length||!c[0].childNodes.length?e:null}e=new ActiveXObject("Microsoft.XMLDOM");e.async=!1;e.loadXML(b);return e}catch(a){}};b.prototype.selectFontSize=function(b){console.log("fontsize: "+b)};b.prototype.importTheme=function(b){console.log("import theme");console.log(b);var e=b.parameters.valueFor("name"),e=this.parseToXML(e),c=new q;c.name=e.getElementsByTagName("colorTheme")[0].attributes[1].value;
c.annotationRuler=e.getElementsByTagName("background")[0].attributes[0].value;c.background=e.getElementsByTagName("background")[0].attributes[0].value;c.comment=e.getElementsByTagName("singleLineComment")[0].attributes[0].value;c.keyword=e.getElementsByTagName("keyword")[0].attributes[0].value;c.text=e.getElementsByTagName("foreground")[0].attributes[0].value;c.string=e.getElementsByTagName("string")[0].attributes[0].value;c.overviewRuler=e.getElementsByTagName("background")[0].attributes[0].value;
c.lineNumberOdd=e.getElementsByTagName("lineNumber")[0].attributes[0].value;c.lineNumberEven=e.getElementsByTagName("lineNumber")[0].attributes[0].value;c.lineNumber=e.getElementsByTagName("lineNumber")[0].attributes[0].value;c.currentLine=e.getElementsByTagName("selectionBackground")[0].attributes[0].value;b.items.addTheme(c)};b.prototype.processSettings=function(b){var e=m.TextTheme.getTheme();e.setThemeClass("editorTheme",e.buildStyleSheet("editorTheme",b))};b.prototype.getViewData=function(){var b=
{top:10,left:10,width:400,height:350},e=b.left,c=b.top;b.shapes=[{type:"TEXT",name:f["Line Numbers"],label:"1",x:e+20,y:c+20,fill:"darkSlateGray",family:"lineNumber",font:"9pt sans-serif"},{type:"RECTANGLE",name:f.Background,x:e+46,y:c,width:290,height:b.height,family:"background",fill:"white"},{type:"TEXT",name:f.Strings,label:"'text/javascript'",x:e+134,y:c+20,fill:"darkorange",family:"string",font:"9pt sans-serif"},{type:"TEXT",name:f.Foreground,label:"=",x:e+124,y:c+20,fill:"darkSlateGray",family:"text",
font:"9pt sans-serif"},{type:"RECTANGLE",name:f["Current Line"],x:e+46,y:c+87,width:290,height:18,family:"currentLine",fill:"#eaf2fd"},{type:"TEXT",name:f["HTML Attribute"],label:"type",x:e+98,y:c+20,fill:"darkGray",family:"attribute",font:"9pt sans-serif"},{type:"RECTANGLE",name:f["Overview Ruler"],x:e+336,y:c,width:14,height:b.height,family:"overviewRuler",fill:"white"},{type:"TEXT",name:f.Comments,label:"/* comment */",x:e+75,y:c+40,fill:"darkSeaGreen",family:"comment",font:"9pt sans-serif"},{type:"TEXT",
name:f["HTML Tag"],label:"<script",x:e+55,y:c+20,fill:"darkorange",family:"keyword",font:"9pt sans-serif"},{type:"TEXT",name:f["HTML Tag"],label:">",x:e+213,y:c+20,fill:"darkorange",family:"keyword",font:"9pt sans-serif"},{type:"TEXT",name:f.Strings,label:"'Result'",x:e+164,y:c+80,fill:"cornflowerBlue",family:"string",font:"9pt sans-serif"},{type:"TEXT",name:f.Foreground,label:"multiply(a,b){",x:e+120,y:c+60,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},{type:"TEXT",name:f.Keywords,label:"function",
x:e+75,y:c+60,fill:"darkorange",family:"keyword",font:"9pt sans-serif"},{type:"TEXT",name:f.Keywords,label:"var",x:e+95,y:c+80,fill:"darkorange",family:"keyword",font:"9pt sans-serif"},{type:"TEXT",name:f.Foreground,label:"output = ",x:e+115,y:c+80,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},{type:"TEXT",name:f.Foreground,label:";",x:e+205,y:c+80,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},{type:"TEXT",name:f.Keywords,label:"var",x:e+95,y:c+100,fill:"darkorange",family:"keyword",
font:"9pt sans-serif"},{type:"TEXT",name:f.Foreground,label:"result = a*b;",x:e+115,y:c+100,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},{type:"TEXT",name:f.Keywords,label:"return",x:e+95,y:c+120,fill:"darkorange",family:"keyword",font:"9pt sans-serif"},{type:"TEXT",name:f.Foreground,label:"output + result;",x:e+135,y:c+120,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},{type:"TEXT",name:f.Foreground,label:"}",x:e+75,y:c+140,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},
{type:"TEXT",name:f["HTML Tag"],label:"<\/script>",x:e+55,y:c+160,fill:"darkorange",family:"keyword",font:"9pt sans-serif"},{type:"TEXT",name:f["HTML Tag"],label:"<style",x:e+55,y:c+200,fill:"darkorange",family:"keyword",font:"9pt sans-serif"},{type:"TEXT",name:f["HTML Attribute"],label:"type",x:e+95,y:c+200,fill:"darkGray",family:"attribute",font:"9pt sans-serif"},{type:"TEXT",name:f.Foreground,label:"=",x:e+121,y:c+200,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},{type:"TEXT",name:f.Strings,
label:"'text/css'",x:e+131,y:c+200,fill:"darkorange",family:"string",font:"9pt sans-serif"},{type:"TEXT",name:f["HTML Tag"],label:">",x:e+180,y:c+200,fill:"darkorange",family:"keyword",font:"9pt sans-serif"},{type:"TEXT",name:f["CSS Class Name"],label:".some-class",x:e+75,y:c+220,fill:"darkorange",family:"keyword",font:"9pt sans-serif"},{type:"TEXT",name:f["CSS Class Name"],label:"{",x:e+145,y:c+220,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},{type:"TEXT",name:f["CSS Attribute"],label:"color:",
x:e+95,y:c+240,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},{type:"TEXT",name:f["CSS Value"],label:"#123456",x:e+130,y:c+240,fill:"darkSlateGray",family:"string",font:"9pt sans-serif"},{type:"TEXT",name:f["CSS Text"],label:";",x:e+180,y:c+240,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},{type:"TEXT",name:f["CSS Class Name"],label:"}",x:e+75,y:c+260,fill:"darkSlateGray",family:"text",font:"9pt sans-serif"},{type:"TEXT",name:f["HTML Tag"],label:"</style>",x:e+55,y:c+280,fill:"darkorange",
family:"keyword",font:"9pt sans-serif"},{type:"RECTANGLE",name:f["Annotation Ruler"],x:e,y:c,width:46,height:b.height,family:"annotationRuler",fill:"white"}];for(var a=0;16>a;a++)b.shapes.push({type:"TEXT",name:f["Line Numbers"],label:a+1,x:e+20,y:c+20*a+20,fill:"darkSlateGray",family:"lineNumber",font:"9pt sans-serif"});return b};return{ThemeData:b,getStyles:l}});
define("orion/widgets/browse/readonlyEditorView","orion/editor/editor orion/editor/textView orion/editor/textModel orion/editor/projectionTextModel orion/editor/editorFeatures orion/editorPreferences orion/widgets/themes/ThemePreferences orion/widgets/themes/editor/ThemeData orion/objects".split(" "),function(f,m,q,b,l,g,e,d,h){function c(a){this._parent=a.parent;this.renderToolbars=a.renderToolbars;this.inputManager=a.inputManager;this.preferences=a.preferences;this.statusReporter=a.statusReporter;
this.model=a.model;this.syntaxHighlighter=a.syntaxHighlighter;this.readonly=!0;this.settings={};this._init()}c.prototype={getParent:function(){return this._parent},updateViewOptions:function(a){var b=0;a.showMargin&&(b=a.marginOffset,"number"!==typeof b&&(b=a.marginOffset=parseInt(b,10)));var c=0;a.wordWrap&&(c=b);return{readonly:this.readonly||this.inputManager.getReadOnly(),tabSize:a.tabSize||4,expandTab:a.expandTab,wrapMode:a.wordWrap,wrapOffset:c,marginOffset:b,scrollAnimation:a.scrollAnimation?
a.scrollAnimationTimeout:0}},updateSettings:function(a){this.settings=a;var b=this.editor,c=this.inputManager;c.setAutoLoadEnabled(a.autoLoad);c.setAutoSaveTimeout(a.autoSave?a.autoSaveTimeout:-1);c.setSaveDiffsEnabled(a.saveDiffs);this.updateStyler(a);var d=b.getTextView();d&&d.setOptions(this.updateViewOptions(a));b.setAnnotationRulerVisible(a.annotationRuler);b.setLineNumberRulerVisible(a.lineNumberRuler);b.setFoldingRulerVisible(a.foldingRuler);b.setOverviewRulerVisible(a.overviewRuler);this.renderToolbars&&
this.renderToolbars(c.getFileMetadata())},updateStyler:function(a){var b=this.syntaxHighlighter.getStyler();b&&(b.setTabsVisible&&b.setTabsVisible(a.showTabs),b.setSpacesVisible&&b.setSpacesVisible(a.showSpaces))},_init:function(){var a=null;this.preferences&&(a=this.editorPreferences=new g.EditorPreferences(this.preferences,function(b){b?this.updateSettings(b):a.getPrefs(this.updateSettings.bind(this))}.bind(this)));var c=null;this.preferences&&(c=new e.ThemePreferences(this.preferences,new d.ThemeData),
c.apply());var n=this._parent,c=this.inputManager,p=function(){var a=this.updateViewOptions(this.settings);h.mixin(a,{parent:n,model:new b.ProjectionTextModel(this.model||new q.TextModel)});return new m.TextView(a)}.bind(this),u=this.editor=new f.Editor({textViewFactory:p,annotationFactory:new l.AnnotationFactory,foldingRulerFactory:new l.FoldingRulerFactory,lineNumberRulerFactory:new l.LineNumberRulerFactory,statusReporter:this.statusReporter,domNode:n});u.id="orion.editor";c.addEventListener("InputChanged",
function(a){var b=u.getTextView();b&&(b.setOptions(this.updateViewOptions(this.settings)),this.syntaxHighlighter.setup(a.contentType,u.getTextView(),u.getAnnotationModel(),a.title,!0).then(function(){this.updateStyler(this.settings)}.bind(this)))}.bind(this));this.editorPreferences?this.editorPreferences.getPrefs(this.updateSettings.bind(this)):u.setAnnotationRulerVisible(!1)},create:function(){this.editor.install()},destroy:function(){this.editor.uninstall()},getStyleAccessor:function(){this.syntaxHighlighter.getStyler().getStyleAccessor()}};
return{ReadonlyEditorView:c}});
define("orion/widgets/browse/resourceSelector",["orion/objects","orion/webui/littlelib","orion/commands","orion/URITemplate","orion/URL-shim"],function(f,m,q,b){function l(b){this.resourceChangeListener=b.resourceChangeListener;this.resourceChangeDispatcher=b.resourceChangeDispatcher;this.fetchChildren=b.fetchChildren;this.fileClient=b.fileClient;this.commandRegistry=b.commandRegistry;this.commandScopeId=b.commandScopeId;this.dropDownId=b.dropDownId;this.dropDownTooltip=b.dropDownTooltip;this.allItems=
b.allItems;this.activeResourceName=b.activeResourceName;this.labelHeader=b.labelHeader;this.parentNode=b.parentNode;this.listener=function(b){this.refresh(b.root)}.bind(this);this.resourceChangeListener&&this.resourceChangeListener.addEventListener("resourceChanged",this.listener);this.render()}var g=new b("#{,resource,params*}");f.mixin(l.prototype,{destroy:function(){this.resourceChangeListener&&this.resourceChangeListener.removeEventListener("resourceChanged",this.listener);this.commandRegistry.destroy(this.parentNode);
m.empty(this.parentNode);this.resourceChangeListener=this.resourceChangeDispatcher=this.listener=this.parentNode=null},registerCommands:function(){if(!this.commandsRegistered){this.commandsRegistered=!0;var b=this.commandRegistry,d=new q.Command({imageClass:"core-sprite-openarrow",id:this.dropDownId,visibleWhen:function(){return!0},choiceCallback:this._switchBrMenuCallback.bind(this),positioningNode:this.parentNode});b.addCommand(d);b.registerCommandContribution(this.commandScopeId,this.dropDownId,
1)}},_switchBrMenuCallback:function(){var b=this;return this.allItems.map(function(d){return{name:d.Name,callback:b.setActiveResource.bind(b,{resource:d,changeHash:!0})}})},render:function(){this.resourceName=document.createElement("div");this.resourceName.classList.add("browserResourceSelectorName");this.resourceName.classList.add("layoutLeft");this.menu=document.createElement("ul");this.menu.classList.add("commandList");this.menu.classList.add("layoutRight");this.menu.classList.add("pageActions");
this.parentNode.appendChild(this.resourceName);this.parentNode.appendChild(this.menu);this.registerCommands();this.parentNode.addEventListener("click",this._openMenu.bind(this))},_openMenu:function(){var b=m.$(".dropdownTrigger",this.menu);if(b){var d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0);b.dispatchEvent(d)}},_resourceLabel:function(){var b=document.createDocumentFragment();b.textContent="${0} "+this.activeResourceName;var d=document.createElement("span");d.appendChild(document.createTextNode(this.labelHeader+
":"));d.classList.add("browserResourceSelectorNameLabel");m.processDOMNodes(b,[d]);return b},refresh:function(){m.empty(this.resourceName);this.resourceName.appendChild(this._resourceLabel());this.commandRegistry.destroy(this.menu);this.commandRegistry.renderCommands(this.commandScopeId,this.menu,{},"menu")},setActiveResource:function(b){this.activeResourceName=b.resource.Name;this.fetchChildren?b.resource.selectorAllItems?this.resourceChangeDispatcher&&this.resourceChangeDispatcher.dispatchEvent({type:"resourceChanged",
newResource:b.resource,defaultChild:b.defaultChild,changeHash:b.changeHash}):this.fileClient.fetchChildren(b.resource.Location).then(function(d){d&&0<d.length&&(b.resource.selectorAllItems=d,this.resourceChangeDispatcher&&this.resourceChangeDispatcher.dispatchEvent({type:"resourceChanged",newResource:b.resource,defaultChild:b.defaultChild,changeHash:b.changeHash}))}.bind(this),function(b){console.log(b)}.bind(this)):window.location=g.expand({resource:b.resource.Location})},getActiveResource:function(b){var d=
this.allItems[0];this.allItems.some(function(f){if(f.Location===b)return d=f,!0});return d}});return{ResourceSelector:l}});
define("orion/fileClient",["i18n!orion/navigate/nls/messages","orion/Deferred","orion/i18nUtil"],function(f,m,q){function b(b,d,g){if(!b[d])throw d+f[" is not supported in this file system"];return b[d].apply(b,g)}function l(e,d,g,c){if(!e.readBlob)throw f["source file service does not support binary read"];if(!g.writeBlob)throw f["target file service does not support binary write"];if("/"!==d[d.length-1])return b(e,"readBlob",[d]).then(function(a){return b(g,"writeBlob",[c,a])});var a=c.substring(0,
c.length-1),k=decodeURIComponent(a.substring(a.lastIndexOf("/")+1)),a=a.substring(0,a.lastIndexOf("/")+1);return b(g,"createFolder",[a,k]).then(function(){},function(){}).then(function(){return b(e,"fetchChildren",[d]).then(function(a){for(var b=[],d=0;d<a.length;++d){var f=a[d].Location,k=f;a[d].Directory&&(k=f.substring(0,f.length-1));k=decodeURIComponent(k.substring(k.lastIndexOf("/")+1));k=c+encodeURIComponent(k);a[d].Directory&&(k+="/");b[d]=l(e,f,g,k)}return m.all(b)})})}function g(b,d){function g(a){var b=
new m;b.reject(f["No Matching FileService for location:"]+a);return b}var c=b.getServiceReferences("orion.core.file"),a=c;if(d)for(var a=[],k=0;k<c.length;++k)d(c[k])&&a.push(c[k]);for(var l=[],p=[],u=[],s=[],w={fetchChildren:function(){var a=new m;a.resolve(s);return a},createWorkspace:function(){var a=new m;a.reject(f["no file service"]);return a},loadWorkspaces:function(){var a=new m;a.reject(f["no file service"]);return a},loadWorkspace:function(){var a=new m;window.setTimeout(function(){a.resolve({Directory:!0,
Length:0,LocalTimeStamp:0,Name:f["File Servers"],Location:"/",Children:s,ChildrenLocation:"/"})},100);return a},search:g,createProject:g,createFolder:g,createFile:g,deleteFile:g,moveFile:g,copyFile:g,read:g,write:g},c=0;c<a.length;++c)s[c]={Directory:!0,Length:0,LocalTimeStamp:0,Location:a[c].getProperty("top"),ChildrenLocation:a[c].getProperty("top"),Name:a[c].getProperty("Name")},k=a[c].getProperty("pattern")||a[c].getProperty("top").replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"^"!==k[0]&&(k=
"^"+k),l[c]=RegExp(k),p[c]=b.getService(a[c]),u[c]=a[c].getProperty("Name"),a[c].getProperty("NameKey")&&a[c].getProperty("nls")&&q.getMessageBundle(a[c].getProperty("nls")).then(function(b,c){s[b].Name=c[a[b].getProperty("NameKey")];u[b]=c[a[b].getProperty("NameKey")]}.bind(this,c));this._getServiceIndex=function(a){if("/"===a)return-1;if(!a||a.length&&0===a.length)return p[0]?0:-1;for(var b=0;b<l.length;++b)if(l[b].test(a))return b;throw f["No Matching FileService for location:"]+a;};this._getService=
function(a){a=this._getServiceIndex(a);return-1===a?w:p[a]};this._getServiceName=function(a){a=this._getServiceIndex(a);return-1===a?w.Name:u[a]};this._getServiceRootURL=function(a){a=this._getServiceIndex(a);return-1===a?w.Location:s[a].Location}}g.prototype={getService:function(b){return this._getService(b)},fileServiceName:function(b){return this._getServiceName(b)},fileServiceRootURL:function(b){return this._getServiceRootURL(b)},fetchChildren:function(e){return b(this._getService(e),"fetchChildren",
arguments)},createWorkspace:function(e){return b(this._getService(),"createWorkspace",arguments)},loadWorkspaces:function(){return b(this._getService(),"loadWorkspaces",arguments)},loadWorkspace:function(e){return b(this._getService(e),"loadWorkspace",arguments)},createProject:function(e,d,f,c){return b(this._getService(e),"createProject",arguments)},createFolder:function(e,d){return b(this._getService(e),"createFolder",arguments)},createFile:function(e,d){return b(this._getService(e),"createFile",
arguments)},deleteFile:function(e){return b(this._getService(e),"deleteFile",arguments)},moveFile:function(e,d,f){var c=this._getService(e),a=this._getService(d);if(c===a)return b(c,"moveFile",arguments);var g="/"===e[e.length-1],m=d;"/"!==m[m.length-1]&&(m+="/");if(f)m+=encodeURIComponent(f);else{var p=e;g&&(p=p.substring(0,p.length-1));m+=p.substring(p.lastIndexOf("/")+1)}g&&"/"!==m[m.length-1]&&(m+="/");return l(c,e,a,m).then(function(){return b(c,"deleteFile",[e])})},copyFile:function(e,d,f){var c=
this._getService(e),a=this._getService(d);if(c===a)return b(c,"copyFile",arguments);var g="/"===e[e.length-1],m=d;"/"!==m[m.length-1]&&(m+="/");if(f)m+=encodeURIComponent(f);else{var p=e;g&&(p=p.substring(0,p.length-1));m+=p.substring(p.lastIndexOf("/")+1)}g&&"/"!==m[m.length-1]&&(m+="/");return l(c,e,a,m)},read:function(e,d){return b(this._getService(e),"read",arguments)},readBlob:function(e){return b(this._getService(e),"readBlob",arguments)},write:function(e,d,f){return b(this._getService(e),"write",
arguments)},remoteImport:function(e,d){return b(this._getService(e),"remoteImport",arguments)},remoteExport:function(e,d){return b(this._getService(e),"remoteExport",arguments)},search:function(e){return b(this._getService(e.resource),"search",arguments)}};g.prototype.constructor=g;return{FileClient:g}});
define("orion/contentTypes",[],function(){function f(b,c){if("string"!==typeof b)return null;for(var a=b&&b.split(".").pop(),d=null,e=0;e<c.length;e++){var f=c[e],g;a:{g=d;var l=f,m=a,q=0<=l.filename.indexOf(b),x;x=m.toLowerCase();x=-1!==l.extension.indexOf(x);if(q||x){if(!(x=!g))q&&(m=m.toLowerCase(),q=-1!==g.extension.indexOf(m)),x=q;if(x){g=l;break a}}}g===f&&(d=f)}return d}function m(b){return null===b||"undefined"===typeof b?[]:Array.isArray(b)?b:[b]}function q(b){return{id:b.id,name:b.name,
image:b.image,imageClass:b.imageClass,"extends":b["extends"],extension:m(b.extension).map(function(b){return String.prototype.toLowerCase.call(b)}),filename:m(b.filename)}}function b(b){var c=Object.create(null);b.map(q).forEach(function(a){Object.prototype.hasOwnProperty.call(c,a.id)||(c[a.id]=a)});return c}function l(f){if(f&&f.registerService){this.serviceRegistry=f;for(var c=f.getServiceReferences(e).concat(f.getServiceReferences(d)),a=[],k=0;k<c.length;k++)for(var l=m(c[k].getProperty("contentTypes")),
p=0;p<l.length;p++)a.push(l[p]);this.map=b(a);f.registerService(g,this)}else if(Array.isArray(f))this.serviceRegistry=null,this.map=b(f);else throw Error("Invalid parameter");}var g="orion.core.contentTypeRegistry",e="orion.core.contenttype",d="orion.file.contenttype";l.prototype={getContentTypes:function(){var b=this.getContentTypesMap(),c=[],a;for(a in b)Object.prototype.hasOwnProperty.call(b,a)&&c.push(b[a]);return c},getContentTypesMap:function(){return this.map},getFileContentType:function(b){return f(b.Name,
this.getContentTypes())},getFilenameContentType:function(b){return f(b,this.getContentTypes())},getContentType:function(b){return this.map[b]||null},isExtensionOf:function(b,c){b="string"===typeof b?this.getContentType(b):b;c="string"===typeof c?this.getContentType(c):c;if(!b||!c)return!1;if(b.id===c.id)return!0;for(var a=b,d={};a&&(a=this.getContentType(a["extends"]));){if(a.id===c.id)return!0;if(d[a.id])throw Error("Cycle: "+a.id);d[a.id]=!0}return!1},isSomeExtensionOf:function(b,c){for(var a=0;a<
c.length;a++)if(this.isExtensionOf(b,c[a]))return!0;return!1}};return{ContentTypeRegistry:l,getFilenameContentType:f}});
define("orion/editor/textStyler",["orion/editor/annotations"],function(f){function m(a,b){this._unnamedCounter=0;this._patterns=[];this._rootId=b;a.forEach(function(a){this._addRepositoryPatterns(a.repository||{},a.id);this._addPatterns(a.patterns||[],a.id)}.bind(this))}function q(a,b,c,d,e){this.start=a.start;this.end=a.end;this.contentStart=a.contentStart;this.contentEnd=a.contentEnd;this.pattern=b;this._styler=c;this._parent=e;this._linePatterns=[];this._blockPatterns=[];this._enclosurePatterns=
{};d&&(this._initPatterns(),this._subBlocks=y(d,d.getText(this.start,this.end),this,this.start))}function b(a){this._styler=a}function l(a,c,d,e){this.highlightCaretLine=this.whitespacesVisible=this.spacesVisible=this.tabsVisible=!1;this.detectTasks=this.foldingEnabled=!0;this.view=a;this.annotationModel=c;this.patternManager=new m(d,e);this._accessor=new b(this);this._bracketAnnotations=void 0;var f=this;this._listener={onChanged:function(a){f._onModelChanged(a)},onDestroy:function(a){f._onDestroy(a)},
onLineStyle:function(a){f._onLineStyle(a)},onMouseDown:function(a){f._onMouseDown(a)},onSelection:function(a){f._onSelection(a)}};d=a.getModel();d.getBaseModel&&(d=d.getBaseModel());d.addEventListener("Changed",this._listener.onChanged);a.addEventListener("MouseDown",this._listener.onMouseDown);a.addEventListener("Selection",this._listener.onSelection);a.addEventListener("Destroy",this._listener.onDestroy);a.addEventListener("LineStyle",this._listener.onLineStyle);e=d.getCharCount();this._rootBlock=
new q({start:0,contentStart:0,end:e,contentEnd:e},null,this,d);this._computeFolding(this._rootBlock.getBlocks());c&&this.detectTasks&&(e=[],x(this._rootBlock,d,e),c.replaceAnnotations([],e));a.redrawLines()}var g={styleClass:"meta annotation currentLine"},e=/$/,d=/\\(\d)/g,h=/(.*)(?:[\r\n]|$)/g,c={regex:/ /g,style:{styleClass:"punctuation separator space",unmergeable:!0}},a={regex:/\t/g,style:{styleClass:"punctuation separator tab",unmergeable:!0}},k=function(a,b,c,d){var e=c,f=a.lastIndex;h.lastIndex=
c;var c=h.exec(b),g,k;a.lastIndex=0;if(c){for(k=c.index;0<=--k&&!(g=b.charAt(k),"\n"===g||"\r"===g););g=b.substring(k+1,c.index+c[1].length);a.lastIndex=k=c.index-k-1}for(;c&&c.index<b.length;){var l;if(d){var m=a.lastIndex;a.test(g)&&(a.lastIndex=m,l=a.exec(g))}else l=a.exec(g);if(l)return l.index+=e,l.index-=k,a.lastIndex=f,l;k=0;e+=c[0].length;if(c=h.exec(b))g=c[1],a.lastIndex=0}a.lastIndex=f;return null},n=function(a,b){var c=a.toString();d.lastIndex=0;if(!d.test(c))return a;d.lastIndex=0;for(var e=
d.exec(c);e;)c=c.replace(e[0],b[e[1]]||""),d.lastIndex=0,e=d.exec(c);return RegExp(c.substring(1,c.length-2),"g")},p=function(a,b,c,d){if(b=k(a.pattern.regex?a.pattern.regex:a.pattern.regexBegin,b,d,!0)){a.result=b;for(d=0;d<c.length;d++)if(b.index<c[d].result.index||b.index===c[d].result.index&&a.pattern.pattern.index<c[d].pattern.pattern.index){c.splice(d,0,a);return}c.push(a)}},u=function(a,b,c,d){if(b[0])d.push({start:c,end:c+a[0].length,style:b[0].name});else for(var e=0,f=1;f<a.length;f++)if(a[f]){var g=
b[f];if(g){var k=c+e;d.push({start:k,end:k+a[f].length,style:g.name})}e+=a[f].length}},s=function(a,b,c){var d=a.start;b.forEach(function(b){d<=b.start&&c.push({start:d,end:b.start,style:a.style});c.push(b);d=b.end});d<a.end&&c.push({start:d,end:a.end,style:a.style})},w=function(a,b,c,d,f){if(c=c.getLinePatterns()){var g=[];c.forEach(function(b){var c=b.regex||b.regexBegin;c.oldLastIndex=c.lastIndex;(c=k(c,a,0))&&g.push({result:c,pattern:b})});g.sort(function(a,b){return a.result.index<b.result.index?
-1:a.result.index>b.result.index?1:a.pattern.pattern.index<b.pattern.pattern.index?-1:1});for(var h=0;0<g.length;){var l=g[0];g.splice(0,1);if(!(l.result.index<h)){var m=l.result.index,q,w=[];if(l.pattern.regex){h=l.result;q=m+h[0].length;q={start:b+m,end:b+q,style:l.pattern.pattern.name};if(!f){l.pattern.pattern.captures&&u(h,l.pattern.pattern.captures,b+m,w);w.sort(function(a,b){return a.start<b.start?-1:a.start>b.start?1:0});for(m=0;m<w.length-1;m++)if(w[m+1].start<w[m].end){var x={start:w[m+1].end,
end:w[m].end,style:w[m].style};w[m].end=w[m+1].start;w.splice(m+2,0,x)}}s(q,w,d)}else h=l.pattern.regexEnd,h=n(h,l.result),h=k(h,a,l.result.index+l.result[0].length),h||(e.lastIndex=0,h=e.exec(a)),q=h.index+h[0].length,d.push({start:b+m,end:b+q,style:l.pattern.pattern.name});h=h.index+h[0].length}p(l,a,g,h)}c.forEach(function(a){a=a.regex||a.regexBegin;a.lastIndex=a.oldLastIndex})}},y=function(a,b,c,d){var f=[];c.getBlockPatterns().forEach(function(a){var c=k(a.regexBegin||a.regex,b,0);c&&f.push({result:c,
pattern:a})}.bind(this));if(!f.length)return f;f.sort(function(a,b){return a.result.index<b.result.index?-1:a.result.index>b.result.index?1:a.pattern.pattern.index<b.pattern.pattern.index?-1:1});for(var g=0,h=[];0<f.length;){var l=f[0];f.splice(0,1);if(!(l.result.index<g)){var m=a.getLineAtOffset(d+l.result.index),s=a.getLine(m),u=[];w(s,a.getLineStart(m),c,u);m=d+l.result.index;for(s=0;s<u.length;s++)if(u[s].start===m){var g=l.result.index,x=null,y=l.pattern.regexEnd;if(y)for(var g=g+l.result[0].length,
y=n(y,l.result),E=g;!x;){E=k(y,b,E);E||(e.lastIndex=0,E=e.exec(b));var O=[],Q=new q({start:m,end:d+E.index+E[0].length,contentStart:d+g,contentEnd:d+E.index},l.pattern,c.getStyler(),a,c);w(b.substring(g,E.index+E[0].length),g,Q,O);if(!O.length||O[O.length-1].end<=E.index)x=Q;E=E.index+E[0].length}else x=new q({start:m,end:m+l.result[0].length,contentStart:m,contentEnd:m+l.result[0].length},l.pattern,c.getStyler(),a,c);h.push(x);g=x.end-d;break}s===u.length&&(g=l.result.index+1)}p(l,b,f,g)}return h},
x=function(a,b,c){if(a.getAnnotationModel()){var d=f.AnnotationType.ANNOTATION_TASK;if(a.getLinePatterns().length&&a.pattern&&a.pattern.pattern.name&&0===a.pattern.pattern.name.indexOf("comment")){var e=[];w(b.getText(a.contentStart,a.end),a.contentStart,a,e,!0);for(var g=0;g<e.length;g++)"meta.annotation.task.todo"===e[g].style&&c.push(f.AnnotationType.createAnnotation(d,e[g].start,e[g].end,b.getText(e[g].start,e[g].end)))}a.getBlocks().forEach(function(a){x(a,b,c)}.bind(this))}};m.prototype={getPatterns:function(a){var b=
[0],c={},d=RegExp("^"+(a?"string"===typeof a?a:a.qualifiedId:this._rootId)+"#[^#]+$"),e=[];this._patterns.forEach(function(a){d.test(a.qualifiedId)&&(a.include?e.push(a):(a.index=b[0]++,c[a.id]=a))}.bind(this));e.forEach(function(a){this._processInclude(a,b,c)}.bind(this));var f=[];Object.keys(c).forEach(function(a){f.push(c[a])});return f},_addPatterns:function(a,b){a.forEach(function(a){this._addPattern(a,this._NO_ID+this._unnamedCounter++,b)}.bind(this))},_addRepositoryPatterns:function(a,b){Object.keys(a).forEach(function(c){this._addPattern(a[c],
c,b)}.bind(this))},_addPattern:function(a,b,c){a.parentId=c;a.id=b;a.qualifiedId=a.parentId+"#"+a.id;this._patterns.push(a);a.patterns&&!a.include&&this._addPatterns(a.patterns,a.qualifiedId)},_processInclude:function(a,b,c){var d,e=a.include.indexOf("#");d=0===e?RegExp("^"+a.qualifiedId.substring(0,a.qualifiedId.indexOf("#"))+a.include+"$"):-1===e?RegExp("^"+a.include+"#"+this._NO_ID+"[^#]+$"):RegExp("^"+a.include+"$");var f=[];this._patterns.forEach(function(a){d.test(a.qualifiedId)&&(a.include?
f.push(a):c[a.id]||(a.index=b[0]++,c[a.id]=a))}.bind(this));f.forEach(function(a){this._processInclude(a,b,c)}.bind(this))},_NO_ID:"NoID"};q.prototype={adjustEnd:function(a){this.end+=a;this.contentEnd+=a;this._subBlocks.forEach(function(b){b.adjustEnd(a)})},adjustStart:function(a){this.start+=a;this.contentStart+=a;this._subBlocks.forEach(function(b){b.adjustStart(a)})},computeStyle:function(a,b){if(!this.pattern||!(this.start<=b&&b<this.end))return null;var c={start:this.start,end:this.end,style:this.pattern.pattern.name};
if(this.contentStart<=b&&b<this.contentEnd)return this.pattern.pattern.contentName?{start:this.contentStart,end:this.contentEnd,style:this.pattern.pattern.contentName}:c;var d,e,f,g;if(b<this.contentStart){e=this.pattern.pattern.beginCaptures||this.pattern.pattern.captures;if(!e)return c;d=this.pattern.regexBegin;f=a.getText(this.start,this.contentStart);g=this.start}else{e=this.pattern.pattern.endCaptures||this.pattern.pattern.captures;if(!e)return c;d=this.pattern.regexEnd;f=a.getText(this.contentEnd,
this.end);g=this.contentEnd}d.lastIndex=0;if(f=d.exec(f)){d=[];u(f,e,g,d);for(e=0;e<d.length;e++)if(d[e].start<=b&&b<d[e].end)return d[e]}return c},getAnnotationModel:function(){return this._styler._getAnnotationModel()},getBlockPatterns:function(){return this._blockPatterns},getBlocks:function(){return this._subBlocks},getEnclosurePatterns:function(){return this._enclosurePatterns},getLinePatterns:function(){return this._linePatterns},getParent:function(){return this._parent},getPatternManager:function(){return this._styler._getPatternManager()},
getStyler:function(){return this._styler},isRenderingWhitespace:function(){return this._styler._isRenderingWhitespace()},_initPatterns:function(){var a=function(a){var b=/^\(\?i\)\s*/.exec(a);b&&(a=a.substring(b[0].length));return a};this.getPatternManager().getPatterns(this.pattern?this.pattern.pattern:null).forEach(function(b){var c;if(b.match&&!b.begin&&!b.end){c="g";var d=a(b.match);d!==b.match&&(c+="i");c={regex:RegExp(d,c),pattern:b};this._linePatterns.push(c);if(b.patterns)this._blockPatterns.push(c);
else if(b.name&&0===b.name.indexOf("punctuation.section")&&(-1!==b.name.indexOf(".begin")||-1!==b.name.indexOf(".end")))this._enclosurePatterns[b.name]=c}else if(!b.match&&b.begin&&b.end){c="g";d=a(b.begin);d!==b.begin&&(c+="i");var e="g",f=a(b.end);f!==b.end&&(e+="i");c={regexBegin:RegExp(d,c),regexEnd:RegExp(f,e),pattern:b};this._linePatterns.push(c);this._blockPatterns.push(c)}}.bind(this))}};b.prototype={getStyles:function(a){return this._styler.getStyles(a)}};l.prototype={destroy:function(){var a=
this.view;if(a){var b=a.getModel();b.getBaseModel&&(b=b.getBaseModel());b.removeEventListener("Changed",this._listener.onChanged);a.removeEventListener("MouseDown",this._listener.onMouseDown);a.removeEventListener("Selection",this._listener.onSelection);a.removeEventListener("Destroy",this._listener.onDestroy);a.removeEventListener("LineStyle",this._listener.onLineStyle);this.view=null}},getStyleAccessor:function(){return this._accessor},getStyles:function(a){var b=[],c=this.view.getModel();c.getBaseModel&&
(c=c.getBaseModel());var d=this._findBlock(this._rootBlock,a),e=c.getLineAtOffset(a),f=c.getLine(e),g=[];w(f,c.getLineStart(e),d,g);for(e=0;e<g.length&&!(a<g[e].start);e++)if(g[e].start<=a&&a<g[e].end){b.push(g[e]);break}for(;d;)(g=d.computeStyle(c,a))&&b.splice(0,0,g),d=d.getParent();return b},setHighlightCaretLine:function(a){this.highlightCaretLine=a},setWhitespacesVisible:function(a,b){this.whitespacesVisible!==a&&(this.whitespacesVisible=a,b&&this.view.redraw())},setTabsVisible:function(a){this.tabsVisible!==
a&&(this.tabsVisible=a,this.setWhitespacesVisible(this.tabsVisible||this.spacesVisible,!1),this.view.redraw())},setSpacesVisible:function(a){this.spacesVisible!==a&&(this.spacesVisible=a,this.setWhitespacesVisible(this.tabsVisible||this.spacesVisible,!1),this.view.redraw())},setDetectHyperlinks:function(){},setFoldingEnabled:function(a){this.foldingEnabled=a},setDetectTasks:function(a){this.detectTasks=a},_binarySearch:function(a,b,c,d,e){var f;void 0===d&&(d=-1);void 0===e&&(e=a.length);for(;1<e-
d;)if(f=Math.floor((e+d)/2),b<=a[f].start)e=f;else if(c&&b<a[f].end){e=f;break}else d=f;return e},_computeFolding:function(a){if(this.foldingEnabled){var b=this.view.getModel();if(b.getBaseModel){var c=this.annotationModel;if(c){c.removeAnnotations(f.AnnotationType.ANNOTATION_FOLDING);for(var d=[],e=b.getBaseModel(),g=0;g<a.length;g++){var k=a[g];(k=this._createFoldingAnnotation(b,e,k.start,k.end))&&d.push(k)}c.replaceAnnotations(null,d)}}}},_createFoldingAnnotation:function(a,b,c,d){var e=b.getLineAtOffset(c),
b=b.getLineAtOffset(d);return e===b?null:new (f.AnnotationType.getType(f.AnnotationType.ANNOTATION_FOLDING))(c,d,a)},_findBlock:function(a,b){var c=a.getBlocks();if(!c.length)return a;var d=this._binarySearch(c,b,!0);return d<c.length&&c[d].start<=b&&b<c[d].end?this._findBlock(c[d],b):a},_findBrackets:function(a,b,c,d,e,f){for(var g=[],k=[],h=e,l=c.getBlocks(),m=this._binarySearch(l,e,!0);m<l.length&&!(l[m].start>=f);m++){var n=l[m].start,p=l[m].end;h<n&&(w(d.substring(h-e,n-e),h,c,k),k.forEach(function(c){0===
c.style.indexOf(a.pattern.name)?g.push(c.start+1):0===c.style.indexOf(b.pattern.name)&&g.push(-(c.start+1))}),k=[]);h=p}h<f&&(w(d.substring(h-e,f-e),h,c,k),k.forEach(function(c){0===c.style.indexOf(a.pattern.name)?g.push(c.start+1):0===c.style.indexOf(b.pattern.name)&&g.push(-(c.start+1))}));return g},_findMatchingBracket:function(a,b,c){for(var d=a.getLineAtOffset(c),e=a.getLineEnd(d),f=a.getText(c,e),g,h=b.getEnclosurePatterns(),l=Object.keys(h),m=0;m<l.length;m++){var n=h[l[m]],p=k(n.regex,f,0);
if(p&&0===p.index){g=n;break}}if(!g)return-1;f=!1;-1!==g.pattern.name.indexOf(".begin")?(f=!0,m=g.pattern.name.replace(".begin",".end")):m=g.pattern.name.replace(".end",".begin");h=h[m];if(!h)return-1;l=a.getLine(d);n=a.getLineStart(d);e=this._findBrackets(g,h,b,l,n,e);for(m=0;m<e.length;m++)if(l=0<=e[m]?1:-1,e[m]*l-1===c){c=1;if(f){for(m++;m<e.length;m++)if(l=0<=e[m]?1:-1,c+=l,0===c)return e[m]*l-1;d+=1;for(m=a.getLineCount();d<m;){l=a.getLine(d);n=a.getLineStart(d);e=a.getLineEnd(d);e=this._findBrackets(g,
h,b,l,n,e);for(f=0;f<e.length;f++)if(l=0<=e[f]?1:-1,c+=l,0===c)return e[f]*l-1;d++}}else{for(m--;0<=m;m--)if(l=0<=e[m]?1:-1,c+=l,0===c)return e[m]*l-1;for(d-=1;0<=d;){l=a.getLine(d);n=a.getLineStart(d);e=a.getLineEnd(d);e=this._findBrackets(g,h,b,l,n,e);for(m=e.length-1;0<=m;m--)if(l=0<=e[m]?1:-1,c+=l,0===c)return e[m]*l-1;d--}}break}return-1},_getAnnotationModel:function(){return this.annotationModel},_getLineStyle:function(a){if(this.highlightCaretLine){var b=this.view,c=b.getModel(),b=b.getSelection();
if(b.start===b.end&&c.getLineAtOffset(b.start)===a)return g}return null},_getPatternManager:function(){return this.patternManager},_getStyles:function(a,b,c,d){b.getBaseModel&&(d=b.mapOffset(d));for(var e=d+c.length,f=[],g=d,h=a.getBlocks(),l=this._binarySearch(h,d,!0);l<h.length&&!(h[l].start>=e);l++){var m=h[l].start,n=h[l].end;g<m&&w(c.substring(g-d,m-d),g,a,f);var p=Math.max(g,m);if(p===m&&h[l].pattern.regexBegin){var q=k(h[l].pattern.regexBegin,c.substring(p-d),0);if(q){var s=h[l].pattern.pattern.beginCaptures||
h[l].pattern.pattern.captures;s?u(q,s,p,f):f.push({start:p,end:p+q[0].length,style:h[l].pattern.pattern.name});p+=q[0].length}}var m=Math.min(e,n),x=[];if(m===n&&h[l].pattern.regexEnd&&(g=c.substring(m-g-(h[l].end-h[l].contentEnd)),q=k(h[l].pattern.regexEnd,g,0)))(s=h[l].pattern.pattern.endCaptures||h[l].pattern.pattern.captures)?u(q,s,m-q[0].length,x):h[l].pattern.pattern.name&&x.push({start:m-q[0].length,end:m,style:h[l].pattern.pattern.name}),m-=q[0].length;var g=this._getStyles(h[l],b,c.substring(p-
d,m-d),p),y=h[l].pattern.pattern.contentName||h[l].pattern.pattern.name;if(y){var N=p;g.forEach(function(a){a.start-N&&f.push({start:N,end:a.start,style:y});f.push(a);N=a.end});m-N&&f.push({start:N,end:m,style:y})}else f=f.concat(g);f=f.concat(x);g=n}g<e&&w(c.substring(g-d,e-d),g,a,f);if(b.getBaseModel)for(a=0;a<f.length;a++)c=f[a].end-f[a].start,f[a].start=b.mapOffset(f[a].start,!0),f[a].end=f[a].start+c;return f},_isRenderingWhitespace:function(){return this.whitespacesVisible&&(this.tabsVisible||
this.spacesVisible)},_onDestroy:function(){this.destroy()},_onLineStyle:function(b){b.textView===this.view&&(b.style=this._getLineStyle(b.lineIndex));b.ranges=this._getStyles(this._rootBlock,b.textView.getModel(),b.lineText,b.lineStart);b.ranges.forEach(function(a){a.style&&(a.style={styleClass:a.style.replace(/\./g," ")})});this._isRenderingWhitespace()&&(this.spacesVisible&&this._spliceStyles(c,b.ranges,b.lineText,b.lineStart),this.tabsVisible&&this._spliceStyles(a,b.ranges,b.lineText,b.lineStart))},
_onSelection:function(a){var b=a.oldValue,c=a.newValue,d=this.view,a=d.getModel(),e;if(this.highlightCaretLine){var g=a.getLineAtOffset(b.start);e=a.getLineAtOffset(c.start);var h=c.start===c.end,b=b.start===b.end;g===e&&b&&h||(b&&d.redrawLines(g,g+1),(g!==e||!b)&&h&&d.redrawLines(e,e+1))}if(this.annotationModel){var b=this._bracketAnnotations,k,l;if(c.start===c.end&&0<(l=d.getCaretOffset()))l-=1,a.getBaseModel&&(l=a.mapOffset(l),a=a.getBaseModel()),c=this._findBlock(this._rootBlock,l),a=this._findMatchingBracket(a,
c,l),-1!==a&&(k=[f.AnnotationType.createAnnotation(f.AnnotationType.ANNOTATION_MATCHING_BRACKET,a,a+1),f.AnnotationType.createAnnotation(f.AnnotationType.ANNOTATION_CURRENT_BRACKET,l,l+1)]);this._bracketAnnotations=k;this.annotationModel.replaceAnnotations(b,k)}},_onMouseDown:function(a){if(2===a.clickCount){var b=this.view,c=b.getModel(),d=b.getOffsetAtLocation(a.x,a.y);if(0<d){var e=d-1,f=c;c.getBaseModel&&(e=c.mapOffset(e),f=c.getBaseModel());var g=this._findBlock(this._rootBlock,e),e=this._findMatchingBracket(f,
g,e);-1!==e&&(a.preventDefault(),a=e,c.getBaseModel&&(a=c.mapOffset(a,!0)),d>a&&(d--,a++),b.setSelection(a,d))}}},_onModelChanged:function(a){var b=a.start,c=a.removedCharCount,a=a.addedCharCount-c,d=this.view,e=d.getModel(),g=e.getBaseModel?e.getBaseModel():e,c=b+c,h=g.getCharCount(),k=this._rootBlock.getBlocks(),l=k.length,m=g.getLineStart(g.getLineAtOffset(b)),n=this._binarySearch(k,m,!0),p=this._binarySearch(k,c,!1,n-1,l),q;n<l&&k[n].start<=m&&m<k[n].end?(q=k[n].start,q>b&&(q+=a)):q=n===l&&0<
l&&h-a===k[l-1].end?k[l-1].start:m;var s;do p<l?(s=k[p].end,s>b&&(s+=a),p+=1):(p=l,s=h),m=g.getText(q,s),m=y(g,m,this._rootBlock,q);while(m.length&&k.length&&p<l&&m[m.length-1].pattern.pattern.id!==k[p-1].pattern.pattern.id);for(h=n;h<k.length;h++)l=k[h],l.start>b&&l.adjustStart(a),l.start>b&&l.adjustEnd(a);var u=p-n!==m.length;if(!u)for(h=0;h<m.length;h++){var l=k[n+h],w=m[h];if(l.start!==w.start||l.end!==w.end||l.type!==w.type){u=!0;break}}h=[n,p-n].concat(m);Array.prototype.splice.apply(k,h);u&&
(h=q,l=s,e!==g&&(h=e.mapOffset(h,!0),l=e.mapOffset(l,!0)),d.redrawRange(h,l));if(this.annotationModel){d=[];k=[];n=[];q=this.annotationModel.getAnnotations(q,s);for(s=this.foldingEnabled&&g!==e;q.hasNext();)if(l=q.next(),s&&l.type===f.AnnotationType.ANNOTATION_FOLDING){n.push(l);for(h=0;h<m.length&&!(l.start===m[h].start&&l.end===m[h].end);h++);h===m.length?(d.push(l),l.expand()):(h=l.start,p=l.end,h>b&&(h-=a),p>b&&(p-=a),h<=b&&(b<p&&h<=c&&c<p)&&(h=g.getLineAtOffset(l.start),p=g.getLineAtOffset(l.end),
h!==p?l.expanded||l.expand():this.annotationModel.removeAnnotation(l)));for(h=0;h<m.length;h++){l=m[h];for(p=0;p<n.length&&!(n[p].start===l.start&&n[p].end===l.end);p++);p===n.length&&(l=this._createFoldingAnnotation(e,g,l.start,l.end))&&k.push(l)}}else l.type===f.AnnotationType.ANNOTATION_TASK&&d.push(l);if(this.detectTasks)for(h=0;h<m.length;h++)x(m[h],g,k);this.annotationModel.replaceAnnotations(d,k)}},_spliceStyles:function(a,b,c,d){for(var e=a.regex,f=e.lastIndex=0,g=e.exec(c);g;){for(g=d+g.index;f<
b.length&&!(g<b[f].end);)f++;var h={start:g,end:g+1,style:a.style};if(f<b.length&&b[f].start<=g){var k={start:g+1,end:b[f].end,style:b[f].style};b[f].end=g;b.splice(f+1,0,k);b.splice(f+1,0,h);f+=2}else b.splice(f,0,h),f++;g=e.exec(c)}}};return{TextStyler:l}});
define("orion/editor/stylers/lib/syntax",[],function(){return{id:"orion.lib",grammars:[{id:"orion.lib",patterns:[{include:"#brace_open"},{include:"#brace_close"},{include:"#bracket_open"},{include:"#bracket_close"},{include:"#parenthesis_open"},{include:"#parenthesis_close"},{include:"#number_decimal"},{include:"#number_hex"},{include:"#string_doubleQuote"},{include:"#string_singleQuote"}],repository:{brace_open:{match:"{",name:"punctuation.section.block.begin"},brace_close:{match:"}",name:"punctuation.section.block.end"},
bracket_open:{match:"\\[",name:"punctuation.section.bracket.begin"},bracket_close:{match:"\\]",name:"punctuation.section.bracket.end"},parenthesis_open:{match:"\\(",name:"punctuation.section.parens.begin"},parenthesis_close:{match:"\\)",name:"punctuation.section.parens.end"},doc_block:{begin:"/\\*\\*",end:"\\*/",name:"comment.block.documentation",patterns:[{match:"@(?:(?!\\*/)\\S)*",name:"keyword.other.documentation.tag"},{match:"\\<\\S*\\>",name:"keyword.other.documentation.markup"},{match:"(\\b)(TODO)(\\b)(((?!\\*/).)*)",
name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]},number_decimal:{match:"\\b-?(?:\\.\\d+|\\d+\\.?\\d*)(?:[eE][+-]?\\d+)?\\b",name:"constant.numeric.number"},number_hex:{match:"\\b0[xX][0-9A-Fa-f]+\\b",name:"constant.numeric.hex"},string_doubleQuote:{match:'"(?:\\\\.|[^"])*"?',name:"string.quoted.double"},string_singleQuote:{match:"'(?:\\\\.|[^'])*'?",name:"string.quoted.single"},todo_comment_singleLine:{match:"(\\b)(TODO)(\\b)(.*)",
name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.line"}}}}},{id:"orion.c-like",patterns:[{include:"orion.lib"},{include:"#comment_singleLine"},{include:"#comment_block"}],repository:{comment_singleLine:{match:"//.*",name:"comment.line.double-slash",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},comment_block:{begin:"/\\*",end:"\\*/",name:"comment.block",patterns:[{match:"(\\b)(TODO)(\\b)(((?!\\*/).)*)",name:"meta.annotation.task.todo",
captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]}}}],keywords:[]}});
define("orion/editor/stylers/application_javascript/syntax",["orion/editor/stylers/lib/syntax"],function(f){var m="break case class catch continue const debugger default delete do else enum export extends false finally for function if implements import in instanceof interface let new null package private protected public return static super switch this throw true try typeof undefined var void while with yield".split(" "),f=f.grammars;f.push({id:"orion.js",contentTypes:["application/javascript"],patterns:[{include:"orion.lib#doc_block"},
{include:"orion.c-like"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.control.js"},{begin:"(['\"])(?:\\\\.|[^\\\\\\1])*\\\\$",end:"^(?:$|(?:\\\\.|[^\\\\\\1])*(\\1|[^\\\\]$))",name:"string.quoted.multiline.js"}]});return{id:f[f.length-1].id,grammars:f,keywords:m}});
define("orion/editor/stylers/text_css/syntax",["orion/editor/stylers/lib/syntax"],function(f){var m="alignment-adjust alignment-baseline animation-delay animation-direction animation-duration animation-iteration-count animation-name animation-play-state animation-timing-function animation appearance azimuth backface-visibility background-attachment background-clip background-color background-image background-origin background-position background-repeat background-size background baseline-shift binding bleed bookmark-label bookmark-level bookmark-state bookmark-target border-bottom-color border-bottom-left-radius border-bottom-right-radius border-bottom-style border-bottom-width border-bottom border-collapse border-color border-image-outset border-image-repeat border-image-slice border-image-source border-image-width border-image border-left-color border-left-style border-left-width border-left border-radius border-right-color border-right-style border-right-width border-right border-spacing border-style border-top-color border-top-left-radius border-top-right-radius border-top-style border-top-width border-top border-width border bottom box-align box-decoration-break box-direction box-flex-group box-flex box-lines box-ordinal-group box-orient box-pack box-shadow box-sizing break-after break-before break-inside caption-side clear clip color-profile color column-count column-fill column-gap column-rule-color column-rule-style column-rule-width column-rule column-span column-width columns content counter-increment counter-reset crop cue-after cue-before cue cursor direction display dominant-baseline drop-initial-after-adjust drop-initial-after-align drop-initial-before-adjust drop-initial-before-align drop-initial-size drop-initial-value elevation empty-cells fit-position fit flex-align flex-flow flex-inline-pack flex-order flex-pack float-offset float font-family font-size font-size-adjust font-stretch font-style font-variant font-weight font grid-columns grid-rows hanging-punctuation height hyphenate-after hyphenate-before hyphenate-character hyphenate-lines hyphenate-resource hyphens icon image-orientation image-rendering image-resolution inline-box-align left letter-spacing line-height line-stacking-ruby line-stacking-shift line-stacking-strategy line-stacking list-style-image list-style-position list-style-type list-style margin-bottom margin-left margin-right margin-top margin mark-after mark-before mark marker-offset marks marquee-direction marquee-loop marquee-play-count marquee-speed marquee-style max-height max-width min-height min-width move-to nav-down nav-index nav-left nav-right nav-up opacity orphans outline-color outline-offset outline-style outline-width outline overflow-style overflow-x overflow-y overflow padding-bottom padding-left padding-right padding-top padding page-break-after page-break-before page-break-inside page-policy page pause-after pause-before pause perspective-origin perspective phonemes pitch-range pitch play-during position presentation-level punctuation-trim quotes rendering-intent resize rest-after rest-before rest richness right rotation-point rotation ruby-align ruby-overhang ruby-position ruby-span size speak-header speak-numeral speak-punctuation speak speech-rate stress string-set table-layout target-name target-new target-position target text-align-last text-align text-decoration text-emphasis text-height text-indent text-justify text-outline text-shadow text-transform text-wrap top transform-origin transform-style transform transition-delay transition-duration transition-property transition-timing-function transition unicode-bidi vertical-align visibility voice-balance voice-duration voice-family voice-pitch-range voice-pitch voice-rate voice-stress voice-volume volume white-space-collapse white-space widows width word-break word-spacing word-wrap z-index".split(" "),f=
f.grammars;f.push({id:"orion.css",contentTypes:["text/css"],patterns:[{include:"orion.lib"},{include:"orion.c-like#comment_block"},{match:"(?:-webkit-|-moz-|-ms-|\\b)(?:"+m.join("|")+")\\b",name:"keyword.control.css"},{match:"(?i)\\b-?(?:\\.\\d+|\\d+\\.?\\d*)(?:%|em|ex|ch|rem|vw|vh|vmin|vmax|in|cm|mm|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?\\b",name:"constant.numeric.value.css"},{begin:"(['\"])(?:\\\\.|[^\\\\\\1])*\\\\$",end:"^(?:$|(?:\\\\.|[^\\\\\\1])*(\\1|[^\\\\]$))",name:"string.quoted.multiline.css"}],
repository:{number_hex:{match:"#[0-9A-Fa-f]+\\b",name:"constant.numeric.hex.css"}}});return{id:f[f.length-1].id,grammars:f,keywords:m}});
define("orion/editor/stylers/text_x-php/syntax",["orion/editor/stylers/lib/syntax"],function(f){var m="abstract and array as break callable case catch class clone const continue declare default die do echo else elseif empty enddeclare endfor endforeach endif endswitch endwhile eval exit extends false FALSE final finally for foreach function global goto if implements include include_once insteadof interface instanceof isset list namespace new null NULL or parent print private protected public require require_once return self static switch throw trait try true TRUE unset use var while xor yield __halt_compiler __CLASS__ __DIR__ __FILE__ __FUNCTION__ __LINE__ __METHOD__ __NAMESPACE__ __TRAIT__".split(" "),f=
f.grammars;f.push({id:"orion.php",contentTypes:["text/x-php"],patterns:[{include:"orion.lib#doc_block"},{include:"orion.c-like"},{match:"(?i)<\\?(?:=|php)?(?:\\s|$)",name:"entity.name.declaration.php"},{match:"<%=?(?:\\s|$)",name:"entity.name.declaration.php"},{match:"#.*",name:"comment.line.number-sign.php",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},{begin:"<<<(\\w+)$",end:"^\\1;$",name:"string.unquoted.heredoc.php"},{begin:"<<<'(\\w+)'$",end:"^\\1;$",name:"string.unquoted.heredoc.nowdoc.php"},
{match:"\\b0[bB][01]+\\b",name:"constant.numeric.binary.php"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.control.php"}]});return{id:"orion.php",grammars:f,keywords:m}});
define("orion/editor/stylers/application_xml/syntax",["orion/editor/stylers/lib/syntax"],function(f){f=f.grammars;f.push({id:"orion.xml",contentTypes:["application/xml","application/xhtml+xml"],patterns:[{include:"#comment"},{include:"#xmlDeclaration"},{begin:"<!(?:doctype|DOCTYPE)",end:">",captures:{"0":{name:"entity.name.tag.doctype.xml"}},patterns:[{include:"#comment"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"}],name:"meta.tag.doctype.xml"},{begin:"</?[A-Za-z0-9]+",
end:"/?>",captures:{"0":{name:"entity.name.tag.xml"}},name:"meta.tag.xml",patterns:[{include:"#comment"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"}]},{match:"&lt;|&gt;|&amp;",name:"constant.character"}],repository:{comment:{begin:"<\!--",end:"--\>",name:"comment.block.xml",patterns:[{match:"(\\b)(TODO)(\\b)(((?!--\>).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.line"}}}]},xmlDeclaration:{begin:"<\\?xml",
end:"\\?>",captures:{"0":{name:"entity.name.tag.declaration.xml"}},patterns:[{include:"#comment"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"}],name:"meta.tag.declaration.xml"}}});return{id:f[f.length-1].id,grammars:f,keywords:[]}});
define("orion/editor/stylers/text_html/syntax",["orion/editor/stylers/lib/syntax","orion/editor/stylers/application_javascript/syntax","orion/editor/stylers/text_css/syntax","orion/editor/stylers/text_x-php/syntax","orion/editor/stylers/application_xml/syntax"],function(f,m,q,b,l){f=f.grammars.concat(m.grammars).concat(q.grammars).concat(b.grammars).concat(l.grammars);f.push({id:"orion.html",contentTypes:["text/html"],patterns:[{include:"orion.xml"},{begin:"(?i)(<style)([^>]*)(>)",end:"(?i)(</style>)",
captures:{1:{name:"entity.name.tag.html"},3:{name:"entity.name.tag.html"}},contentName:"source.css.embedded.html",patterns:[{include:"orion.css"}]},{begin:"(?i)<script\\s*>|<script\\s.*?(?:language\\s*=\\s*(['\"])javascript\\1|type\\s*=\\s*(['\"])(?:text|application)/(?:javascript|ecmascript)\\2).*?>",end:"(?i)<\/script>",captures:{"0":{name:"entity.name.tag.html"}},contentName:"source.js.embedded.html",patterns:[{include:"orion.js"}]},{begin:"(?i)<script\\s.*?(?:language\\s*=\\s*(['\"])php\\1|type\\s*=\\s*(['\"])text/x-php\\2).*?>",
end:"(?i)<\/script>",captures:{"0":{name:"entity.name.tag.html"}},contentName:"source.php.embedded.html",patterns:[{include:"orion.php"}]},{begin:"(?i)<\\?(?:=|php)?(?:\\s|$)",end:"\\?>",captures:{"0":{name:"entity.name.declaration.php"}},contentName:"source.php.embedded.html",patterns:[{include:"orion.php"}]},{begin:"<%=?(?:\\s|$)",end:"%>",captures:{"0":{name:"entity.name.declaration.php"}},contentName:"source.php.embedded.html",patterns:[{include:"orion.php"}]}],repository:{xmlDeclaration:{}}});
return{id:f[f.length-1].id,grammars:f,keywords:[]}});
define("orion/editor/stylers/text_x-java-source/syntax",["orion/editor/stylers/lib/syntax"],function(f){var m="abstract boolean break byte case catch char class continue default do double else extends false final finally float for if implements import instanceof int interface long native new null package private protected public return short static super switch synchronized this throw throws transient true try void volatile while".split(" "),f=f.grammars;f.push({id:"orion.java",contentTypes:["text/x-java-source"],
patterns:[{include:"orion.lib#doc_block"},{include:"orion.c-like"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.control.java"}],repository:{string_singleQuote:{}}});return{id:f[f.length-1].id,grammars:f,keywords:m}});
define("orion/editor/stylers/application_json/syntax",["orion/editor/stylers/lib/syntax"],function(f){var m=["false","true"],f=f.grammars;f.push({id:"orion.json",contentTypes:["application/json"],patterns:[{include:"orion.lib"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.control.json"}]});return{id:f[f.length-1].id,grammars:f,keywords:m}});
define("orion/editor/stylers/text_x-python/syntax",["orion/editor/stylers/lib/syntax"],function(f){var m="and as assert break class continue def del exec elif else except Ellipsis False finally for from global if import in is lambda not None NotImplemented or pass print raise return try True while with yield".split(" "),f=f.grammars;f.push({id:"orion.python",contentTypes:["text/x-python"],patterns:[{include:"orion.lib"},{match:"#.*",name:"comment.line.number-sign.python",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},
{begin:"(['\"])\\1\\1",end:"\\1\\1\\1",name:"string.quoted.triple.python"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.control.python"}],repository:{number_decimal:{match:"\\b-?(?:\\.\\d+|\\d+\\.?\\d*)[lL]?\\b",name:"constant.numeric.number.python"}}});return{id:f[f.length-1].id,grammars:f,keywords:m}});
define("orion/editor/stylers/text_x-ruby/syntax",["orion/editor/stylers/lib/syntax"],function(f){var m="alias alias_method and attr_reader attr_writer attr_accessor attr BEGIN begin break case class catch def defined? do else elsif END end ensure extend false for if fail gem in include initialize load loop lambda module module_function new next nil not or public prepend private protected raise redo require require_relative rescue retry return self super then throw true undef unless until when while yield __ENCODING__ __END__ __FILE__ __LINE__".split(" "),f=
f.grammars;f.push({id:"orion.ruby",contentTypes:["text/x-ruby"],patterns:[{include:"orion.lib"},{match:"#.*",name:"comment.line.number-sign.ruby",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},{begin:"^=begin",end:"^=end",name:"comment.block.ruby",patterns:[{match:"(\\b)(TODO)(\\b)(((?!\\*/).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]},{match:"\\b0[bB][01]+\\b",name:"constant.numeric.binary.ruby"},{match:"\\b(?:"+
m.join("|")+")\\b",name:"keyword.control.ruby"}]});return{id:f[f.length-1].id,grammars:f,keywords:m}});
define("orion/widgets/browse/staticDataSource","orion/Deferred orion/editor/textStyler orion/editor/stylers/application_javascript/syntax orion/editor/stylers/text_css/syntax orion/editor/stylers/text_html/syntax orion/editor/stylers/text_x-java-source/syntax orion/editor/stylers/application_json/syntax orion/editor/stylers/text_x-php/syntax orion/editor/stylers/text_x-python/syntax orion/editor/stylers/text_x-ruby/syntax".split(" "),function(f,m,q,b,l,g,e,d,h,c){function a(){this.styler=null}a.prototype=
{setup:function(a,b,c){this.styler&&(this.styler.destroy&&this.styler.destroy(),this.styler=null);return this.highlight(a,b,c)},highlight:function(a,g,p){this.styler&&(this.styler.destroy(),this.styler=null);if(a)switch(a.id){case "application/javascript":this.styler=new m.TextStyler(g,p,q.grammars,"orion.js");break;case "text/css":this.styler=new m.TextStyler(g,p,b.grammars,"orion.css");break;case "text/html":this.styler=new m.TextStyler(g,p,l.grammars,"orion.html");break;case "text/x-java-source":this.styler=
new m.TextStyler(g,p,q.grammars,"orion.js");break;case "application/json":this.styler=new m.TextStyler(g,p,e.grammars,"orion.json");break;case "text/x-python":this.styler=new m.TextStyler(g,p,h.grammars,"orion.py");break;case "text/x-ruby":this.styler=new m.TextStyler(g,p,c.grammars,"orion.rb");break;case "text/x-php":this.styler=new m.TextStyler(g,p,d.grammars,"orion.php")}return(new f).resolve()},getStyler:function(){return this.styler}};return{ContentTypes:[{id:"text/plain",name:"Text",extension:["txt"],
imageClass:"file-sprite-text modelDecorationSprite"},{id:"application/javascript","extends":"text/plain",name:"JavaScript",extension:["js"],imageClass:"file-sprite-javascript modelDecorationSprite"},{id:"text/html","extends":"text/plain",name:"HTML",extension:["html","htm"],imageClass:"file-sprite-html modelDecorationSprite"},{id:"text/css","extends":"text/plain",name:"CSS",extension:["css"],imageClass:"file-sprite-css modelDecorationSprite"},{id:"application/json","extends":"text/plain",name:"JSON",
extension:["json"],imageClass:"file-sprite-text modelDecorationSprite"},{id:"application/xml","extends":"text/plain",name:"XML",extension:["xml"],imageClass:"file-sprite-xml"},{id:"text/x-java-source","extends":"text/plain",name:"Java",extension:["java"]},{id:"text/x-python","extends":"text/plain",name:"Python",extension:"py rpy pyw cpy SConstruct Sconstruct sconstruct SConscript gyp gypi".split(" ")},{id:"text/x-ruby","extends":"text/plain",name:"Ruby",extension:"rb rbx rjs Rakefile rake cgi fcgi gemspec irbrc capfile ru prawn Gemfile Guardfile Vagrantfile Appraisals Rantfile".split(" ")},
{id:"text/x-php","extends":"text/plain",name:"PHP",extension:"php php3 php4 php5 phpt phtml aw ctp".split(" ")},{id:"text/x-markdown","extends":"text/plain",name:"Markdown",extension:["md"]},{id:"text/x-yaml","extends":"text/plain",name:"YAML",extension:["yaml","yml"]},{id:"text/conf","extends":"text/plain",name:"Conf",extension:["conf"]},{id:"text/sh","extends":"text/plain",name:"sh",extension:["sh"]},{id:"image/gif",name:"GIF",extension:["gif"],imageClass:"file-sprite-image modelDecorationSprite"},
{id:"image/jpeg",name:"JPG",extension:["jpg","jpeg","jpe"],imageClass:"file-sprite-image modelDecorationSprite"},{id:"image/ico",name:"ICO",extension:["ico"],imageClass:"file-sprite-image modelDecorationSprite"},{id:"image/png",name:"PNG",extension:["png"],imageClass:"file-sprite-image modelDecorationSprite"},{id:"image/tiff",name:"TIFF",extension:["tif","tiff"],imageClass:"file-sprite-image modelDecorationSprite"},{id:"image/svg",name:"SVG",extension:["svg"],imageClass:"file-sprite-image modelDecorationSprite"}],
SyntaxHighlighter:a}});
define("orion/widgets/browse/emptyFileClient",["orion/Deferred"],function(f){function m(){}var q={Directory:!1,Length:1159,LocaltimeStamp:1389974936424,Location:"readme",Name:"README.md"},b={Directory:!1,Length:1159,LocaltimeStamp:1389974936424,Location:"readme",Name:"README.md",Parents:[]},l={Children:[q],ChildrenLocation:"children",Directory:!0,Length:0,LocaltimeStamp:1389974936424,Location:"root",Name:""};m.prototype={fileServiceName:function(){return"Empty"},fileServiceRootURL:function(){return""},fetchChildren:function(){return(new f).resolve([q])},
loadWorkspaces:function(){return(new f).resolve(l)},read:function(g,e){return e?(new f).resolve(b):(new f).resolve("The goal of Orion is to build developer tooling that works in the browser, at web scale.\nThe vision behind Orion is to move software development to the web as a web experience, by\nenabling open tool integration through HTTP and REST, JSON, OAuth, OpenID, and others.\nThe idea is to exploit internet design principles throughout, instead of trying to bring\nexisting desktop IDE concepts to the browser. See the [Orion wiki](http://wiki.eclipse.org/Orion) for more\ninformation about Orion.\n\nContributing\n------------\n\nOrion source code is available in an Eclipse Git repository, and there is also a mirror\non GitHub. For complete details on getting the source and getting setup to develop Orion,\nsee the [Orion wiki](http://wiki.eclipse.org/Orion/Getting_the_source).\n\nBug reports and patches are welcome in [bugzilla](https://bugs.eclipse.org/bugs/enter_bug.cgi?product=Orion).\n\nLicense\n-------\n\nThis repository contains the Orion client and Node-based server. This source code is available\nunder the [Eclipse Public License](http://www.eclipse.org/legal/epl-v10.html)\nand [Eclipse Distribution License](http://www.eclipse.org/org/documents/edl-v10.php).\n")},
loadWorkspace:function(){return(new f).resolve(l)}};m.prototype.constructor=m;return{FileClient:m}});define("text!orion/widgets/browse/repoUrlTrigger.html",[],function(){return'<div id="orion.browse.repoURLTrigger" class="repoUrlLink"><span>Git URL</span></div>\r\n<div id="orion.browse.repoURLDropdown" class="dropdownMenu repoUrlDropdown">\r\n\t<div class="repoUrlHeader">\r\n\t\t<div class="repoUrlHeaderClose  core-sprite-close imageSprite" id="orion.browse.repoURLClose"></div>\r\n\t\t<span class="repoUrlHeaderTitle" id="orion.browse.repoURLTitle">Git URL</span>\r\n\t</div>\r\n\t<input id="orion.browse.repoURLInput" class = "repoUrlInput dropdownSubMenu" type="text" readonly></input>\r\n</div>'});
define("text!orion/widgets/browse/repoAndBaseUrlTrigger.html",[],function(){return'<div id="orion.browse.repoURLTrigger" class="repoUrlLink"><span>Team Invitation</span></div>\r\n<div id="orion.browse.repoURLDropdown" class="dropdownMenu repoUrlDropdown">\r\n\t<div class="repoUrlHeader">\r\n\t\t<div class="repoUrlHeaderClose  core-sprite-close imageSprite" id="orion.browse.repoURLClose"></div>\r\n\t\t<span class="repoUrlHeaderTitle" id="orion.browse.repoURLTitle">Copy the invitation below</span>\r\n\t</div>\r\n\t<textarea id="orion.browse.repoURLInput" class="repoAndBaseUrlInput dropdownSubMenu" type="text" readonly></textarea>\r\n</div>'});
define("orion/widgets/browse/fileBrowser","orion/PageUtil orion/inputManager orion/breadcrumbs orion/widgets/browse/browseView orion/explorers/navigatorRenderer orion/widgets/browse/readonlyEditorView orion/widgets/browse/resourceSelector orion/markdownView orion/commandRegistry orion/fileClient orion/contentTypes orion/widgets/browse/staticDataSource orion/widgets/browse/emptyFileClient orion/Deferred orion/URITemplate orion/objects orion/EventTarget text!orion/widgets/browse/repoUrlTrigger.html text!orion/widgets/browse/repoAndBaseUrlTrigger.html orion/commands orion/webui/littlelib orion/URL-shim".split(" "),
function(f,m,q,b,l,g,e,d,h,c,a,k,n,p,u,s,w,y,x,v,z){function r(){w.attach(this)}function t(a){this.fileBrowser=a}function A(a,b){this.repoURL=a;if(this.baseURL=b){this.RepoURLTriggerTemplate=x;var c=this.repoURL.match(/\/([^\/]+)\/([^\/]+)$/);this.promptValue=c?"teamRepository="+this.baseURL+"\nuserId="+decodeURIComponent(c[1])+"\nuserName="+decodeURIComponent(c[1])+"\nprojectAreaName="+decodeURIComponent(c[1])+" | "+decodeURIComponent(c[2]):this.baseURL}else this.RepoURLTriggerTemplate=y,this.promptValue=
this.repoURL}function D(b){this._parentDomNode=z.node(b.parent);this._parentDomNode.classList.add("browserParentDome");b.fileClient?this._fileClient=b.fileClient:b.serviceRegistry?this._fileClient=new c.FileClient(b.serviceRegistry):b.init||(this._fileClient=new n.FileClient);this.repoURL=b.repoURL;this.baseURL=b.baseURL;this.codeURL=b.codeURL;this._syntaxHighlighter=b.syntaxHighlighter;this._syntaxHighlighter||(this._syntaxHighlighter=new k.SyntaxHighlighter);this._contentTypeService=b.contentTypeService;
this._contentTypeService||(this._contentTypeService=new a.ContentTypeRegistry(k.ContentTypes));this._preferences=b.preferences;this.rootName=b.rootName;this.shouldLoadWorkSpace=b.shouldLoadWorkSpace;"number"===typeof b.selectorNumber&&(1<=b.selectorNumber&&(this._showBranch=!0),2<=b.selectorNumber&&(this._showComponent=!0));this._breadCrumbInHeader=b.breadCrumbInHeader;this._resourceChangeHandler=new r(b.repo);this._resourceChangeHandler.addEventListener("resourceChanged",function(a){if(this._componentSelector&&
a&&a.newResource&&a.newResource.selectorAllItems){this._componentSelector.allItems=a.newResource.selectorAllItems;var b=a.defaultChild;b||(a.newResource.selectorAllItems.some(function(a){if(a.Directory)return b=a.Location,!0}),a.changeHash?window.location=(new u("#{,resource,params*}")).expand({resource:b}):this.refresh((new u("{,resource}")).expand({resource:b})));this._componentSelector.activeResourceName=this._componentSelector.getActiveResource(b).Name;this._componentSelector.refresh()}}.bind(this));
this._init(b)}s.mixin(t.prototype,{setProgressResult:function(a){this.fileBrowser._currentEditorView&&this.fileBrowser._currentEditorView.messageView?this.fileBrowser._currentEditorView.updateMessageContents(a.Message,["messageViewTable"],"errorMessageViewTable"):this.fileBrowser._switchView(new b.BrowseView({parent:this.fileBrowser._parentDomNode,messageView:{message:a.Message,classes:["messageViewTable"],tdClass:"errorMessageViewTable"}}))}});s.mixin(D.prototype,{_init:function(a){this._commandRegistry=
new h.CommandRegistry({});this._maxEditorLines=a.maxEditorLines;a={parent:this._parentDomNode,messageView:{message:"Loading..."}};this._statusService=new t(this);this._switchView(new b.BrowseView(a));this._uriTemplate=new u("#{,resource,params*}");window.addEventListener("hashchange",function(){this.refresh(f.hash())}.bind(this));this._fileClient&&this.startup()},_registerCommands:function(){var a=new v.Command({imageClass:"core-sprite-edit",id:"orion.browse.gotoEdit",visibleWhen:function(){return!0},
hrefCallback:function(){return this.codeURL?this.codeURL:(new URL("code",window.location.href)).href}.bind(this)});this._commandRegistry.addCommand(a);this._commandRegistry.registerCommandContribution("orion.browse.sectionActions","orion.browse.gotoEdit",1)},startup:function(a){a&&(this._fileClient=new c.FileClient(a));this.repoURL&&(this.repoURLHandler=new A(this.repoURL,this.baseURL));this._registerCommands();this._inputManager=new m.InputManager({fileClient:this._fileClient,statusReporter:this._statusReport,
statusService:this._statusService,contentTypeRegistry:this._contentTypeService});this.shouldLoadWorkSpace||(this._inputManager._maybeLoadWorkspace=function(a){return(new p).resolve(a)});this._inputManager.addEventListener("InputChanged",function(a){if(a.metadata&&a.input){var b=a.metadata;if(this._branches&&this._branchSelector){var c=this._branches[0].Name;this._activeBranchLocation=this._branches[0].Location;var d=this._activeComponentLocation=null;b.Parents?0<b.Parents.length?(c=b.Parents[b.Parents.length-
1].Name,this._activeBranchLocation=b.Parents[b.Parents.length-1].Location,this._activeComponentLocation=1<b.Parents.length?b.Parents[b.Parents.length-2].Location:b.Location):(c=b.Name,this._activeBranchLocation=b.Location):(this._branches.some(function(a){if("master"===a.Name.toLowerCase())return c=a.Name,d=this._activeBranchLocation=a.Location,!0}.bind(this)),d=d||this._branches[0].Location,this._activeBranchLocation=this._activeBranchLocation||this._branches[0].Location);this._branchSelector.activeResourceName=
c;if(this._showComponent){if(this._branchSelector.setActiveResource({resource:this._branchSelector.getActiveResource(this._activeBranchLocation),changeHash:b.Parents,defaultChild:this._activeComponentLocation}),!this._activeComponentLocation)return}else if(d){this.refresh((new u("{,resource}")).expand({resource:d}));return}}this._breadCrumbName=a.name;this._breadCrumbTarget=b;if(null===a.input||void 0===a.input)this._breadCrumbName=this._lastRoot?this._lastRoot.Name:"",this._breadCrumbTarget=this._lastRoot;
b=this._getEditorView(a.input,a.contents,b);this._setEditor(b?b.editor:null);a.editor=this._editor}}.bind(this));a={parent:document.createElement("div"),syntaxHighlighter:this._syntaxHighlighter,inputManager:this._inputManager,preferences:this._preferences,statusReporter:function(a,b,c){this._statusReport(a,b,c)}.bind(this)};this._editorView=new g.ReadonlyEditorView(a);if(this._showBranch){var b=document.createElement("div");b.classList.add("resourceSelectorContainer");a=this._fileClient.fileServiceRootURL("");
this._fileClient.fetchChildren(a).then(function(a){if(a&&0<a.length&&(this._branches=a,this._branchSelector=new e.ResourceSelector({commandRegistry:this._commandRegistry,fileClient:this._fileClient,parentNode:b,labelHeader:this._showComponent?"Stream":"Branch",resourceChangeDispatcher:this._showComponent?this._resourceChangeHandler:null,fetchChildren:this._showComponent?!0:!1,commandScopeId:"orion.browse.brSelector",dropDownId:"orion.browse.switchbr",dropDownTooltip:this._showComponent?"Select a stream":
"Select a branch",activeResourceName:"default",allItems:a}),this._showComponent)){var c=document.createElement("div");c.classList.add("resourceSelectorContainer");c.classList.add("componentSelectorContainer");this._componentSelector=new e.ResourceSelector({commandRegistry:this._commandRegistry,fileClient:this._fileClient,parentNode:c,labelHeader:"Component",commandScopeId:"orion.browse.compSelector",dropDownId:"orion.browse.switchcomp",dropDownTooltip:"Select a componet",activeResourceName:"default",
allItems:a})}this.refresh(f.hash())}.bind(this))}else this.refresh(f.hash())},_switchView:function(a){this._currentEditorView!==a&&(this._currentEditorView&&this._currentEditorView.destroy(),(this._currentEditorView=a)&&this._currentEditorView.create());return this._currentEditorView},_breadCrumbMaker:function(a,b){this._renderBreadCrumb({task:"Browse",name:this._breadCrumbName,target:this._breadCrumbTarget,breadCrumbContainer:a,makeBreadcrumbLink:function(a,b,c){this._makeBreadCrumbLink(a,b,c)}.bind(this),
makeBreadcrumFinalLink:!1,fileClient:this._fileClient,maxLength:b})},_setEditor:function(a){this._editor!==a&&(this._editor=a)},_statusReport:function(){},_makeBreadCrumbLink:function(a,b,c){(c=c?c.Location:null)||(c=b?b:this._fileClient.fileServiceRootURL(b));a.href=this._uriTemplate.expand({resource:c})},_renderBreadCrumb:function(a){var b=a.breadcrumbRootName,c=a.fileClient;a.target?c&&!a.breadcrumbTarget&&(c.fileServiceName(a.target.Location),b=null):a.breadcrumbTarget||(b=b||a.task||a.name);
var d=z.node(a.breadCrumbContainer);if(d){z.empty(d);var e=a.breadcrumbTarget||a.target;this._componentSelector?e.Parents&&(1===e.Parents.length?(e.Parents[e.Parents.length-1].skip=!0,e.skip=!0):1<e.Parents.length&&(e.Parents[e.Parents.length-1].skip=!0,e.Parents[e.Parents.length-2].skip=!0)):this._branchSelector&&e.Parents&&(0<e.Parents.length?e.Parents[e.Parents.length-1].skip=!0:e.skip=!0);c=c&&e&&e.Location?c.fileServiceRootURL(e.Location):null;new q.BreadCrumbs({container:d,maxLength:a.maxLength,
resource:e,rootSegmentName:b,workspaceRootSegmentName:this.rootName?this.rootName:c,workspaceRootURL:this._calculateRootURL(c),makeFinalHref:a.makeBreadcrumFinalLink,makeHref:a.makeBreadcrumbLink})}},_calculateRootURL:function(a){return this._activeComponentLocation&&this._componentSelector?this._activeComponentLocation:this._activeBranchLocation&&this._branchSelector?this._activeBranchLocation:a},_getEditorView:function(a,c,d){var e=null;d&&a&&(a={parent:this._parentDomNode,maxEditorLines:this._maxEditorLines,
breadCrumbInHeader:this._breadCrumbInHeader,metadata:d,branchSelector:this._branchSelector,componentSelector:this._componentSelector,commandRegistry:this._commandRegistry,contentTypeRegistry:this._contentTypeService,inputManager:this._inputManager,repoURLHandler:this.repoURLHandler,fileService:this._fileClient,breadCrumbMaker:function(a,b){this._breadCrumbMaker(a,b)}.bind(this)},d.Directory||((d=this._contentTypeService.getFileContentType(d))?"text/x-markdown"===d.id?a.isMarkdownView=!0:l.isImage(d)?
(c=URL.createObjectURL(new Blob([c],{type:d.id})),d=document.createElement("img"),d.src=c,d.classList.add("readonlyImage"),a.imageView={image:d}):a.editorView=this._editorView:a.editorView=this._editorView),e=new b.BrowseView(a));return this._switchView(e)},refresh:function(a){a||(a=(new u("{,resource}")).expand({resource:this._fileClient.fileServiceRootURL("")}));this._inputManager.setInput(a)},create:function(){},destroy:function(){}});return{FileBrowser:D}});
define("orion/serviceregistry",["orion/Deferred","orion/EventTarget"],function(f,m){function q(b,e,c){this._properties=c||{};this._properties["service.id"]=b;this._properties.objectClass=e;this._properties["service.names"]=e}function b(b,e,c){this._serviceId=b;this._serviceReference=e;this._internalRegistry=c}function l(b,e){function c(a){return function(){var c;try{if(!e())throw Error("Service was unregistered");var g=b[a].apply(b,Array.prototype.slice.call(arguments));if(g&&"function"===typeof g.then)return g;
c=new f;c.resolve(g)}catch(l){c=new f,c.reject(l)}return c.promise}}for(var a in b)"function"===typeof b[a]&&(this[a]=c(a))}function g(b,e){this.type=b;this.serviceReference=e}function e(){this._entries=[];this._namedReferences={};this._serviceEventTarget=new m;var b=this;this._internalRegistry={isRegistered:function(e){return b._entries[e]?!0:!1},unregisterService:function(e){var c=b._entries[e];if(!c)throw Error("Service has already been unregistered: "+e);var a=c.reference;b._serviceEventTarget.dispatchEvent(new g("unregistering",
a));b._entries[e]=null;a.getProperty("objectClass").forEach(function(c){for(var e=b._namedReferences[c],f=0;f<e.length;f++)if(e[f]===a){1===e.length?delete b._namedReferences[c]:e.splice(f,1);break}})},modifyService:function(e){var c=b._entries[e];if(!c)throw Error("Service not found while trying to send modified event: "+e);b._serviceEventTarget.dispatchEvent(new g("modified",c.reference))}}}q.prototype={getPropertyKeys:function(){var b=[],e;for(e in this._properties)this._properties.hasOwnProperty(e)&&
b.push(e);return b},getProperty:function(b){return this._properties[b]}};q.prototype.constructor=q;b.prototype={unregister:function(){this._internalRegistry.unregisterService(this._serviceId)},getReference:function(){if(!this._internalRegistry.isRegistered(this._serviceId))throw Error("Service has already been unregistered: "+this._serviceId);return this._serviceReference},setProperties:function(b){var e=this._serviceReference._properties;this._serviceReference._properties=b||{};b["service.id"]=this._serviceId;
b.objectClass=e.objectClass;b["service.names"]=e["service.names"];this._internalRegistry.modifyService(this._serviceId)}};b.prototype.constructor=b;e.prototype={getService:function(b){var e;if("string"===typeof b)(b=this._namedReferences[b])&&b.some(function(b){e=this._entries[b.getProperty("service.id")].service;return!!e},this);else if(b=this._entries[b.getProperty("service.id")])e=b.service;return e||null},getServiceReferences:function(b){if(b)return this._namedReferences[b]?this._namedReferences[b]:
[];var e=[];this._entries.forEach(function(b){b&&e.push(b.reference)});return e},registerService:function(d,e,c){if("undefined"===typeof e||null===e)throw Error("invalid service");"string"===typeof d?d=[d]:Array.isArray(d)||(d=[]);var a=this._entries.length,f=new q(a,d,c),m=this._namedReferences;d.forEach(function(a){m[a]=m[a]||[];m[a].push(f)});d=new l(e,this._internalRegistry.isRegistered.bind(null,a));this._entries.push({reference:f,service:d});d=this._internalRegistry;this._serviceEventTarget.dispatchEvent(new g("registered",
f));return new b(a,f,d)},addEventListener:function(b,e){this._serviceEventTarget.addEventListener(b,e)},removeEventListener:function(b,e){this._serviceEventTarget.removeEventListener(b,e)}};e.prototype.constructor=e;return{ServiceRegistry:e}});
define("orion/pluginregistry",["orion/Deferred","orion/EventTarget","orion/URL-shim"],function(f,m){function q(a,b){var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;c.sort();d.sort();for(var e=0,f=c.length;e<f;e++){var g=c[e];if(g!==d[e])return!1;var h=a[g],g=b[g];if(h!==g&&JSON.stringify(h)!==JSON.stringify(g))return!1}return!0}function b(a){if(-1===a.indexOf("://"))try{return(new URL(a,location.href)).href}catch(b){}return a}function l(a,b){if(b&&b instanceof XMLHttpRequest){var c,
d;try{c=b.status,d=b.statusText}catch(e){c=0,d=""}return{status:c||0,statusText:d}}return b}function g(a){var b=a?JSON.parse(JSON.stringify(a,l)):a;a instanceof Error&&(b.__isError=!0,b.message=b.message||a.message,b.name=b.name||a.name);return b}function e(a,b){this.type=a;this.plugin=b}function d(a,b){this.__objectId=a;this.__methods=b}function h(a,b,c){function h(a){I&&c.postMessage(a,I)}function l(a){if(!I)return(new f).reject(Error("plugin not connected"));a.id=String(O++);var b=new f;S[a.id]=
b;b.then(null,function(b){"active"===B&&(b instanceof Error&&"Cancel"===b.name)&&h({requestId:a.id,method:"cancel",params:b.message?[b.message]:[]})});var e=Object.prototype.toString;a.params.forEach(function(c,f){if("[object Object]"===e.call(c)&&!(c instanceof d)){var g,h;for(g in c)"[object Function]"===e.call(c[g])&&(h=h||[],h.push(g));if(h){var k=Q++;T[k]=c;g=function(){delete T[k]};b.then(g,g);a.params[f]=new d(k,h)}}});c.postMessage(a,I);return b.promise}function s(a,b){a||0===a?h({id:a,result:null,
error:b}):console.log(b)}function w(a,b,c,d){d.forEach(function(a,b){if(a&&"undefined"!==typeof a.__objectId){var c={};a.__methods.forEach(function(b){c[b]=function(){return l({objectId:a.__objectId,method:b,params:Array.prototype.slice.call(arguments)})}});d[b]=c}});var e=void 0===typeof a?null:{id:a,result:null,error:null};try{var f=c.apply(b,d);e&&(f&&"function"===typeof f.then?(N[a]=f,f.then(function(b){delete N[a];e.result=b;h(e)},function(b){N[a]&&(delete N[a],e.error=g(b),h(e))},function(){h({responseId:a,
method:"progress",params:Array.prototype.slice.call(arguments)})})):(e.result=f,h(e)))}catch(k){e&&(e.error=g(k),h(e))}}function y(a){try{if(a.method){var b=a.method,d=a.params||[];if("serviceId"in a){var e=Y[a.serviceId];e||s(a.id,"service not found");b in e?w(a.id,e,e[b],d):s(a.id,"method not found")}else if("objectId"in a){var f=T[a.objectId];f||s(a.id,"object not found");b in f?w(a.id,f,f[b],d):s(a.id,"method not found")}else if("requestId"in a){var g=N[a.requestId];g&&("cancel"===b&&g.cancel)&&
g.cancel.apply(g,d)}else if("responseId"in a){var h=S[a.responseId];h&&("progress"===b&&h.progress)&&h.progress.apply(h,d)}else if("plugin"===a.method){var k=a.params[0];U({headers:k.headers,services:k.services}).then(function(){M&&M.resolve(r)})}else if("timeout"===a.method)M&&M.reject(a.error);else throw Error("Bad method: "+a.method);}else{var l=S[String(a.id)];delete S[String(a.id)];if(a.error){var m=c.handleServiceError(r,a.error);l.reject(m)}else l.resolve(a.result)}}catch(p){console.log("Plugin._messageHandler "+
p)}}function x(b){var c=JSON.parse(JSON.stringify(b.properties));c.__plugin__=a;b=b.names||b.type||[];Array.isArray(b)||(b=[b]);c.objectClass=b;return c}function v(a){var b={};if(a.methods&&(a.methods.forEach(function(c){b[c]=function(){var b={serviceId:a.serviceId,method:c,params:Array.prototype.slice.call(arguments)};return"active"===B?l(b):r.start({"transient":!0}).then(function(){return l(b)})}}),b.addEventListener&&b.removeEventListener)){var e=new m,f=Q++;T[f]={handleEvent:e.dispatchEvent.bind(e)};
var g=new d(f,["handleEvent"]),h=b.addEventListener;b.addEventListener=function(a,b){e._namedListeners[a]||h(a,g);e.addEventListener(a,b)};var k=b.removeEventListener;b.removeEventListener=function(a,b){e.removeEventListener(a,b);e._namedListeners[a]||k(a,g)}}f=x(a);f=c.registerService(a.names||a.type,b,f);E[a.serviceId]={registration:f,proxy:b}}function z(){c.persist(a,{created:t,headers:A,services:D,autostart:C,lastModified:H})}var r=this,b=b||{},t=b.created||(new Date).getTime(),A=b.headers||{},
D=b.services||[],C=b.autostart,H=b.lastModified||0,B="installed",J,M,I,R,E={},O=0,Q=0,N={},S={},T={},Y={},U;this._persist=z;this._resolve=function(){B="resolved";c.dispatchEvent(new e("resolved",r))};this._getAutostart=function(){return C};this._getCreated=function(){return t};this.getLocation=function(){return a};this.getHeaders=function(){return JSON.parse(JSON.stringify(A))};this.getName=function(){var a=this.getHeaders();return a?a.name||"":null};this.getVersion=function(){var a=this.getHeaders();
return a?a.version||"0.0.0":null};this.getLastModified=function(){return H};this.getServiceReferences=function(){var a=[];Object.keys(E).forEach(function(b){a.push(E[b].registration.getReference())});return a};this.setParent=function(a){return R!==a?(R=a,r.stop({"transient":!0}).then(function(){if("started"===C)return r.start({"transient":!0});if("lazy"===C)return r.start({lazy:!0,"transient":!0})})):(new f).resolve()};this.getState=function(){return B};this.start=function(b){if("uninstalled"===B)return(new f).reject(Error("Plugin is uninstalled"));
if(J)return J.promise.then(this.start.bind(this,b));if("active"===B)return(new f).resolve();if(!b||!b.transient){var d=b&&b.lazy?"lazy":"started";d!==C&&(C=d,z())}d=c.getState();if("starting"!==d&&"active"!==d)return b.transient?(new f).reject(Error("start transient error")):(new f).resolve();if("installed"===B)try{this._resolve()}catch(g){return(new f).reject(g)}"resolved"===B&&D.forEach(function(a){v(a)});if(b&&b.lazy)return"starting"!==B&&(B="starting",c.dispatchEvent(new e("lazy activation",r))),
(new f).resolve();var h=new f;J=h;B="starting";c.dispatchEvent(new e("starting",r));M=new f;I=c.connect(a,y,R);M.then(function(){M=null;B="active";c.dispatchEvent(new e("started",r));J=null;h.resolve()},function(){M=null;B="stopping";c.dispatchEvent(new e("stopping",r));Object.keys(E).forEach(function(a){E[a].registration.unregister();delete E[a]});c.disconnect(I);I=null;B="resolved";J=null;c.dispatchEvent(new e("stopped",r));h.reject(Error("plugin activation error"))});return h.promise};this.stop=
function(a){if("uninstalled"===B)return(new f).reject(Error("Plugin is uninstalled"));if(J)return J.promise.then(this.stop.bind(this,a));if((!a||!a.transient)&&"stopped"!==C)C="stopped",z();if("active"!==B&&"starting"!==B)return(new f).resolve();J=a=new f;B="stopping";c.dispatchEvent(new e("stopping",r));Object.keys(E).forEach(function(a){E[a].registration.unregister();delete E[a]});I&&(c.disconnect(I),I=null);B="resolved";J=null;c.dispatchEvent(new e("stopped",r));a.resolve();return a.promise};U=
function(b){if("uninstalled"===B)return(new f).reject(Error("Plugin is uninstalled"));if(!b)return 0===H&&(H=(new Date).getTime(),z()),c.loadManifest(a).then(U);var d=A,g=D,h=C;A=b.headers||{};D=b.services||{};C=b.autostart||C;b.lastModified?H=b.lastModified:(H=(new Date).getTime(),z());if(q(A,d)&&q(D,g)&&C===h)return(new f).resolve();if("active"===B||"starting"===B){var k=[];Object.keys(D).forEach(function(a){var b=D[a];k.push(a);var c=E[a];if(c){if(q(b.methods,Object.keys(c.proxy))){var a=x(b),
d=c.registration.getReference(),e={};d.getPropertyKeys().forEach(function(a){e[a]=d.getProperty(a)});q(a,e)||c.registration.setProperties(a);return}c.registration.unregister();delete E[a]}v(b)});Object.keys(E).forEach(function(a){-1===k.indexOf(a)&&(E[a].registration.unregister(),delete E[a])})}"active"===B&&(c.disconnect(I),M=new f,I=c.connect(a,y,R),M.then(function(){M=null},function(){M=null;B="stopping";c.dispatchEvent(new e("stopping"),r);Object.keys(E).forEach(function(a){E[a].registration.unregister();
delete E[a]});c.disconnect(I);I=null;B="resolved";c.dispatchEvent(new e("stopped",r))}));return(new f).resolve()};this.update=function(a){return U(a).then(function(){c.dispatchEvent(new e("updated",r))})};this.uninstall=function(){if("uninstalled"===B)return(new f).reject(Error("Plugin is uninstalled"));if("active"===B||"starting"===B||"stopping"===B)return this.stop().then(this.uninstall.bind(this),this.uninstall.bind(this));c.removePlugin(this);B="uninstalled";c.dispatchEvent(new e("uninstalled",
r));return(new f).resolve()}}var c=/^http[s]?/i;return{Plugin:h,PluginRegistry:function(a,d){function g(a){var b=a.source;z.some(function(c){if(b===c.target){try{var d;if("undefined"===typeof c.useStructuredClone){var e="string"!==typeof a.data;d=e?a.data:JSON.parse(a.data);c.useStructuredClone=e}else d=c.useStructuredClone?a.data:JSON.parse(a.data);c.handler(d)}catch(f){}return!0}})}var d=d||{},l=d.storage||localStorage;if(!l.getItem){var q=l,s=null,w={key:function(a){return(s=s||Object.keys(q))[a]},
getItem:function(a){return q[a]},setItem:function(a,b){q[a]=b;s=null},removeItem:function(a){delete q[a];s=null},clear:function(){(s=s||Object.keys(q)).forEach(function(a){delete q[a]}.bind(this));s=null}};Object.defineProperty(w,"length",{get:function(){return(s=s||Object.keys(q)).length}});l=w}var y="installed",x,v=[],z=[],r=new m,t={},A={registerService:a.registerService.bind(a),connect:function(a,b,c,d){function e(a){a=Error(a);a.name="timeout";b({method:"timeout",error:a})}var f={handler:b,url:a},
g=setTimeout(e.bind(null,"Load timeout for: "+a),d||15E3),h=document.createElement("iframe");h.name=a+"_"+(new Date).getTime();h.src=a;h.onload=function(){clearTimeout(g);g=setTimeout(e.bind(null,"Plugin handshake timeout for: "+a),5E3)};h.sandbox="allow-scripts allow-same-origin";h.style.width=h.style.height="100%";h.frameBorder=0;(c||x).appendChild(h);f.target=h.contentWindow;f.close=function(){clearTimeout(g);if(h){var a=h.parentNode;a&&a.removeChild(h);h=null}};z.push(f);return f},disconnect:function(a){for(var b=
0;b<z.length;b++)if(a===z[b]){z.splice(b,1);try{a.close()}catch(c){}break}},removePlugin:function(a){for(var b=0;b<v.length;b++)if(a===v[b]){v.splice(b,1);break}l.removeItem("plugin."+a.getLocation())},persist:function(a,b){l.setItem("plugin."+a,JSON.stringify(b))},postMessage:function(a,b){b.target.postMessage(b.useStructuredClone?a:JSON.stringify(a),b.url)},dispatchEvent:function(a){try{r.dispatchEvent(a)}catch(b){console&&console.log("PluginRegistry.dispatchEvent "+b)}},loadManifest:function(a){var b=
new f,c=A.connect(a,function(a){c&&a.method&&("manifest"===a.method||"plugin"===a.method?(a=a.params[0],A.disconnect(c),c=null,b.resolve(a)):"timeout"===a.method&&(A.disconnect(c),c=null,b.reject(a.error)))});return b.promise},getState:function(){return y},handleServiceError:function(a,b){if(b&&401===b.status){var d=a.getHeaders(),e=a.getName()||a.getLocation(),f=document.createElement("span");f.appendChild(document.createTextNode("Authentication required for: "+e+"."));d.login&&(f.appendChild(document.createTextNode(" ")),
e=document.createElement("a"),e.target="_blank",e.textContent="Login",e.href=d.login,c.test(e.href)?(f.appendChild(e),f.appendChild(document.createTextNode(" and re-try the request."))):console.log("Illegal Login URL: "+d.login));return{Severity:"Error",HTML:!0,Message:(new XMLSerializer).serializeToString(f)}}if(b.__isError){var g=b,b=Error(g.message);Object.keys(g).forEach(function(a){b[a]=g[a]});delete b.__isError}return b}};this.getLocation=function(){return"System"};this.getHeaders=function(){return{}};
this.getName=function(){return"System"};this.getVersion=function(){return"0.0.0"};this.getLastModified=function(){return 0};this.getState=A.getState;this.init=function(){if(!("starting"===y||"active"===y||"stopping"===y)){addEventListener("message",g,!1);for(var a=[],c=0,e=l.length;c<e;c++)a.push(l.key(c));a.forEach(function(a){if(0===a.indexOf("plugin.")){var b=a.substring(7),a=JSON.parse(l.getItem(a));a.created&&v.push(new h(b,a,A))}});v.sort(function(a,b){return a._getCreated()<b._getCreated()?
-1:1});d.parent?x=d.parent:(x=document.createElement("div"),d.visible||(x.style.display="none",x.style.visibility="hidden"),document.body.appendChild(x));d.plugins&&Object.keys(d.plugins).forEach(function(a){a=b(a);if(!this.getPlugin(a)){var c=d.plugins[a];"object"!==typeof c&&(c={});c.autostart=c.autostart||d.defaultAutostart||"lazy";v.push(new h(a,c,A))}}.bind(this));y="starting"}};this.start=function(){"starting"!==y&&this.init();if("starting"!==y)return(new f).reject("Cannot start framework. Framework is already "+
y+".");var a=[],b=(new Date).getTime();v.forEach(function(c){var d=c._getAutostart();0===c.getLastModified()?a.push(c.update().then(function(){if("started"===d)return c.start({"transient":!0});if("lazy"===d)return c.start({lazy:!0,"transient":!0});c._resolve()})):"started"===d?a.push(c.start({"transient":!0})):"lazy"===d?(a.push(c.start({lazy:!0,"transient":!0})),b>c.getLastModified()+864E5&&c.update()):c._resolve()});return f.all(a,function(a){console.log("PluginRegistry.stop "+a)}).then(function(){y=
"active"})};this.stop=function(){if("starting"!==y&&"active"!==y)return(new f).reject("Cannot stop registry. Registry is already "+y+".");y="stopping";var a=[];v.forEach(function(b){a.push(b.stop({"transient":!0}))});return f.all(a,function(a){console.log("PluginRegistry.stop "+a)}).then(function(){if(!d.parent){var a=x.parentNode;a&&a.removeChild(x)}x=null;removeEventListener("message",g);y="resolved"})};this.update=function(){this.stop().then(this.start.bind(this))};this.uninstall=function(){return(new f).reject("Cannot uninstall registry")};
this.installPlugin=function(a,c){var a=b(a),d=this.getPlugin(a);if(d)return(new f).resolve(d);if(t[a])return t[a];if(c)return d=new h(a,c,A),v.push(d),d._persist(),A.dispatchEvent(new e("installed",d)),(new f).resolve(d);var g=A.loadManifest(a).then(function(b){d=new h(a,b,A);v.push(d);d._persist();delete t[a];A.dispatchEvent(new e("installed",d));return d},function(b){delete t[a];throw b;});return t[a]=g};this.getPlugins=function(){return v.slice()};this.getPlugin=function(a){var c=null,a=b(a);v.some(function(b){if(a===
b.getLocation())return c=b,!0});return c};this.addEventListener=r.addEventListener.bind(r);this.removeEventListener=r.removeEventListener.bind(r);this.resolvePlugins=function(){var a=!0;v.forEach(function(b){a=a&&b._resolve()});return a}}}});var _browser_script_source=null,_all_script=document.getElementsByTagName("script");
if(_all_script&&_all_script.length&&0<_all_script.length){for(var j=0;2>j;j++){for(var i=0;i<_all_script.length;i++)if(0===j){if("orion.browse.browser"===_all_script[i].id){_browser_script_source=_all_script[i].src;break}}else{var regex=/.*built-browse.*.js/;if(_all_script[i].src&&regex.exec(_all_script[i].src)){_browser_script_source=_all_script[i].src;break}}if(_browser_script_source)break}_browser_script_source||(_browser_script_source=_all_script[_all_script.length-1].src)}
define("browse/builder/browse",["orion/widgets/browse/fileBrowser","orion/serviceregistry","orion/pluginregistry","orion/URL-shim"],function(f,m,q){function b(b){"string"===typeof b?(b={parentId:arguments[0],repo:arguments[1]},2<arguments.length&&(b.base=arguments[2]),3<arguments.length&&(b.codeURL=arguments[3])):b=b||{};var g,e=new URL(b.repo||window.location.href),d=e.href,h=b.base,c=1;if(!b.rootName&&(g=d.match(/\/([^/]+)\/([^/]+)$/)))b.rootName=decodeURIComponent(g[1])+" | "+decodeURIComponent(g[2]),
b.rootName.match(/\.git$/)&&(b.rootName=b.rootName.substring(0,b.rootName.length-4));if("github.com"===e.host)g=new URL("../../plugins/GitHubFilePlugin.html?repo="+e.href,_browser_script_source);else if(0===e.pathname.indexOf("/git/"))g=new URL("/gerrit/plugins/gerritFilesystem/static/plugins/GerritFilePlugin.html",e),g.query.set("project",e.pathname.substring(5));else if(0===e.pathname.indexOf("/ccm"))h||(h=e.pathname.match(/^\/ccm[^/]*/),h=(new URL(h,d)).href),g=new URL(h+"/service/com.ibm.team.filesystem.service.jazzhub.IOrionFilesystem/sr/pluginOrionWs.html?"+
d),c=2;else if(0===e.pathname.indexOf("/project/"))h||(h=(new URL("/ccm01",d)).href),g=new URL(h+"/service/com.ibm.team.filesystem.service.jazzhub.IOrionFilesystem/sr/pluginOrionWs.html?"+d),c=2;else throw"Bad Repo URL - "+d;var a=new m.ServiceRegistry,e={};e[g.href]={autostart:"started",lastModified:-1};this._fileBrowser=new f.FileBrowser({parent:b.parentId,repoURL:d,baseURL:2===c?h:null,codeURL:b.codeURL,selectorNumber:c,rootName:b.rootName,maxEditorLines:300,init:!0});(new q.PluginRegistry(a,{storage:{},
plugins:e})).start().then(function(){this._fileBrowser.startup(a)}.bind(this))}b.prototype={getFileBrowser:function(){return this._fileBrowser}};return b});orion=this.orion||(this.orion={});var browse=orion.browse||(orion.browse={});browse.browser=require("browse/builder/browse");